<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link href="../common/css/tapl.css" rel="stylesheet" type="text/css" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<title>PLF.Equiv</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<h1 class="libtitle">Library PLF.Equiv</h1>

<div class="code">
</div>

<div class="doc">
<a id="lab3"></a><h1 class="section">Equiv: Program Equivalence</h1>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Set</span> <span class="id" title="var">Warnings</span> "-notation-overridden,-parsing,-deprecated-hint-without-locality".<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">PLF</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="PLF.Maps.html#"><span class="id" title="library">Maps</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Stdlib</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">Bool</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Stdlib</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">Arith</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Stdlib</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">Init.Nat</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Stdlib</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">PeanoNat</span>. <span class="id" title="keyword">Import</span> <span class="id" title="module">Nat</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Stdlib</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">EqNat</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Stdlib</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">Lia</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Stdlib</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">List</span>. <span class="id" title="keyword">Import</span> <span class="id" title="module">ListNotations</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Stdlib</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">FunctionalExtensionality</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">PLF</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <a class="idref" href="PLF.Imp.html#"><span class="id" title="library">Imp</span></a>.<br/>
<span class="id" title="keyword">Set</span> <span class="id" title="var">Default</span> <span class="id" title="keyword">Goal</span> <span class="id" title="var">Selector</span> "!".<br/>

<br/>
</div>

<div class="doc">
<a id="lab4"></a><h3 class="section">Before You Get Started:</h3>


<div class="paragraph"> </div>

<ul class="doclist">
<li> Create a fresh directory for this volume. (Do not try to mix the
      files from this volume with files from <i>Logical Foundations</i> in
      the same directory: the result will not make you happy.)  You
      can either start with an empty directory and populate it with
      the files listed below, or else download the whole PLF zip file
      and unzip it.

<div class="paragraph"> </div>


</li>
<li> The new directory should contain at least the following files:
<ul class="doclist">
<li> <span class="inlinecode"><span class="id" title="var">Imp.v</span></span> (make sure it is the one from the PLF distribution,
           not the one from LF: they are slightly different);

</li>
<li> <span class="inlinecode"><span class="id" title="var">Maps.v</span></span> (ditto)

</li>
<li> <span class="inlinecode"><span class="id" title="var">Equiv.v</span></span> (this file)

</li>
<li> <span class="inlinecode"><span class="id" title="var">_CoqProject</span></span>, containing the following line:

<div class="paragraph"> </div>

<ul class="doclist">
<li>Q . PLF

<div class="paragraph"> </div>


</li>
</ul>

</li>
</ul>

</li>
<li> If you see errors like this...

<div class="paragraph"> </div>

             Compiled library PLF.Maps (in file
             /Users/.../plf/Maps.vo) makes inconsistent assumptions
             over library Coq.Init.Logic

<div class="paragraph"> </div>

      ... it may mean something went wrong with the above steps.
      Doing "<span class="inlinecode"><span class="id" title="var">make</span></span> <span class="inlinecode"><span class="id" title="var">clean</span></span>" (or manually removing everything except
      <span class="inlinecode">.<span class="id" title="var">v</span></span> and <span class="inlinecode"><span class="id" title="var">_CoqProject</span></span> files) may help.

<div class="paragraph"> </div>


</li>
<li> If you are using VSCode with the VSCoq extension, you'll then
      want to open a new window in VSCode, click <span class="inlinecode"><span class="id" title="keyword">Open</span></span> <span class="inlinecode"><span class="id" title="var">Folder</span></span> <span class="inlinecode">&gt;</span> <span class="inlinecode"><span class="id" title="var">plf</span></span>,
      and run <span class="inlinecode"><span class="id" title="var">make</span></span>.  If you get an error like "Cannot find a
      physical path..." error, it may be because you didn't open plf
      directly (you instead opened a folder containing both lf and
      plf, for example). 
</li>
</ul>

<div class="paragraph"> </div>

<a id="lab5"></a><h3 class="section">Advice for Working on Exercises:</h3>


<div class="paragraph"> </div>

<ul class="doclist">
<li> Most of the Coq proofs we ask you to do in this chapter are
      similar to proofs that we've provided.  Before starting to work
      on exercises, take the time to work through our proofs (both
      informally and in Coq) and make sure you understand them in
      detail.  This will save you a lot of time.

<div class="paragraph"> </div>


</li>
<li> The Coq proofs we're doing now are sufficiently complicated that
      it is more or less impossible to complete them by random
      experimentation or following your nose.  You need to start with
      an idea about why the property is true and how the proof is
      going to go.  The best way to do this is to write out at least a
      sketch of an informal proof on paper -- one that intuitively
      convinces you of the truth of the theorem -- before starting to
      work on the formal one.  Alternately, grab a friend and try to
      convince them that the theorem is true; then try to formalize
      your explanation.

<div class="paragraph"> </div>


</li>
<li> Use automation to save work!  The proofs in this chapter can get
      pretty long if you try to write out all the cases explicitly. 

</li>
</ul>
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a id="lab6"></a><h1 class="section">Behavioral Equivalence</h1>

<div class="paragraph"> </div>

 In an earlier chapter, we investigated the correctness of a very
    simple program transformation: the <span class="inlinecode"><span class="id" title="var">optimize_0plus</span></span> function.  The
    programming language we were considering was the first version of
    the language of arithmetic expressions -- with no variables -- so
    in that setting it was very easy to define what it means for a
    program transformation to be correct: it should always yield a
    program that evaluates to the same number as the original.

<div class="paragraph"> </div>

    To talk about the correctness of program transformations for the
    full Imp language -- in particular, assignment -- we need to
    consider the role of mutable state and develop a more
    sophisticated notion of correctness, which we'll call <i>behavioral
    equivalence</i>. 
<div class="paragraph"> </div>

 For example:
<ul class="doclist">
<li> <span class="inlinecode"><span class="id" title="var">X</span></span> <span class="inlinecode">+</span> <span class="inlinecode">2</span> is behaviorally equivalent to <span class="inlinecode">1</span> <span class="inlinecode">+</span> <span class="inlinecode"><span class="id" title="var">X</span></span> <span class="inlinecode">+</span> <span class="inlinecode">1</span>

</li>
<li> <span class="inlinecode"><span class="id" title="var">X</span></span> <span class="inlinecode">-</span> <span class="inlinecode"><span class="id" title="var">X</span></span> is behaviorally equivalent to <span class="inlinecode">0</span>

</li>
<li> <span class="inlinecode">(<span class="id" title="var">X</span></span> <span class="inlinecode">-</span> <span class="inlinecode">1)</span> <span class="inlinecode">+</span> <span class="inlinecode">1</span> is <i>not</i> behaviorally equivalent to <span class="inlinecode"><span class="id" title="var">X</span></span>   

</li>
</ul>
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a id="lab7"></a><h2 class="section">Definitions</h2>

<div class="paragraph"> </div>

 For <span class="inlinecode"><span class="id" title="var">aexp</span></span>s and <span class="inlinecode"><span class="id" title="var">bexp</span></span>s with variables, the definition we want is
    clear: Two <span class="inlinecode"><span class="id" title="var">aexp</span></span>s or <span class="inlinecode"><span class="id" title="var">bexp</span></span>s are "behaviorally equivalent" if
    they evaluate to the same result in every state. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a id="aequiv" class="idref" href="#aequiv"><span class="id" title="definition">aequiv</span></a> (<a id="a1:1" class="idref" href="#a1:1"><span class="id" title="binder">a1</span></a> <a id="a2:2" class="idref" href="#a2:2"><span class="id" title="binder">a2</span></a> : <a class="idref" href="PLF.Imp.html#aexp"><span class="id" title="inductive">aexp</span></a>) : <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> (<a id="st:3" class="idref" href="#st:3"><span class="id" title="binder">st</span></a> : <a class="idref" href="PLF.Imp.html#state"><span class="id" title="definition">state</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#aeval"><span class="id" title="definition">aeval</span></a> <a class="idref" href="PLF.Equiv.html#st:3"><span class="id" title="variable">st</span></a> <a class="idref" href="PLF.Equiv.html#a1:1"><span class="id" title="variable">a1</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="PLF.Imp.html#aeval"><span class="id" title="definition">aeval</span></a> <a class="idref" href="PLF.Equiv.html#st:3"><span class="id" title="variable">st</span></a> <a class="idref" href="PLF.Equiv.html#a2:2"><span class="id" title="variable">a2</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="bequiv" class="idref" href="#bequiv"><span class="id" title="definition">bequiv</span></a> (<a id="b1:4" class="idref" href="#b1:4"><span class="id" title="binder">b1</span></a> <a id="b2:5" class="idref" href="#b2:5"><span class="id" title="binder">b2</span></a> : <a class="idref" href="PLF.Imp.html#bexp"><span class="id" title="inductive">bexp</span></a>) : <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> (<a id="st:6" class="idref" href="#st:6"><span class="id" title="binder">st</span></a> : <a class="idref" href="PLF.Imp.html#state"><span class="id" title="definition">state</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#beval"><span class="id" title="definition">beval</span></a> <a class="idref" href="PLF.Equiv.html#st:6"><span class="id" title="variable">st</span></a> <a class="idref" href="PLF.Equiv.html#b1:4"><span class="id" title="variable">b1</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="PLF.Imp.html#beval"><span class="id" title="definition">beval</span></a> <a class="idref" href="PLF.Equiv.html#st:6"><span class="id" title="variable">st</span></a> <a class="idref" href="PLF.Equiv.html#b2:5"><span class="id" title="variable">b2</span></a>.<br/>

<br/>
</div>

<div class="doc">
Here are some simple examples of equivalences of arithmetic
    and boolean expressions. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a id="aequiv_example" class="idref" href="#aequiv_example"><span class="id" title="lemma">aequiv_example</span></a>:<br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#aequiv"><span class="id" title="definition">aequiv</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="PLF.Imp.html#:com::x_'-'_x"><span class="id" title="notation">-</span></a> <a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> 0 <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">st</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="var">lia</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Theorem</span> <a id="bequiv_example" class="idref" href="#bequiv_example"><span class="id" title="lemma">bequiv_example</span></a>:<br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#bequiv"><span class="id" title="definition">bequiv</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="PLF.Imp.html#:com::x_'-'_x"><span class="id" title="notation">-</span></a> <a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="PLF.Imp.html#9e5b22caf5d7cf490e97976162618c2a"><span class="id" title="notation">=</span></a> 0 <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Imp.html#:com::'true'"><span class="id" title="notation">true</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">st</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="PLF.Imp.html#beval"><span class="id" title="definition">beval</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="PLF.Equiv.html#aequiv_example"><span class="id" title="lemma">aequiv_example</span></a>. <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
For commands, the situation is a little more subtle.  We
    can't simply say "two commands are behaviorally equivalent if they
    evaluate to the same ending state whenever they are started in the
    same initial state," because some commands, when run in some
    starting states, don't terminate in any final state at all!

<div class="paragraph"> </div>

    What we need instead is this: two commands are behaviorally
    equivalent if, for any given starting state, they either (1) both
    diverge or (2) both terminate in the same final state.  A compact
    way to express this is "if the first one terminates in a
    particular state then so does the second, and vice versa." 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a id="cequiv" class="idref" href="#cequiv"><span class="id" title="definition">cequiv</span></a> (<a id="c1:7" class="idref" href="#c1:7"><span class="id" title="binder">c1</span></a> <a id="c2:8" class="idref" href="#c2:8"><span class="id" title="binder">c2</span></a> : <a class="idref" href="PLF.Imp.html#com"><span class="id" title="inductive">com</span></a>) : <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> (<a id="st:9" class="idref" href="#st:9"><span class="id" title="binder">st</span></a> <a id="st':10" class="idref" href="#st':10"><span class="id" title="binder">st'</span></a> : <a class="idref" href="PLF.Imp.html#state"><span class="id" title="definition">state</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="PLF.Equiv.html#st:9"><span class="id" title="variable">st</span></a> <a class="idref" href="PLF.Imp.html#6037d1f4787d63984beccd5510872ee9"><span class="id" title="notation">=[</span></a> <a class="idref" href="PLF.Equiv.html#c1:7"><span class="id" title="variable">c1</span></a> <a class="idref" href="PLF.Imp.html#6037d1f4787d63984beccd5510872ee9"><span class="id" title="notation">]=&gt;</span></a> <a class="idref" href="PLF.Equiv.html#st':10"><span class="id" title="variable">st'</span></a><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">↔</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="PLF.Equiv.html#st:9"><span class="id" title="variable">st</span></a> <a class="idref" href="PLF.Imp.html#6037d1f4787d63984beccd5510872ee9"><span class="id" title="notation">=[</span></a> <a class="idref" href="PLF.Equiv.html#c2:8"><span class="id" title="variable">c2</span></a> <a class="idref" href="PLF.Imp.html#6037d1f4787d63984beccd5510872ee9"><span class="id" title="notation">]=&gt;</span></a> <a class="idref" href="PLF.Equiv.html#st':10"><span class="id" title="variable">st'</span></a><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">)</span></a>.<br/>

<br/>
</div>

<div class="doc">
We can also define an asymmetric variant of this relation: We say
    that <span class="inlinecode"><span class="id" title="var">c1</span></span> <i>refines</i> <span class="inlinecode"><span class="id" title="var">c2</span></span> if they produce the same final states
    <i>when <span class="inlinecode"><span class="id" title="var">c1</span></span> terminates</i> (but <span class="inlinecode"><span class="id" title="var">c1</span></span> may not terminate in some cases
    where <span class="inlinecode"><span class="id" title="var">c2</span></span> does). 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a id="refines" class="idref" href="#refines"><span class="id" title="definition">refines</span></a> (<a id="c1:11" class="idref" href="#c1:11"><span class="id" title="binder">c1</span></a> <a id="c2:12" class="idref" href="#c2:12"><span class="id" title="binder">c2</span></a> : <a class="idref" href="PLF.Imp.html#com"><span class="id" title="inductive">com</span></a>) : <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> (<a id="st:13" class="idref" href="#st:13"><span class="id" title="binder">st</span></a> <a id="st':14" class="idref" href="#st':14"><span class="id" title="binder">st'</span></a> : <a class="idref" href="PLF.Imp.html#state"><span class="id" title="definition">state</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="PLF.Equiv.html#st:13"><span class="id" title="variable">st</span></a> <a class="idref" href="PLF.Imp.html#6037d1f4787d63984beccd5510872ee9"><span class="id" title="notation">=[</span></a> <a class="idref" href="PLF.Equiv.html#c1:11"><span class="id" title="variable">c1</span></a> <a class="idref" href="PLF.Imp.html#6037d1f4787d63984beccd5510872ee9"><span class="id" title="notation">]=&gt;</span></a> <a class="idref" href="PLF.Equiv.html#st':14"><span class="id" title="variable">st'</span></a><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="PLF.Equiv.html#st:13"><span class="id" title="variable">st</span></a> <a class="idref" href="PLF.Imp.html#6037d1f4787d63984beccd5510872ee9"><span class="id" title="notation">=[</span></a> <a class="idref" href="PLF.Equiv.html#c2:12"><span class="id" title="variable">c2</span></a> <a class="idref" href="PLF.Imp.html#6037d1f4787d63984beccd5510872ee9"><span class="id" title="notation">]=&gt;</span></a> <a class="idref" href="PLF.Equiv.html#st':14"><span class="id" title="variable">st'</span></a><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab8"></a><h2 class="section">Simple Examples</h2>

<div class="paragraph"> </div>

 For examples of command equivalence, let's start by looking at
    a trivial program equivalence involving <span class="inlinecode"><span class="id" title="var">skip</span></span>: 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a id="skip_left" class="idref" href="#skip_left"><span class="id" title="lemma">skip_left</span></a> : <span class="id" title="keyword">∀</span> <a id="c:15" class="idref" href="#c:15"><span class="id" title="binder">c</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#cequiv"><span class="id" title="definition">cequiv</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'skip'"><span class="id" title="notation">skip</span></a><a class="idref" href="PLF.Imp.html#313afe74ec81f2da17d8e7bca3b042e7"><span class="id" title="notation">;</span></a> <a class="idref" href="PLF.Equiv.html#c:15"><span class="id" title="variable">c</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#c:15"><span class="id" title="variable">c</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">c</span> <span class="id" title="var">st</span> <span class="id" title="var">st'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="PLF.Imp.html#E_Seq"><span class="id" title="constructor">E_Seq</span></a> <span class="id" title="keyword">with</span> <span class="id" title="var">st</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="PLF.Imp.html#E_Skip"><span class="id" title="constructor">E_Skip</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab9"></a><h4 class="section">Exercise: 2 stars, standard (skip_right)</h4>


<div class="paragraph"> </div>

    Prove that adding a <span class="inlinecode"><span class="id" title="var">skip</span></span> after a command results in an
    equivalent program 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a id="skip_right" class="idref" href="#skip_right"><span class="id" title="lemma">skip_right</span></a> : <span class="id" title="keyword">∀</span> <a id="c:16" class="idref" href="#c:16"><span class="id" title="binder">c</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#cequiv"><span class="id" title="definition">cequiv</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Equiv.html#c:16"><span class="id" title="variable">c</span></a> <a class="idref" href="PLF.Imp.html#313afe74ec81f2da17d8e7bca3b042e7"><span class="id" title="notation">;</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'skip'"><span class="id" title="notation">skip</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#c:16"><span class="id" title="variable">c</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
<div class="paragraph"> </div>

 Similarly, here is a simple equivalence that optimizes <span class="inlinecode"><span class="id" title="keyword">if</span></span>
    commands: 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a id="if_true_simple" class="idref" href="#if_true_simple"><span class="id" title="lemma">if_true_simple</span></a> : <span class="id" title="keyword">∀</span> <a id="c1:17" class="idref" href="#c1:17"><span class="id" title="binder">c1</span></a> <a id="c2:18" class="idref" href="#c2:18"><span class="id" title="binder">c2</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#cequiv"><span class="id" title="definition">cequiv</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">if</span></a> <a class="idref" href="PLF.Imp.html#:com::'true'"><span class="id" title="notation">true</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">then</span></a> <a class="idref" href="PLF.Equiv.html#c1:17"><span class="id" title="variable">c1</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">else</span></a> <a class="idref" href="PLF.Equiv.html#c2:18"><span class="id" title="variable">c2</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">end</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#c1:17"><span class="id" title="variable">c1</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">c1</span> <span class="id" title="var">c2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="PLF.Imp.html#E_IfTrue"><span class="id" title="constructor">E_IfTrue</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">assumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
Of course, no (human) programmer would write a conditional whose
    condition is literally <span class="inlinecode"><span class="id" title="var">true</span></span>.  But they might write one whose
    condition is <i>equivalent</i> to true:

<div class="paragraph"> </div>

    <i>Theorem</i>: If <span class="inlinecode"><span class="id" title="var">b</span></span> is equivalent to <span class="inlinecode"><span class="id" title="var">true</span></span>, then <span class="inlinecode"><span class="id" title="keyword">if</span></span> <span class="inlinecode"><span class="id" title="var">b</span></span> <span class="inlinecode"><span class="id" title="keyword">then</span></span> <span class="inlinecode"><span class="id" title="var">c1</span></span>
    <span class="inlinecode"><span class="id" title="keyword">else</span></span> <span class="inlinecode"><span class="id" title="var">c2</span></span> <span class="inlinecode"><span class="id" title="keyword">end</span></span> is equivalent to <span class="inlinecode"><span class="id" title="var">c1</span></span>.
   <i>Proof</i>:

<div class="paragraph"> </div>

<ul class="doclist">
<li> (<span class="inlinecode">→</span>) We must show, for all <span class="inlinecode"><span class="id" title="var">st</span></span> and <span class="inlinecode"><span class="id" title="var">st'</span></span>, that if <span class="inlinecode"><span class="id" title="var">st</span></span> <span class="inlinecode">=[</span>
       <span class="inlinecode"><span class="id" title="keyword">if</span></span> <span class="inlinecode"><span class="id" title="var">b</span></span> <span class="inlinecode"><span class="id" title="keyword">then</span></span> <span class="inlinecode"><span class="id" title="var">c1</span></span> <span class="inlinecode"><span class="id" title="keyword">else</span></span> <span class="inlinecode"><span class="id" title="var">c2</span></span> <span class="inlinecode"><span class="id" title="keyword">end</span></span> <span class="inlinecode">]=&gt;</span> <span class="inlinecode"><span class="id" title="var">st'</span></span> then <span class="inlinecode"><span class="id" title="var">st</span></span> <span class="inlinecode">=[</span> <span class="inlinecode"><span class="id" title="var">c1</span></span> <span class="inlinecode">]=&gt;</span> <span class="inlinecode"><span class="id" title="var">st'</span></span>.

<div class="paragraph"> </div>

       Proceed by cases on the rules that could possibly have been
       used to show <span class="inlinecode"><span class="id" title="var">st</span></span> <span class="inlinecode">=[</span> <span class="inlinecode"><span class="id" title="keyword">if</span></span> <span class="inlinecode"><span class="id" title="var">b</span></span> <span class="inlinecode"><span class="id" title="keyword">then</span></span> <span class="inlinecode"><span class="id" title="var">c1</span></span> <span class="inlinecode"><span class="id" title="keyword">else</span></span> <span class="inlinecode"><span class="id" title="var">c2</span></span> <span class="inlinecode"><span class="id" title="keyword">end</span></span> <span class="inlinecode">]=&gt;</span> <span class="inlinecode"><span class="id" title="var">st'</span></span>, namely
       <span class="inlinecode"><span class="id" title="var">E_IfTrue</span></span> and <span class="inlinecode"><span class="id" title="var">E_IfFalse</span></span>.

<div class="paragraph"> </div>

<ul class="doclist">
<li> Suppose the final rule in the derivation of <span class="inlinecode"><span class="id" title="var">st</span></span> <span class="inlinecode">=[</span> <span class="inlinecode"><span class="id" title="keyword">if</span></span> <span class="inlinecode"><span class="id" title="var">b</span></span>
         <span class="inlinecode"><span class="id" title="keyword">then</span></span> <span class="inlinecode"><span class="id" title="var">c1</span></span> <span class="inlinecode"><span class="id" title="keyword">else</span></span> <span class="inlinecode"><span class="id" title="var">c2</span></span> <span class="inlinecode"><span class="id" title="keyword">end</span></span> <span class="inlinecode">]=&gt;</span> <span class="inlinecode"><span class="id" title="var">st'</span></span> was <span class="inlinecode"><span class="id" title="var">E_IfTrue</span></span>.  We then have,
         by the premises of <span class="inlinecode"><span class="id" title="var">E_IfTrue</span></span>, that <span class="inlinecode"><span class="id" title="var">st</span></span> <span class="inlinecode">=[</span> <span class="inlinecode"><span class="id" title="var">c1</span></span> <span class="inlinecode">]=&gt;</span> <span class="inlinecode"><span class="id" title="var">st'</span></span>.
         This is exactly what we set out to prove.

<div class="paragraph"> </div>


</li>
<li> On the other hand, suppose the final rule in the derivation
         of <span class="inlinecode"><span class="id" title="var">st</span></span> <span class="inlinecode">=[</span> <span class="inlinecode"><span class="id" title="keyword">if</span></span> <span class="inlinecode"><span class="id" title="var">b</span></span> <span class="inlinecode"><span class="id" title="keyword">then</span></span> <span class="inlinecode"><span class="id" title="var">c1</span></span> <span class="inlinecode"><span class="id" title="keyword">else</span></span> <span class="inlinecode"><span class="id" title="var">c2</span></span> <span class="inlinecode"><span class="id" title="keyword">end</span></span> <span class="inlinecode">]=&gt;</span> <span class="inlinecode"><span class="id" title="var">st'</span></span> was <span class="inlinecode"><span class="id" title="var">E_IfFalse</span></span>.
         We then know that <span class="inlinecode"><span class="id" title="var">beval</span></span> <span class="inlinecode"><span class="id" title="var">st</span></span> <span class="inlinecode"><span class="id" title="var">b</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">false</span></span> and <span class="inlinecode"><span class="id" title="var">st</span></span> <span class="inlinecode">=[</span> <span class="inlinecode"><span class="id" title="var">c2</span></span> <span class="inlinecode">]=&gt;</span> <span class="inlinecode"><span class="id" title="var">st'</span></span>.

<div class="paragraph"> </div>

         Recall that <span class="inlinecode"><span class="id" title="var">b</span></span> is equivalent to <span class="inlinecode"><span class="id" title="var">true</span></span>, i.e., forall <span class="inlinecode"><span class="id" title="var">st</span></span>,
         <span class="inlinecode"><span class="id" title="var">beval</span></span> <span class="inlinecode"><span class="id" title="var">st</span></span> <span class="inlinecode"><span class="id" title="var">b</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">beval</span></span> <span class="inlinecode"><span class="id" title="var">st</span></span> <span class="inlinecode">&lt;{<span class="id" title="var">true</span>}&gt;</span> <span class="inlinecode"></span>.  In particular, this means
         that <span class="inlinecode"><span class="id" title="var">beval</span></span> <span class="inlinecode"><span class="id" title="var">st</span></span> <span class="inlinecode"><span class="id" title="var">b</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">true</span></span>, since <span class="inlinecode"><span class="id" title="var">beval</span></span> <span class="inlinecode"><span class="id" title="var">st</span></span> <span class="inlinecode">&lt;{<span class="id" title="var">true</span>}&gt;</span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">true</span></span>.  But
         this is a contradiction, since <span class="inlinecode"><span class="id" title="var">E_IfFalse</span></span> requires that
         <span class="inlinecode"><span class="id" title="var">beval</span></span> <span class="inlinecode"><span class="id" title="var">st</span></span> <span class="inlinecode"><span class="id" title="var">b</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">false</span></span>.  Thus, the final rule could not have
         been <span class="inlinecode"><span class="id" title="var">E_IfFalse</span></span>.

<div class="paragraph"> </div>


</li>
</ul>

</li>
<li> (<span class="inlinecode">&lt;-</span>) We must show, for all <span class="inlinecode"><span class="id" title="var">st</span></span> and <span class="inlinecode"><span class="id" title="var">st'</span></span>, that if
       <span class="inlinecode"><span class="id" title="var">st</span></span> <span class="inlinecode">=[</span> <span class="inlinecode"><span class="id" title="var">c1</span></span> <span class="inlinecode">]=&gt;</span> <span class="inlinecode"><span class="id" title="var">st'</span></span> then
       <span class="inlinecode"><span class="id" title="var">st</span></span> <span class="inlinecode">=[</span> <span class="inlinecode"><span class="id" title="keyword">if</span></span> <span class="inlinecode"><span class="id" title="var">b</span></span> <span class="inlinecode"><span class="id" title="keyword">then</span></span> <span class="inlinecode"><span class="id" title="var">c1</span></span> <span class="inlinecode"><span class="id" title="keyword">else</span></span> <span class="inlinecode"><span class="id" title="var">c2</span></span> <span class="inlinecode"><span class="id" title="keyword">end</span></span> <span class="inlinecode">]=&gt;</span> <span class="inlinecode"><span class="id" title="var">st'</span></span>.

<div class="paragraph"> </div>

       Since <span class="inlinecode"><span class="id" title="var">b</span></span> is equivalent to <span class="inlinecode"><span class="id" title="var">true</span></span>, we know that <span class="inlinecode"><span class="id" title="var">beval</span></span> <span class="inlinecode"><span class="id" title="var">st</span></span> <span class="inlinecode"><span class="id" title="var">b</span></span> =
       <span class="inlinecode"><span class="id" title="var">beval</span></span> <span class="inlinecode"><span class="id" title="var">st</span></span> <span class="inlinecode">&lt;{<span class="id" title="var">true</span>}&gt;</span> <span class="inlinecode"></span> = <span class="inlinecode"><span class="id" title="var">true</span></span>.  Together with the assumption that
       <span class="inlinecode"><span class="id" title="var">st</span></span> <span class="inlinecode">=[</span> <span class="inlinecode"><span class="id" title="var">c1</span></span> <span class="inlinecode">]=&gt;</span> <span class="inlinecode"><span class="id" title="var">st'</span></span>, we can apply <span class="inlinecode"><span class="id" title="var">E_IfTrue</span></span> to derive
       <span class="inlinecode"><span class="id" title="var">st</span></span> <span class="inlinecode">=[</span> <span class="inlinecode"><span class="id" title="keyword">if</span></span> <span class="inlinecode"><span class="id" title="var">b</span></span> <span class="inlinecode"><span class="id" title="keyword">then</span></span> <span class="inlinecode"><span class="id" title="var">c1</span></span> <span class="inlinecode"><span class="id" title="keyword">else</span></span> <span class="inlinecode"><span class="id" title="var">c2</span></span> <span class="inlinecode"><span class="id" title="keyword">end</span></span> <span class="inlinecode">]=&gt;</span> <span class="inlinecode"><span class="id" title="var">st'</span></span>.  <font size=-2>&#9744;</font>

</li>
</ul>

<div class="paragraph"> </div>

   Here is the formal version of this proof: 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a id="if_true" class="idref" href="#if_true"><span class="id" title="lemma">if_true</span></a>: <span class="id" title="keyword">∀</span> <a id="b:19" class="idref" href="#b:19"><span class="id" title="binder">b</span></a> <a id="c1:20" class="idref" href="#c1:20"><span class="id" title="binder">c1</span></a> <a id="c2:21" class="idref" href="#c2:21"><span class="id" title="binder">c2</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#bequiv"><span class="id" title="definition">bequiv</span></a> <a class="idref" href="PLF.Equiv.html#b:19"><span class="id" title="variable">b</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a><a class="idref" href="PLF.Imp.html#:com::'true'"><span class="id" title="notation">true</span></a><a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a>  <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#cequiv"><span class="id" title="definition">cequiv</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">if</span></a> <a class="idref" href="PLF.Equiv.html#b:19"><span class="id" title="variable">b</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">then</span></a> <a class="idref" href="PLF.Equiv.html#c1:20"><span class="id" title="variable">c1</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">else</span></a> <a class="idref" href="PLF.Equiv.html#c2:21"><span class="id" title="variable">c2</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">end</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#c1:20"><span class="id" title="variable">c1</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">b</span> <span class="id" title="var">c1</span> <span class="id" title="var">c2</span> <span class="id" title="var">Hb</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="PLF.Equiv.html#bequiv"><span class="id" title="definition">bequiv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hb</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hb</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="PLF.Imp.html#E_IfTrue"><span class="id" title="constructor">E_IfTrue</span></a>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="PLF.Equiv.html#bequiv"><span class="id" title="definition">bequiv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hb</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Hb</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab10"></a><h4 class="section">Exercise: 2 stars, standard, especially useful (if_false)</h4>

</div>
<div class="code">
<span class="id" title="keyword">Theorem</span> <a id="if_false" class="idref" href="#if_false"><span class="id" title="lemma">if_false</span></a> : <span class="id" title="keyword">∀</span> <a id="b:22" class="idref" href="#b:22"><span class="id" title="binder">b</span></a> <a id="c1:23" class="idref" href="#c1:23"><span class="id" title="binder">c1</span></a> <a id="c2:24" class="idref" href="#c2:24"><span class="id" title="binder">c2</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#bequiv"><span class="id" title="definition">bequiv</span></a> <a class="idref" href="PLF.Equiv.html#b:22"><span class="id" title="variable">b</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a><a class="idref" href="PLF.Imp.html#:com::'false'"><span class="id" title="notation">false</span></a><a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#cequiv"><span class="id" title="definition">cequiv</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">if</span></a> <a class="idref" href="PLF.Equiv.html#b:22"><span class="id" title="variable">b</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">then</span></a> <a class="idref" href="PLF.Equiv.html#c1:23"><span class="id" title="variable">c1</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">else</span></a> <a class="idref" href="PLF.Equiv.html#c2:24"><span class="id" title="variable">c2</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">end</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#c2:24"><span class="id" title="variable">c2</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
<div class="paragraph"> </div>

<a id="lab11"></a><h4 class="section">Exercise: 3 stars, standard (swap_if_branches)</h4>


<div class="paragraph"> </div>

    Show that we can swap the branches of an <span class="inlinecode"><span class="id" title="keyword">if</span></span> if we also negate its
    condition. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a id="swap_if_branches" class="idref" href="#swap_if_branches"><span class="id" title="lemma">swap_if_branches</span></a> : <span class="id" title="keyword">∀</span> <a id="b:25" class="idref" href="#b:25"><span class="id" title="binder">b</span></a> <a id="c1:26" class="idref" href="#c1:26"><span class="id" title="binder">c1</span></a> <a id="c2:27" class="idref" href="#c2:27"><span class="id" title="binder">c2</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#cequiv"><span class="id" title="definition">cequiv</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">if</span></a> <a class="idref" href="PLF.Equiv.html#b:25"><span class="id" title="variable">b</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">then</span></a> <a class="idref" href="PLF.Equiv.html#c1:26"><span class="id" title="variable">c1</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">else</span></a> <a class="idref" href="PLF.Equiv.html#c2:27"><span class="id" title="variable">c2</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">end</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">if</span></a> <a class="idref" href="PLF.Imp.html#dfe50505b2b595242030c436d0d7d15f"><span class="id" title="notation">¬</span></a> <a class="idref" href="PLF.Equiv.html#b:25"><span class="id" title="variable">b</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">then</span></a> <a class="idref" href="PLF.Equiv.html#c2:27"><span class="id" title="variable">c2</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">else</span></a> <a class="idref" href="PLF.Equiv.html#c1:26"><span class="id" title="variable">c1</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">end</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
<div class="paragraph"> </div>

 For <span class="inlinecode"><span class="id" title="var">while</span></span> loops, we can give a similar pair of theorems.  A loop
    whose guard is equivalent to <span class="inlinecode"><span class="id" title="var">false</span></span> is equivalent to <span class="inlinecode"><span class="id" title="var">skip</span></span>,
    while a loop whose guard is equivalent to <span class="inlinecode"><span class="id" title="var">true</span></span> is equivalent to
    <span class="inlinecode"><span class="id" title="var">while</span></span> <span class="inlinecode"><span class="id" title="var">true</span></span> <span class="inlinecode"><span class="id" title="tactic">do</span></span> <span class="inlinecode"><span class="id" title="var">skip</span></span> <span class="inlinecode"><span class="id" title="keyword">end</span></span> (or any other non-terminating program). 
<div class="paragraph"> </div>

 The first of these facts is easy. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a id="while_false" class="idref" href="#while_false"><span class="id" title="lemma">while_false</span></a> : <span class="id" title="keyword">∀</span> <a id="b:28" class="idref" href="#b:28"><span class="id" title="binder">b</span></a> <a id="c:29" class="idref" href="#c:29"><span class="id" title="binder">c</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#bequiv"><span class="id" title="definition">bequiv</span></a> <a class="idref" href="PLF.Equiv.html#b:28"><span class="id" title="variable">b</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a><a class="idref" href="PLF.Imp.html#:com::'false'"><span class="id" title="notation">false</span></a><a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#cequiv"><span class="id" title="definition">cequiv</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">while</span></a> <a class="idref" href="PLF.Equiv.html#b:28"><span class="id" title="variable">b</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">do</span></a> <a class="idref" href="PLF.Equiv.html#c:29"><span class="id" title="variable">c</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">end</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'skip'"><span class="id" title="notation">skip</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> <span class="id" title="var">Hb</span>. <span class="id" title="tactic">split</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="PLF.Imp.html#E_Skip"><span class="id" title="constructor">E_Skip</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hb</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="PLF.Imp.html#E_WhileFalse"><span class="id" title="constructor">E_WhileFalse</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Hb</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab12"></a><h4 class="section">Exercise: 2 stars, advanced, optional (while_false_informal)</h4>


<div class="paragraph"> </div>

    Write an informal proof of <span class="inlinecode"><span class="id" title="var">while_false</span></span>.

<div class="paragraph"> </div>

 <font size=-2>&#9744;</font> 
<div class="paragraph"> </div>

 To prove the second fact, we need an auxiliary lemma stating that
    <span class="inlinecode"><span class="id" title="var">while</span></span> loops whose guards are equivalent to <span class="inlinecode"><span class="id" title="var">true</span></span> never
    terminate. 
<div class="paragraph"> </div>

 <i>Lemma</i>: If <span class="inlinecode"><span class="id" title="var">b</span></span> is equivalent to <span class="inlinecode"><span class="id" title="var">true</span></span>, then it cannot be
    the case that <span class="inlinecode"><span class="id" title="var">st</span></span> <span class="inlinecode">=[</span> <span class="inlinecode"><span class="id" title="var">while</span></span> <span class="inlinecode"><span class="id" title="var">b</span></span> <span class="inlinecode"><span class="id" title="tactic">do</span></span> <span class="inlinecode"><span class="id" title="var">c</span></span> <span class="inlinecode"><span class="id" title="keyword">end</span></span> <span class="inlinecode">]=&gt;</span> <span class="inlinecode"><span class="id" title="var">st'</span></span>.

<div class="paragraph"> </div>

    <i>Proof</i>: Suppose that <span class="inlinecode"><span class="id" title="var">st</span></span> <span class="inlinecode">=[</span> <span class="inlinecode"><span class="id" title="var">while</span></span> <span class="inlinecode"><span class="id" title="var">b</span></span> <span class="inlinecode"><span class="id" title="tactic">do</span></span> <span class="inlinecode"><span class="id" title="var">c</span></span> <span class="inlinecode"><span class="id" title="keyword">end</span></span> <span class="inlinecode">]=&gt;</span> <span class="inlinecode"><span class="id" title="var">st'</span></span>.  We show,
    by induction on a derivation of <span class="inlinecode"><span class="id" title="var">st</span></span> <span class="inlinecode">=[</span> <span class="inlinecode"><span class="id" title="var">while</span></span> <span class="inlinecode"><span class="id" title="var">b</span></span> <span class="inlinecode"><span class="id" title="tactic">do</span></span> <span class="inlinecode"><span class="id" title="var">c</span></span> <span class="inlinecode"><span class="id" title="keyword">end</span></span> <span class="inlinecode">]=&gt;</span> <span class="inlinecode"><span class="id" title="var">st'</span></span>,
    that this assumption leads to a contradiction. The only two cases
    to consider are <span class="inlinecode"><span class="id" title="var">E_WhileFalse</span></span> and <span class="inlinecode"><span class="id" title="var">E_WhileTrue</span></span>, the others
    are contradictory.

<div class="paragraph"> </div>

<ul class="doclist">
<li> Suppose <span class="inlinecode"><span class="id" title="var">st</span></span> <span class="inlinecode">=[</span> <span class="inlinecode"><span class="id" title="var">while</span></span> <span class="inlinecode"><span class="id" title="var">b</span></span> <span class="inlinecode"><span class="id" title="tactic">do</span></span> <span class="inlinecode"><span class="id" title="var">c</span></span> <span class="inlinecode"><span class="id" title="keyword">end</span></span> <span class="inlinecode">]=&gt;</span> <span class="inlinecode"><span class="id" title="var">st'</span></span> is proved using rule
      <span class="inlinecode"><span class="id" title="var">E_WhileFalse</span></span>.  Then by assumption <span class="inlinecode"><span class="id" title="var">beval</span></span> <span class="inlinecode"><span class="id" title="var">st</span></span> <span class="inlinecode"><span class="id" title="var">b</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">false</span></span>.  But
      this contradicts the assumption that <span class="inlinecode"><span class="id" title="var">b</span></span> is equivalent to
      <span class="inlinecode"><span class="id" title="var">true</span></span>.

<div class="paragraph"> </div>


</li>
<li> Suppose <span class="inlinecode"><span class="id" title="var">st</span></span> <span class="inlinecode">=[</span> <span class="inlinecode"><span class="id" title="var">while</span></span> <span class="inlinecode"><span class="id" title="var">b</span></span> <span class="inlinecode"><span class="id" title="tactic">do</span></span> <span class="inlinecode"><span class="id" title="var">c</span></span> <span class="inlinecode"><span class="id" title="keyword">end</span></span> <span class="inlinecode">]=&gt;</span> <span class="inlinecode"><span class="id" title="var">st'</span></span> is proved using rule
      <span class="inlinecode"><span class="id" title="var">E_WhileTrue</span></span>.  We must have that:

<div class="paragraph"> </div>

      1. <span class="inlinecode"><span class="id" title="var">beval</span></span> <span class="inlinecode"><span class="id" title="var">st</span></span> <span class="inlinecode"><span class="id" title="var">b</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">true</span></span>,
      2. there is some <span class="inlinecode"><span class="id" title="var">st0</span></span> such that <span class="inlinecode"><span class="id" title="var">st</span></span> <span class="inlinecode">=[</span> <span class="inlinecode"><span class="id" title="var">c</span></span> <span class="inlinecode">]=&gt;</span> <span class="inlinecode"><span class="id" title="var">st0</span></span> and
         <span class="inlinecode"><span class="id" title="var">st0</span></span> <span class="inlinecode">=[</span> <span class="inlinecode"><span class="id" title="var">while</span></span> <span class="inlinecode"><span class="id" title="var">b</span></span> <span class="inlinecode"><span class="id" title="tactic">do</span></span> <span class="inlinecode"><span class="id" title="var">c</span></span> <span class="inlinecode"><span class="id" title="keyword">end</span></span> <span class="inlinecode">]=&gt;</span> <span class="inlinecode"><span class="id" title="var">st'</span></span>,
      3. and we are given the induction hypothesis that
         <span class="inlinecode"><span class="id" title="var">st0</span></span> <span class="inlinecode">=[</span> <span class="inlinecode"><span class="id" title="var">while</span></span> <span class="inlinecode"><span class="id" title="var">b</span></span> <span class="inlinecode"><span class="id" title="tactic">do</span></span> <span class="inlinecode"><span class="id" title="var">c</span></span> <span class="inlinecode"><span class="id" title="keyword">end</span></span> <span class="inlinecode">]=&gt;</span> <span class="inlinecode"><span class="id" title="var">st'</span></span> leads to a contradiction,

<div class="paragraph"> </div>

      We obtain a contradiction by 2 and 3. <font size=-2>&#9744;</font> 

</li>
</ul>
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <a id="while_true_nonterm" class="idref" href="#while_true_nonterm"><span class="id" title="lemma">while_true_nonterm</span></a> : <span class="id" title="keyword">∀</span> <a id="b:30" class="idref" href="#b:30"><span class="id" title="binder">b</span></a> <a id="c:31" class="idref" href="#c:31"><span class="id" title="binder">c</span></a> <a id="st:32" class="idref" href="#st:32"><span class="id" title="binder">st</span></a> <a id="st':33" class="idref" href="#st':33"><span class="id" title="binder">st'</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#bequiv"><span class="id" title="definition">bequiv</span></a> <a class="idref" href="PLF.Equiv.html#b:30"><span class="id" title="variable">b</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a><a class="idref" href="PLF.Imp.html#:com::'true'"><span class="id" title="notation">true</span></a><a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">~(</span></a> <a class="idref" href="PLF.Equiv.html#st:32"><span class="id" title="variable">st</span></a> <a class="idref" href="PLF.Imp.html#6037d1f4787d63984beccd5510872ee9"><span class="id" title="notation">=[</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">while</span></a> <a class="idref" href="PLF.Equiv.html#b:30"><span class="id" title="variable">b</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">do</span></a> <a class="idref" href="PLF.Equiv.html#c:31"><span class="id" title="variable">c</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">end</span></a> <a class="idref" href="PLF.Imp.html#6037d1f4787d63984beccd5510872ee9"><span class="id" title="notation">]=&gt;</span></a> <a class="idref" href="PLF.Equiv.html#st':33"><span class="id" title="variable">st'</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> <span class="id" title="var">st</span> <span class="id" title="var">st'</span> <span class="id" title="var">Hb</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">remember</span> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">while</span></a> <span class="id" title="var">b</span> <a class="idref" href="PLF.Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">do</span></a> <span class="id" title="var">c</span> <a class="idref" href="PLF.Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">end</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a> <span class="id" title="keyword">as</span> <span class="id" title="var">cw</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">Heqcw</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">H</span>;<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">Heqcw</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">Heqcw</span>.<br/>
&nbsp;&nbsp;-  <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="PLF.Equiv.html#bequiv"><span class="id" title="definition">bequiv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hb</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;-  <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHceval2</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab13"></a><h4 class="section">Exercise: 2 stars, standard, optional (while_true_nonterm_informal)</h4>


<div class="paragraph"> </div>

    Explain what the lemma <span class="inlinecode"><span class="id" title="var">while_true_nonterm</span></span> means in English.

<div class="paragraph"> </div>

 <font size=-2>&#9744;</font> 
<div class="paragraph"> </div>

<a id="lab14"></a><h4 class="section">Exercise: 2 stars, standard, especially useful (while_true)</h4>


<div class="paragraph"> </div>

    Prove the following theorem. <i>Hint</i>: You'll want to use
    <span class="inlinecode"><span class="id" title="var">while_true_nonterm</span></span> here. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a id="while_true" class="idref" href="#while_true"><span class="id" title="lemma">while_true</span></a> : <span class="id" title="keyword">∀</span> <a id="b:34" class="idref" href="#b:34"><span class="id" title="binder">b</span></a> <a id="c:35" class="idref" href="#c:35"><span class="id" title="binder">c</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#bequiv"><span class="id" title="definition">bequiv</span></a> <a class="idref" href="PLF.Equiv.html#b:34"><span class="id" title="variable">b</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a><a class="idref" href="PLF.Imp.html#:com::'true'"><span class="id" title="notation">true</span></a><a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a>  <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#cequiv"><span class="id" title="definition">cequiv</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">while</span></a> <a class="idref" href="PLF.Equiv.html#b:34"><span class="id" title="variable">b</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">do</span></a> <a class="idref" href="PLF.Equiv.html#c:35"><span class="id" title="variable">c</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">end</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">while</span></a> <a class="idref" href="PLF.Imp.html#:com::'true'"><span class="id" title="notation">true</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">do</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'skip'"><span class="id" title="notation">skip</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">end</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
<div class="paragraph"> </div>

 A more interesting fact about <span class="inlinecode"><span class="id" title="var">while</span></span> commands is that any number
    of copies of the body can be "unrolled" without changing meaning.

<div class="paragraph"> </div>

    Loop unrolling is an important transformation in any real
    compiler: its correctness is of more than academic interest! 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a id="loop_unrolling" class="idref" href="#loop_unrolling"><span class="id" title="lemma">loop_unrolling</span></a> : <span class="id" title="keyword">∀</span> <a id="b:36" class="idref" href="#b:36"><span class="id" title="binder">b</span></a> <a id="c:37" class="idref" href="#c:37"><span class="id" title="binder">c</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#cequiv"><span class="id" title="definition">cequiv</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">while</span></a> <a class="idref" href="PLF.Equiv.html#b:36"><span class="id" title="variable">b</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">do</span></a> <a class="idref" href="PLF.Equiv.html#c:37"><span class="id" title="variable">c</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">end</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">if</span></a> <a class="idref" href="PLF.Equiv.html#b:36"><span class="id" title="variable">b</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">then</span></a> <a class="idref" href="PLF.Equiv.html#c:37"><span class="id" title="variable">c</span></a> <a class="idref" href="PLF.Imp.html#313afe74ec81f2da17d8e7bca3b042e7"><span class="id" title="notation">;</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">while</span></a> <a class="idref" href="PLF.Equiv.html#b:36"><span class="id" title="variable">b</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">do</span></a> <a class="idref" href="PLF.Equiv.html#c:37"><span class="id" title="variable">c</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">end</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">else</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'skip'"><span class="id" title="notation">skip</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">end</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> <span class="id" title="var">st</span> <span class="id" title="var">st'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">Hce</span>.<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">Hce</span>; <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="PLF.Imp.html#E_IfFalse"><span class="id" title="constructor">E_IfFalse</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">apply</span> <a class="idref" href="PLF.Imp.html#E_Skip"><span class="id" title="constructor">E_Skip</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="PLF.Imp.html#E_IfTrue"><span class="id" title="constructor">E_IfTrue</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">apply</span> <a class="idref" href="PLF.Imp.html#E_Seq"><span class="id" title="constructor">E_Seq</span></a> <span class="id" title="keyword">with</span> (<span class="id" title="var">st'</span> := <span class="id" title="var">st'0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">Hce</span>; <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">H5</span>; <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="PLF.Imp.html#E_WhileTrue"><span class="id" title="constructor">E_WhileTrue</span></a> <span class="id" title="keyword">with</span> (<span class="id" title="var">st'</span> := <span class="id" title="var">st'0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">H5</span>; <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="PLF.Imp.html#E_WhileFalse"><span class="id" title="constructor">E_WhileFalse</span></a>. <span class="id" title="tactic">assumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab15"></a><h4 class="section">Exercise: 2 stars, standard, optional (seq_assoc)</h4>

</div>
<div class="code">
<span class="id" title="keyword">Theorem</span> <a id="seq_assoc" class="idref" href="#seq_assoc"><span class="id" title="lemma">seq_assoc</span></a> : <span class="id" title="keyword">∀</span> <a id="c1:38" class="idref" href="#c1:38"><span class="id" title="binder">c1</span></a> <a id="c2:39" class="idref" href="#c2:39"><span class="id" title="binder">c2</span></a> <a id="c3:40" class="idref" href="#c3:40"><span class="id" title="binder">c3</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#cequiv"><span class="id" title="definition">cequiv</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a><a class="idref" href="PLF.Imp.html#5a96623d056c293ebbcdf03005796e09"><span class="id" title="notation">(</span></a><a class="idref" href="PLF.Equiv.html#c1:38"><span class="id" title="variable">c1</span></a><a class="idref" href="PLF.Imp.html#313afe74ec81f2da17d8e7bca3b042e7"><span class="id" title="notation">;</span></a><a class="idref" href="PLF.Equiv.html#c2:39"><span class="id" title="variable">c2</span></a><a class="idref" href="PLF.Imp.html#5a96623d056c293ebbcdf03005796e09"><span class="id" title="notation">)</span></a><a class="idref" href="PLF.Imp.html#313afe74ec81f2da17d8e7bca3b042e7"><span class="id" title="notation">;</span></a><a class="idref" href="PLF.Equiv.html#c3:40"><span class="id" title="variable">c3</span></a><a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a><a class="idref" href="PLF.Equiv.html#c1:38"><span class="id" title="variable">c1</span></a><a class="idref" href="PLF.Imp.html#313afe74ec81f2da17d8e7bca3b042e7"><span class="id" title="notation">;</span></a><a class="idref" href="PLF.Imp.html#5a96623d056c293ebbcdf03005796e09"><span class="id" title="notation">(</span></a><a class="idref" href="PLF.Equiv.html#c2:39"><span class="id" title="variable">c2</span></a><a class="idref" href="PLF.Imp.html#313afe74ec81f2da17d8e7bca3b042e7"><span class="id" title="notation">;</span></a><a class="idref" href="PLF.Equiv.html#c3:40"><span class="id" title="variable">c3</span></a><a class="idref" href="PLF.Imp.html#5a96623d056c293ebbcdf03005796e09"><span class="id" title="notation">)</span></a><a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
<div class="paragraph"> </div>

 Proving program properties involving assignments is one place
    where the fact that program states are treated extensionally
    (e.g., <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode">!-&gt;</span> <span class="inlinecode"><span class="id" title="var">m</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode">;</span> <span class="inlinecode"><span class="id" title="var">m</span></span> and <span class="inlinecode"><span class="id" title="var">m</span></span> are equal maps) comes in handy. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a id="identity_assignment" class="idref" href="#identity_assignment"><span class="id" title="lemma">identity_assignment</span></a> : <span class="id" title="keyword">∀</span> <a id="x:41" class="idref" href="#x:41"><span class="id" title="binder">x</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#cequiv"><span class="id" title="definition">cequiv</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Equiv.html#x:41"><span class="id" title="variable">x</span></a> <a class="idref" href="PLF.Imp.html#91e9aa710642047a93142bdf557f1a1b"><span class="id" title="notation">:=</span></a> <a class="idref" href="PLF.Equiv.html#x:41"><span class="id" title="variable">x</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'skip'"><span class="id" title="notation">skip</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">intro</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="PLF.Maps.html#t_update_same"><span class="id" title="axiom">t_update_same</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="PLF.Imp.html#E_Skip"><span class="id" title="constructor">E_Skip</span></a>.<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hx</span> : <span class="id" title="var">st'</span> <a class="idref" href="PLF.Imp.html#6037d1f4787d63984beccd5510872ee9"><span class="id" title="notation">=[</span></a> <span class="id" title="var">x</span> <a class="idref" href="PLF.Imp.html#91e9aa710642047a93142bdf557f1a1b"><span class="id" title="notation">:=</span></a> <span class="id" title="var">x</span> <a class="idref" href="PLF.Imp.html#6037d1f4787d63984beccd5510872ee9"><span class="id" title="notation">]=&gt;</span></a> <a class="idref" href="PLF.Imp.html#6037d1f4787d63984beccd5510872ee9"><span class="id" title="notation">(</span></a><span class="id" title="var">x</span> <a class="idref" href="PLF.Maps.html#630986d105c0f1782d085b9a306379a7"><span class="id" title="notation">!-&gt;</span></a> <span class="id" title="var">st'</span> <span class="id" title="var">x</span> <a class="idref" href="PLF.Maps.html#630986d105c0f1782d085b9a306379a7"><span class="id" title="notation">;</span></a> <span class="id" title="var">st'</span><a class="idref" href="PLF.Imp.html#6037d1f4787d63984beccd5510872ee9"><span class="id" title="notation">)</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <a class="idref" href="PLF.Imp.html#E_Asgn"><span class="id" title="constructor">E_Asgn</span></a>. <span class="id" title="tactic">reflexivity</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="PLF.Maps.html#t_update_same"><span class="id" title="axiom">t_update_same</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Hx</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab16"></a><h4 class="section">Exercise: 2 stars, standard, especially useful (assign_aequiv)</h4>

</div>
<div class="code">
<span class="id" title="keyword">Theorem</span> <a id="assign_aequiv" class="idref" href="#assign_aequiv"><span class="id" title="lemma">assign_aequiv</span></a> : <span class="id" title="keyword">∀</span> (<a id="X:42" class="idref" href="#X:42"><span class="id" title="binder">X</span></a> : <span class="id" title="inductive">string</span>) (<a id="a:43" class="idref" href="#a:43"><span class="id" title="binder">a</span></a> : <a class="idref" href="PLF.Imp.html#aexp"><span class="id" title="inductive">aexp</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#aequiv"><span class="id" title="definition">aequiv</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Equiv.html#X:42"><span class="id" title="variable">X</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a> <a class="idref" href="PLF.Equiv.html#a:43"><span class="id" title="variable">a</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#cequiv"><span class="id" title="definition">cequiv</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'skip'"><span class="id" title="notation">skip</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Equiv.html#X:42"><span class="id" title="variable">X</span></a> <a class="idref" href="PLF.Imp.html#91e9aa710642047a93142bdf557f1a1b"><span class="id" title="notation">:=</span></a> <a class="idref" href="PLF.Equiv.html#a:43"><span class="id" title="variable">a</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
<div class="paragraph"> </div>

<a id="lab17"></a><h4 class="section">Exercise: 2 stars, standard (equiv_classes)</h4>

<div class="paragraph"> </div>

 Given the following programs, group together those that are
    equivalent in Imp. Your answer should be given as a list of lists,
    where each sub-list represents a group of equivalent programs. For
    example, if you think programs (a) through (h) are all equivalent
    to each other, but not to (i), your answer should look like this:

<div class="paragraph"> </div>

       <span class="inlinecode"></span> <span class="inlinecode">[<span class="id" title="var">prog_a</span>;<span class="id" title="var">prog_b</span>;<span class="id" title="var">prog_c</span>;<span class="id" title="var">prog_d</span>;<span class="id" title="var">prog_e</span>;<span class="id" title="var">prog_f</span>;<span class="id" title="var">prog_g</span>;<span class="id" title="var">prog_h</span>]</span> <span class="inlinecode">;</span>
         <span class="inlinecode">[<span class="id" title="var">prog_i</span>]</span> <span class="inlinecode"></span>

<div class="paragraph"> </div>

    Write down your answer below in the definition of
    <span class="inlinecode"><span class="id" title="var">equiv_classes</span></span>. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a id="prog_a" class="idref" href="#prog_a"><span class="id" title="definition">prog_a</span></a> : <a class="idref" href="PLF.Imp.html#com"><span class="id" title="inductive">com</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">while</span></a> <a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="PLF.Imp.html#:com::x_'&gt;'_x"><span class="id" title="notation">&gt;</span></a> 0 <a class="idref" href="PLF.Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">do</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="PLF.Imp.html#91e9aa710642047a93142bdf557f1a1b"><span class="id" title="notation">:=</span></a> <a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="PLF.Imp.html#ad27fd091d9c8494ce7e5135135d19a8"><span class="id" title="notation">+</span></a> 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">end</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="prog_b" class="idref" href="#prog_b"><span class="id" title="definition">prog_b</span></a> : <a class="idref" href="PLF.Imp.html#com"><span class="id" title="inductive">com</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">if</span></a> <a class="idref" href="PLF.Imp.html#5a96623d056c293ebbcdf03005796e09"><span class="id" title="notation">(</span></a><a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="PLF.Imp.html#9e5b22caf5d7cf490e97976162618c2a"><span class="id" title="notation">=</span></a> 0<a class="idref" href="PLF.Imp.html#5a96623d056c293ebbcdf03005796e09"><span class="id" title="notation">)</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">then</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="PLF.Imp.html#91e9aa710642047a93142bdf557f1a1b"><span class="id" title="notation">:=</span></a> <a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="PLF.Imp.html#ad27fd091d9c8494ce7e5135135d19a8"><span class="id" title="notation">+</span></a> 1<a class="idref" href="PLF.Imp.html#313afe74ec81f2da17d8e7bca3b042e7"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#Y"><span class="id" title="definition">Y</span></a> <a class="idref" href="PLF.Imp.html#91e9aa710642047a93142bdf557f1a1b"><span class="id" title="notation">:=</span></a> 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#:com:com_scope:'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">else</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#Y"><span class="id" title="definition">Y</span></a> <a class="idref" href="PLF.Imp.html#91e9aa710642047a93142bdf557f1a1b"><span class="id" title="notation">:=</span></a> 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#:com:com_scope:'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">end</span></a><a class="idref" href="PLF.Imp.html#313afe74ec81f2da17d8e7bca3b042e7"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="PLF.Imp.html#91e9aa710642047a93142bdf557f1a1b"><span class="id" title="notation">:=</span></a> <a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="PLF.Imp.html#:com::x_'-'_x"><span class="id" title="notation">-</span></a> <a class="idref" href="PLF.Imp.html#Y"><span class="id" title="definition">Y</span></a><a class="idref" href="PLF.Imp.html#313afe74ec81f2da17d8e7bca3b042e7"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#Y"><span class="id" title="definition">Y</span></a> <a class="idref" href="PLF.Imp.html#91e9aa710642047a93142bdf557f1a1b"><span class="id" title="notation">:=</span></a> 0 <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="prog_c" class="idref" href="#prog_c"><span class="id" title="definition">prog_c</span></a> : <a class="idref" href="PLF.Imp.html#com"><span class="id" title="inductive">com</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'skip'"><span class="id" title="notation">skip</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a> .<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="prog_d" class="idref" href="#prog_d"><span class="id" title="definition">prog_d</span></a> : <a class="idref" href="PLF.Imp.html#com"><span class="id" title="inductive">com</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">while</span></a> <a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="PLF.Imp.html#:com::x_'&lt;&gt;'_x"><span class="id" title="notation">≠</span></a> 0 <a class="idref" href="PLF.Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">do</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="PLF.Imp.html#91e9aa710642047a93142bdf557f1a1b"><span class="id" title="notation">:=</span></a> <a class="idref" href="PLF.Imp.html#5a96623d056c293ebbcdf03005796e09"><span class="id" title="notation">(</span></a><a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="PLF.Imp.html#a73c7b35e67094dc8ae672f3a93da066"><span class="id" title="notation">×</span></a> <a class="idref" href="PLF.Imp.html#Y"><span class="id" title="definition">Y</span></a><a class="idref" href="PLF.Imp.html#5a96623d056c293ebbcdf03005796e09"><span class="id" title="notation">)</span></a> <a class="idref" href="PLF.Imp.html#ad27fd091d9c8494ce7e5135135d19a8"><span class="id" title="notation">+</span></a> 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">end</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="prog_e" class="idref" href="#prog_e"><span class="id" title="definition">prog_e</span></a> : <a class="idref" href="PLF.Imp.html#com"><span class="id" title="inductive">com</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Imp.html#Y"><span class="id" title="definition">Y</span></a> <a class="idref" href="PLF.Imp.html#91e9aa710642047a93142bdf557f1a1b"><span class="id" title="notation">:=</span></a> 0 <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="prog_f" class="idref" href="#prog_f"><span class="id" title="definition">prog_f</span></a> : <a class="idref" href="PLF.Imp.html#com"><span class="id" title="inductive">com</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Imp.html#Y"><span class="id" title="definition">Y</span></a> <a class="idref" href="PLF.Imp.html#91e9aa710642047a93142bdf557f1a1b"><span class="id" title="notation">:=</span></a> <a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="PLF.Imp.html#ad27fd091d9c8494ce7e5135135d19a8"><span class="id" title="notation">+</span></a> 1<a class="idref" href="PLF.Imp.html#313afe74ec81f2da17d8e7bca3b042e7"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">while</span></a> <a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="PLF.Imp.html#:com::x_'&lt;&gt;'_x"><span class="id" title="notation">≠</span></a> <a class="idref" href="PLF.Imp.html#Y"><span class="id" title="definition">Y</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">do</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#Y"><span class="id" title="definition">Y</span></a> <a class="idref" href="PLF.Imp.html#91e9aa710642047a93142bdf557f1a1b"><span class="id" title="notation">:=</span></a> <a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="PLF.Imp.html#ad27fd091d9c8494ce7e5135135d19a8"><span class="id" title="notation">+</span></a> 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">end</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="prog_g" class="idref" href="#prog_g"><span class="id" title="definition">prog_g</span></a> : <a class="idref" href="PLF.Imp.html#com"><span class="id" title="inductive">com</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">while</span></a> <a class="idref" href="PLF.Imp.html#:com::'true'"><span class="id" title="notation">true</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">do</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#:com:com_scope:'skip'"><span class="id" title="notation">skip</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">end</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="prog_h" class="idref" href="#prog_h"><span class="id" title="definition">prog_h</span></a> : <a class="idref" href="PLF.Imp.html#com"><span class="id" title="inductive">com</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">while</span></a> <a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="PLF.Imp.html#:com::x_'&lt;&gt;'_x"><span class="id" title="notation">≠</span></a> <a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">do</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="PLF.Imp.html#91e9aa710642047a93142bdf557f1a1b"><span class="id" title="notation">:=</span></a> <a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="PLF.Imp.html#ad27fd091d9c8494ce7e5135135d19a8"><span class="id" title="notation">+</span></a> 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">end</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="prog_i" class="idref" href="#prog_i"><span class="id" title="definition">prog_i</span></a> : <a class="idref" href="PLF.Imp.html#com"><span class="id" title="inductive">com</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">while</span></a> <a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="PLF.Imp.html#:com::x_'&lt;&gt;'_x"><span class="id" title="notation">≠</span></a> <a class="idref" href="PLF.Imp.html#Y"><span class="id" title="definition">Y</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">do</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="PLF.Imp.html#91e9aa710642047a93142bdf557f1a1b"><span class="id" title="notation">:=</span></a> <a class="idref" href="PLF.Imp.html#Y"><span class="id" title="definition">Y</span></a> <a class="idref" href="PLF.Imp.html#ad27fd091d9c8494ce7e5135135d19a8"><span class="id" title="notation">+</span></a> 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">end</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="equiv_classes" class="idref" href="#equiv_classes"><span class="id" title="definition">equiv_classes</span></a> : <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> (<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="PLF.Imp.html#com"><span class="id" title="inductive">com</span></a>)<br/>
&nbsp;&nbsp;. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="manual_grade_for_equiv_classes" class="idref" href="#manual_grade_for_equiv_classes"><span class="id" title="definition">manual_grade_for_equiv_classes</span></a> : <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> (<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">×</span></a><span class="id" title="inductive">string</span>) := <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a id="lab18"></a><h1 class="section">Properties of Behavioral Equivalence</h1>

<div class="paragraph"> </div>

 We next consider some fundamental properties of program
    equivalence. 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a id="lab19"></a><h2 class="section">Behavioral Equivalence Is an Equivalence</h2>

<div class="paragraph"> </div>

 First, let's verify that the equivalences on <span class="inlinecode"><span class="id" title="var">aexps</span></span>, <span class="inlinecode"><span class="id" title="var">bexps</span></span>, and
    <span class="inlinecode"><span class="id" title="var">com</span></span>s really are <i>equivalences</i> -- i.e., that they are reflexive,
    symmetric, and transitive.  The proofs are all easy. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <a id="refl_aequiv" class="idref" href="#refl_aequiv"><span class="id" title="lemma">refl_aequiv</span></a> : <span class="id" title="keyword">∀</span> (<a id="a:44" class="idref" href="#a:44"><span class="id" title="binder">a</span></a> : <a class="idref" href="PLF.Imp.html#aexp"><span class="id" title="inductive">aexp</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#aequiv"><span class="id" title="definition">aequiv</span></a> <a class="idref" href="PLF.Equiv.html#a:44"><span class="id" title="variable">a</span></a> <a class="idref" href="PLF.Equiv.html#a:44"><span class="id" title="variable">a</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">st</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="sym_aequiv" class="idref" href="#sym_aequiv"><span class="id" title="lemma">sym_aequiv</span></a> : <span class="id" title="keyword">∀</span> (<a id="a1:45" class="idref" href="#a1:45"><span class="id" title="binder">a1</span></a> <a id="a2:46" class="idref" href="#a2:46"><span class="id" title="binder">a2</span></a> : <a class="idref" href="PLF.Imp.html#aexp"><span class="id" title="inductive">aexp</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#aequiv"><span class="id" title="definition">aequiv</span></a> <a class="idref" href="PLF.Equiv.html#a1:45"><span class="id" title="variable">a1</span></a> <a class="idref" href="PLF.Equiv.html#a2:46"><span class="id" title="variable">a2</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="PLF.Equiv.html#aequiv"><span class="id" title="definition">aequiv</span></a> <a class="idref" href="PLF.Equiv.html#a2:46"><span class="id" title="variable">a2</span></a> <a class="idref" href="PLF.Equiv.html#a1:45"><span class="id" title="variable">a1</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a1</span> <span class="id" title="var">a2</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">st</span>. <span class="id" title="tactic">symmetry</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="trans_aequiv" class="idref" href="#trans_aequiv"><span class="id" title="lemma">trans_aequiv</span></a> : <span class="id" title="keyword">∀</span> (<a id="a1:47" class="idref" href="#a1:47"><span class="id" title="binder">a1</span></a> <a id="a2:48" class="idref" href="#a2:48"><span class="id" title="binder">a2</span></a> <a id="a3:49" class="idref" href="#a3:49"><span class="id" title="binder">a3</span></a> : <a class="idref" href="PLF.Imp.html#aexp"><span class="id" title="inductive">aexp</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#aequiv"><span class="id" title="definition">aequiv</span></a> <a class="idref" href="PLF.Equiv.html#a1:47"><span class="id" title="variable">a1</span></a> <a class="idref" href="PLF.Equiv.html#a2:48"><span class="id" title="variable">a2</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="PLF.Equiv.html#aequiv"><span class="id" title="definition">aequiv</span></a> <a class="idref" href="PLF.Equiv.html#a2:48"><span class="id" title="variable">a2</span></a> <a class="idref" href="PLF.Equiv.html#a3:49"><span class="id" title="variable">a3</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="PLF.Equiv.html#aequiv"><span class="id" title="definition">aequiv</span></a> <a class="idref" href="PLF.Equiv.html#a1:47"><span class="id" title="variable">a1</span></a> <a class="idref" href="PLF.Equiv.html#a3:49"><span class="id" title="variable">a3</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="PLF.Equiv.html#aequiv"><span class="id" title="definition">aequiv</span></a>. <span class="id" title="tactic">intros</span> <span class="id" title="var">a1</span> <span class="id" title="var">a2</span> <span class="id" title="var">a3</span> <span class="id" title="var">H12</span> <span class="id" title="var">H23</span> <span class="id" title="var">st</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">H12</span> <span class="id" title="var">st</span>). <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">H23</span> <span class="id" title="var">st</span>). <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="refl_bequiv" class="idref" href="#refl_bequiv"><span class="id" title="lemma">refl_bequiv</span></a> : <span class="id" title="keyword">∀</span> (<a id="b:50" class="idref" href="#b:50"><span class="id" title="binder">b</span></a> : <a class="idref" href="PLF.Imp.html#bexp"><span class="id" title="inductive">bexp</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#bequiv"><span class="id" title="definition">bequiv</span></a> <a class="idref" href="PLF.Equiv.html#b:50"><span class="id" title="variable">b</span></a> <a class="idref" href="PLF.Equiv.html#b:50"><span class="id" title="variable">b</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="PLF.Equiv.html#bequiv"><span class="id" title="definition">bequiv</span></a>. <span class="id" title="tactic">intros</span> <span class="id" title="var">b</span> <span class="id" title="var">st</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="sym_bequiv" class="idref" href="#sym_bequiv"><span class="id" title="lemma">sym_bequiv</span></a> : <span class="id" title="keyword">∀</span> (<a id="b1:51" class="idref" href="#b1:51"><span class="id" title="binder">b1</span></a> <a id="b2:52" class="idref" href="#b2:52"><span class="id" title="binder">b2</span></a> : <a class="idref" href="PLF.Imp.html#bexp"><span class="id" title="inductive">bexp</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#bequiv"><span class="id" title="definition">bequiv</span></a> <a class="idref" href="PLF.Equiv.html#b1:51"><span class="id" title="variable">b1</span></a> <a class="idref" href="PLF.Equiv.html#b2:52"><span class="id" title="variable">b2</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="PLF.Equiv.html#bequiv"><span class="id" title="definition">bequiv</span></a> <a class="idref" href="PLF.Equiv.html#b2:52"><span class="id" title="variable">b2</span></a> <a class="idref" href="PLF.Equiv.html#b1:51"><span class="id" title="variable">b1</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="PLF.Equiv.html#bequiv"><span class="id" title="definition">bequiv</span></a>. <span class="id" title="tactic">intros</span> <span class="id" title="var">b1</span> <span class="id" title="var">b2</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">st</span>. <span class="id" title="tactic">symmetry</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="trans_bequiv" class="idref" href="#trans_bequiv"><span class="id" title="lemma">trans_bequiv</span></a> : <span class="id" title="keyword">∀</span> (<a id="b1:53" class="idref" href="#b1:53"><span class="id" title="binder">b1</span></a> <a id="b2:54" class="idref" href="#b2:54"><span class="id" title="binder">b2</span></a> <a id="b3:55" class="idref" href="#b3:55"><span class="id" title="binder">b3</span></a> : <a class="idref" href="PLF.Imp.html#bexp"><span class="id" title="inductive">bexp</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#bequiv"><span class="id" title="definition">bequiv</span></a> <a class="idref" href="PLF.Equiv.html#b1:53"><span class="id" title="variable">b1</span></a> <a class="idref" href="PLF.Equiv.html#b2:54"><span class="id" title="variable">b2</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="PLF.Equiv.html#bequiv"><span class="id" title="definition">bequiv</span></a> <a class="idref" href="PLF.Equiv.html#b2:54"><span class="id" title="variable">b2</span></a> <a class="idref" href="PLF.Equiv.html#b3:55"><span class="id" title="variable">b3</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="PLF.Equiv.html#bequiv"><span class="id" title="definition">bequiv</span></a> <a class="idref" href="PLF.Equiv.html#b1:53"><span class="id" title="variable">b1</span></a> <a class="idref" href="PLF.Equiv.html#b3:55"><span class="id" title="variable">b3</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="PLF.Equiv.html#bequiv"><span class="id" title="definition">bequiv</span></a>. <span class="id" title="tactic">intros</span> <span class="id" title="var">b1</span> <span class="id" title="var">b2</span> <span class="id" title="var">b3</span> <span class="id" title="var">H12</span> <span class="id" title="var">H23</span> <span class="id" title="var">st</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">H12</span> <span class="id" title="var">st</span>). <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">H23</span> <span class="id" title="var">st</span>). <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="refl_cequiv" class="idref" href="#refl_cequiv"><span class="id" title="lemma">refl_cequiv</span></a> : <span class="id" title="keyword">∀</span> (<a id="c:56" class="idref" href="#c:56"><span class="id" title="binder">c</span></a> : <a class="idref" href="PLF.Imp.html#com"><span class="id" title="inductive">com</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#cequiv"><span class="id" title="definition">cequiv</span></a> <a class="idref" href="PLF.Equiv.html#c:56"><span class="id" title="variable">c</span></a> <a class="idref" href="PLF.Equiv.html#c:56"><span class="id" title="variable">c</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="PLF.Equiv.html#cequiv"><span class="id" title="definition">cequiv</span></a>. <span class="id" title="tactic">intros</span> <span class="id" title="var">c</span> <span class="id" title="var">st</span> <span class="id" title="var">st'</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="sym_cequiv" class="idref" href="#sym_cequiv"><span class="id" title="lemma">sym_cequiv</span></a> : <span class="id" title="keyword">∀</span> (<a id="c1:57" class="idref" href="#c1:57"><span class="id" title="binder">c1</span></a> <a id="c2:58" class="idref" href="#c2:58"><span class="id" title="binder">c2</span></a> : <a class="idref" href="PLF.Imp.html#com"><span class="id" title="inductive">com</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#cequiv"><span class="id" title="definition">cequiv</span></a> <a class="idref" href="PLF.Equiv.html#c1:57"><span class="id" title="variable">c1</span></a> <a class="idref" href="PLF.Equiv.html#c2:58"><span class="id" title="variable">c2</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="PLF.Equiv.html#cequiv"><span class="id" title="definition">cequiv</span></a> <a class="idref" href="PLF.Equiv.html#c2:58"><span class="id" title="variable">c2</span></a> <a class="idref" href="PLF.Equiv.html#c1:57"><span class="id" title="variable">c1</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="PLF.Equiv.html#cequiv"><span class="id" title="definition">cequiv</span></a>. <span class="id" title="tactic">intros</span> <span class="id" title="var">c1</span> <span class="id" title="var">c2</span> <span class="id" title="var">H</span> <span class="id" title="var">st</span> <span class="id" title="var">st'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="trans_cequiv" class="idref" href="#trans_cequiv"><span class="id" title="lemma">trans_cequiv</span></a> : <span class="id" title="keyword">∀</span> (<a id="c1:59" class="idref" href="#c1:59"><span class="id" title="binder">c1</span></a> <a id="c2:60" class="idref" href="#c2:60"><span class="id" title="binder">c2</span></a> <a id="c3:61" class="idref" href="#c3:61"><span class="id" title="binder">c3</span></a> : <a class="idref" href="PLF.Imp.html#com"><span class="id" title="inductive">com</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#cequiv"><span class="id" title="definition">cequiv</span></a> <a class="idref" href="PLF.Equiv.html#c1:59"><span class="id" title="variable">c1</span></a> <a class="idref" href="PLF.Equiv.html#c2:60"><span class="id" title="variable">c2</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="PLF.Equiv.html#cequiv"><span class="id" title="definition">cequiv</span></a> <a class="idref" href="PLF.Equiv.html#c2:60"><span class="id" title="variable">c2</span></a> <a class="idref" href="PLF.Equiv.html#c3:61"><span class="id" title="variable">c3</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="PLF.Equiv.html#cequiv"><span class="id" title="definition">cequiv</span></a> <a class="idref" href="PLF.Equiv.html#c1:59"><span class="id" title="variable">c1</span></a> <a class="idref" href="PLF.Equiv.html#c3:61"><span class="id" title="variable">c3</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="PLF.Equiv.html#cequiv"><span class="id" title="definition">cequiv</span></a>. <span class="id" title="tactic">intros</span> <span class="id" title="var">c1</span> <span class="id" title="var">c2</span> <span class="id" title="var">c3</span> <span class="id" title="var">H12</span> <span class="id" title="var">H23</span> <span class="id" title="var">st</span> <span class="id" title="var">st'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H12</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H23</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab20"></a><h2 class="section">Behavioral Equivalence Is a Congruence</h2>

<div class="paragraph"> </div>

 Less obviously, behavioral equivalence is also a <i>congruence</i>.
    That is, the equivalence of two subprograms implies the
    equivalence of the larger programs in which they are embedded:

<div class="paragraph"> </div>

                 aequiv a a'
<hr/>

         cequiv (x := a) (x := a')

<div class="paragraph"> </div>

              cequiv c1 c1'
              cequiv c2 c2'
<hr/>

         cequiv (c1;c2) (c1';c2')

<div class="paragraph"> </div>

    ... and so on for the other forms of commands. 
<div class="paragraph"> </div>

 (Note that we are using the inference rule notation here not
    as part of an inductive definition, but simply to write down some
    valid implications in a readable format. We prove these
    implications below.) 
<div class="paragraph"> </div>

 We will see a concrete example of why these congruence
    properties are important in the following section (in the proof of
    <span class="inlinecode"><span class="id" title="var">fold_constants_com_sound</span></span>), but the main idea is that they allow
    us to replace a small part of a large program with an equivalent
    small part and know that the whole large programs are equivalent
    <i>without</i> doing an explicit proof about the parts that didn't
    change -- i.e., the "proof burden" of a small change to a large
    program is proportional to the size of the change, not the
    program! 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a id="CAsgn_congruence" class="idref" href="#CAsgn_congruence"><span class="id" title="lemma">CAsgn_congruence</span></a> : <span class="id" title="keyword">∀</span> <a id="x:62" class="idref" href="#x:62"><span class="id" title="binder">x</span></a> <a id="a:63" class="idref" href="#a:63"><span class="id" title="binder">a</span></a> <a id="a':64" class="idref" href="#a':64"><span class="id" title="binder">a'</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#aequiv"><span class="id" title="definition">aequiv</span></a> <a class="idref" href="PLF.Equiv.html#a:63"><span class="id" title="variable">a</span></a> <a class="idref" href="PLF.Equiv.html#a':64"><span class="id" title="variable">a'</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#cequiv"><span class="id" title="definition">cequiv</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a><a class="idref" href="PLF.Equiv.html#x:62"><span class="id" title="variable">x</span></a> <a class="idref" href="PLF.Imp.html#91e9aa710642047a93142bdf557f1a1b"><span class="id" title="notation">:=</span></a> <a class="idref" href="PLF.Equiv.html#a:63"><span class="id" title="variable">a</span></a><a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a><a class="idref" href="PLF.Equiv.html#x:62"><span class="id" title="variable">x</span></a> <a class="idref" href="PLF.Imp.html#91e9aa710642047a93142bdf557f1a1b"><span class="id" title="notation">:=</span></a> <a class="idref" href="PLF.Equiv.html#a':64"><span class="id" title="variable">a'</span></a><a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span> <span class="id" title="var">a'</span> <span class="id" title="var">Heqv</span> <span class="id" title="var">st</span> <span class="id" title="var">st'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">Hceval</span>.<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">Hceval</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="PLF.Imp.html#E_Asgn"><span class="id" title="constructor">E_Asgn</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Heqv</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">Hceval</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="PLF.Imp.html#E_Asgn"><span class="id" title="constructor">E_Asgn</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Heqv</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
The congruence property for loops is a little more interesting,
    since it requires induction.

<div class="paragraph"> </div>

    <i>Theorem</i>: Equivalence is a congruence for <span class="inlinecode"><span class="id" title="var">while</span></span> -- that is, if
    <span class="inlinecode"><span class="id" title="var">b</span></span> is equivalent to <span class="inlinecode"><span class="id" title="var">b'</span></span> and <span class="inlinecode"><span class="id" title="var">c</span></span> is equivalent to <span class="inlinecode"><span class="id" title="var">c'</span></span>, then
    <span class="inlinecode"><span class="id" title="var">while</span></span> <span class="inlinecode"><span class="id" title="var">b</span></span> <span class="inlinecode"><span class="id" title="tactic">do</span></span> <span class="inlinecode"><span class="id" title="var">c</span></span> <span class="inlinecode"><span class="id" title="keyword">end</span></span> is equivalent to <span class="inlinecode"><span class="id" title="var">while</span></span> <span class="inlinecode"><span class="id" title="var">b'</span></span> <span class="inlinecode"><span class="id" title="tactic">do</span></span> <span class="inlinecode"><span class="id" title="var">c'</span></span> <span class="inlinecode"><span class="id" title="keyword">end</span></span>.

<div class="paragraph"> </div>

    <i>Proof</i>: Suppose <span class="inlinecode"><span class="id" title="var">b</span></span> is equivalent to <span class="inlinecode"><span class="id" title="var">b'</span></span> and <span class="inlinecode"><span class="id" title="var">c</span></span> is
    equivalent to <span class="inlinecode"><span class="id" title="var">c'</span></span>.  We must show, for every <span class="inlinecode"><span class="id" title="var">st</span></span> and <span class="inlinecode"><span class="id" title="var">st'</span></span>, that
    <span class="inlinecode"><span class="id" title="var">st</span></span> <span class="inlinecode">=[</span> <span class="inlinecode"><span class="id" title="var">while</span></span> <span class="inlinecode"><span class="id" title="var">b</span></span> <span class="inlinecode"><span class="id" title="tactic">do</span></span> <span class="inlinecode"><span class="id" title="var">c</span></span> <span class="inlinecode"><span class="id" title="keyword">end</span></span> <span class="inlinecode">]=&gt;</span> <span class="inlinecode"><span class="id" title="var">st'</span></span> iff <span class="inlinecode"><span class="id" title="var">st</span></span> <span class="inlinecode">=[</span> <span class="inlinecode"><span class="id" title="var">while</span></span> <span class="inlinecode"><span class="id" title="var">b'</span></span> <span class="inlinecode"><span class="id" title="tactic">do</span></span> <span class="inlinecode"><span class="id" title="var">c'</span></span>
    <span class="inlinecode"><span class="id" title="keyword">end</span></span> <span class="inlinecode">]=&gt;</span> <span class="inlinecode"><span class="id" title="var">st'</span></span>.  We consider the two directions separately.

<div class="paragraph"> </div>

<ul class="doclist">
<li> (<span class="inlinecode">→</span>) We show that <span class="inlinecode"><span class="id" title="var">st</span></span> <span class="inlinecode">=[</span> <span class="inlinecode"><span class="id" title="var">while</span></span> <span class="inlinecode"><span class="id" title="var">b</span></span> <span class="inlinecode"><span class="id" title="tactic">do</span></span> <span class="inlinecode"><span class="id" title="var">c</span></span> <span class="inlinecode"><span class="id" title="keyword">end</span></span> <span class="inlinecode">]=&gt;</span> <span class="inlinecode"><span class="id" title="var">st'</span></span> implies
        <span class="inlinecode"><span class="id" title="var">st</span></span> <span class="inlinecode">=[</span> <span class="inlinecode"><span class="id" title="var">while</span></span> <span class="inlinecode"><span class="id" title="var">b'</span></span> <span class="inlinecode"><span class="id" title="tactic">do</span></span> <span class="inlinecode"><span class="id" title="var">c'</span></span> <span class="inlinecode"><span class="id" title="keyword">end</span></span> <span class="inlinecode">]=&gt;</span> <span class="inlinecode"><span class="id" title="var">st'</span></span>, by induction on a
        derivation of <span class="inlinecode"><span class="id" title="var">st</span></span> <span class="inlinecode">=[</span> <span class="inlinecode"><span class="id" title="var">while</span></span> <span class="inlinecode"><span class="id" title="var">b</span></span> <span class="inlinecode"><span class="id" title="tactic">do</span></span> <span class="inlinecode"><span class="id" title="var">c</span></span> <span class="inlinecode"><span class="id" title="keyword">end</span></span> <span class="inlinecode">]=&gt;</span> <span class="inlinecode"><span class="id" title="var">st'</span></span>.  The only
        nontrivial cases are when the final rule in the derivation is
        <span class="inlinecode"><span class="id" title="var">E_WhileFalse</span></span> or <span class="inlinecode"><span class="id" title="var">E_WhileTrue</span></span>.

<div class="paragraph"> </div>

<ul class="doclist">
<li> <span class="inlinecode"><span class="id" title="var">E_WhileFalse</span></span>: In this case, the form of the rule gives us
            <span class="inlinecode"><span class="id" title="var">beval</span></span> <span class="inlinecode"><span class="id" title="var">st</span></span> <span class="inlinecode"><span class="id" title="var">b</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">false</span></span> and <span class="inlinecode"><span class="id" title="var">st</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">st'</span></span>.  But then, since
            <span class="inlinecode"><span class="id" title="var">b</span></span> and <span class="inlinecode"><span class="id" title="var">b'</span></span> are equivalent, we have <span class="inlinecode"><span class="id" title="var">beval</span></span> <span class="inlinecode"><span class="id" title="var">st</span></span> <span class="inlinecode"><span class="id" title="var">b'</span></span> <span class="inlinecode">=</span>
            <span class="inlinecode"><span class="id" title="var">false</span></span>, and <span class="inlinecode"><span class="id" title="var">E_WhileFalse</span></span> applies, giving us
            <span class="inlinecode"><span class="id" title="var">st</span></span> <span class="inlinecode">=[</span> <span class="inlinecode"><span class="id" title="var">while</span></span> <span class="inlinecode"><span class="id" title="var">b'</span></span> <span class="inlinecode"><span class="id" title="tactic">do</span></span> <span class="inlinecode"><span class="id" title="var">c'</span></span> <span class="inlinecode"><span class="id" title="keyword">end</span></span> <span class="inlinecode">]=&gt;</span> <span class="inlinecode"><span class="id" title="var">st'</span></span>, as required.

<div class="paragraph"> </div>


</li>
<li> <span class="inlinecode"><span class="id" title="var">E_WhileTrue</span></span>: The form of the rule now gives us <span class="inlinecode"><span class="id" title="var">beval</span></span> <span class="inlinecode"><span class="id" title="var">st</span></span>
            <span class="inlinecode"><span class="id" title="var">b</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">true</span></span>, with <span class="inlinecode"><span class="id" title="var">st</span></span> <span class="inlinecode">=[</span> <span class="inlinecode"><span class="id" title="var">c</span></span> <span class="inlinecode">]=&gt;</span> <span class="inlinecode"><span class="id" title="var">st'0</span></span> and <span class="inlinecode"><span class="id" title="var">st'0</span></span> <span class="inlinecode">=[</span> <span class="inlinecode"><span class="id" title="var">while</span></span>
            <span class="inlinecode"><span class="id" title="var">b</span></span> <span class="inlinecode"><span class="id" title="tactic">do</span></span> <span class="inlinecode"><span class="id" title="var">c</span></span> <span class="inlinecode"><span class="id" title="keyword">end</span></span> <span class="inlinecode">]=&gt;</span> <span class="inlinecode"><span class="id" title="var">st'</span></span> for some state <span class="inlinecode"><span class="id" title="var">st'0</span></span>, with the
            induction hypothesis <span class="inlinecode"><span class="id" title="var">st'0</span></span> <span class="inlinecode">=[</span> <span class="inlinecode"><span class="id" title="var">while</span></span> <span class="inlinecode"><span class="id" title="var">b'</span></span> <span class="inlinecode"><span class="id" title="tactic">do</span></span> <span class="inlinecode"><span class="id" title="var">c'</span></span> <span class="inlinecode"><span class="id" title="keyword">end</span></span> <span class="inlinecode">]=&gt;</span>
            <span class="inlinecode"><span class="id" title="var">st'</span></span>.

<div class="paragraph"> </div>

            Since <span class="inlinecode"><span class="id" title="var">c</span></span> and <span class="inlinecode"><span class="id" title="var">c'</span></span> are equivalent, we know that <span class="inlinecode"><span class="id" title="var">st</span></span> <span class="inlinecode">=[</span>
            <span class="inlinecode"><span class="id" title="var">c'</span></span> <span class="inlinecode">]=&gt;</span> <span class="inlinecode"><span class="id" title="var">st'0</span></span>.  And since <span class="inlinecode"><span class="id" title="var">b</span></span> and <span class="inlinecode"><span class="id" title="var">b'</span></span> are equivalent,
            we have <span class="inlinecode"><span class="id" title="var">beval</span></span> <span class="inlinecode"><span class="id" title="var">st</span></span> <span class="inlinecode"><span class="id" title="var">b'</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">true</span></span>.  Now <span class="inlinecode"><span class="id" title="var">E_WhileTrue</span></span> applies,
            giving us <span class="inlinecode"><span class="id" title="var">st</span></span> <span class="inlinecode">=[</span> <span class="inlinecode"><span class="id" title="var">while</span></span> <span class="inlinecode"><span class="id" title="var">b'</span></span> <span class="inlinecode"><span class="id" title="tactic">do</span></span> <span class="inlinecode"><span class="id" title="var">c'</span></span> <span class="inlinecode"><span class="id" title="keyword">end</span></span> <span class="inlinecode">]=&gt;</span> <span class="inlinecode"><span class="id" title="var">st'</span></span>, as
            required.

<div class="paragraph"> </div>


</li>
</ul>

</li>
<li> (<span class="inlinecode">&lt;-</span>) Similar. <font size=-2>&#9744;</font> 

</li>
</ul>
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a id="CWhile_congruence" class="idref" href="#CWhile_congruence"><span class="id" title="lemma">CWhile_congruence</span></a> : <span class="id" title="keyword">∀</span> <a id="b:65" class="idref" href="#b:65"><span class="id" title="binder">b</span></a> <a id="b':66" class="idref" href="#b':66"><span class="id" title="binder">b'</span></a> <a id="c:67" class="idref" href="#c:67"><span class="id" title="binder">c</span></a> <a id="c':68" class="idref" href="#c':68"><span class="id" title="binder">c'</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#bequiv"><span class="id" title="definition">bequiv</span></a> <a class="idref" href="PLF.Equiv.html#b:65"><span class="id" title="variable">b</span></a> <a class="idref" href="PLF.Equiv.html#b':66"><span class="id" title="variable">b'</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="PLF.Equiv.html#cequiv"><span class="id" title="definition">cequiv</span></a> <a class="idref" href="PLF.Equiv.html#c:67"><span class="id" title="variable">c</span></a> <a class="idref" href="PLF.Equiv.html#c':68"><span class="id" title="variable">c'</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#cequiv"><span class="id" title="definition">cequiv</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">while</span></a> <a class="idref" href="PLF.Equiv.html#b:65"><span class="id" title="variable">b</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">do</span></a> <a class="idref" href="PLF.Equiv.html#c:67"><span class="id" title="variable">c</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">end</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">while</span></a> <a class="idref" href="PLF.Equiv.html#b':66"><span class="id" title="variable">b'</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">do</span></a> <a class="idref" href="PLF.Equiv.html#c':68"><span class="id" title="variable">c'</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">end</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">A</span>: <span class="id" title="keyword">∀</span> (<a id="b:69" class="idref" href="#b:69"><span class="id" title="binder"><span id="b:75" class="id">b</span></span></a> <a id="b':70" class="idref" href="#b':70"><span class="id" title="binder"><span id="b':76" class="id">b'</span></span></a> : <a class="idref" href="PLF.Imp.html#bexp"><span class="id" title="inductive">bexp</span></a>) (<a id="c:71" class="idref" href="#c:71"><span class="id" title="binder"><span id="c:77" class="id">c</span></span></a> <a id="c':72" class="idref" href="#c':72"><span class="id" title="binder"><span id="c':78" class="id">c'</span></span></a> : <a class="idref" href="PLF.Imp.html#com"><span class="id" title="inductive">com</span></a>) (<a id="st:73" class="idref" href="#st:73"><span class="id" title="binder"><span id="st:79" class="id">st</span></span></a> <a id="st':74" class="idref" href="#st':74"><span class="id" title="binder"><span id="st':80" class="id">st'</span></span></a> : <a class="idref" href="PLF.Imp.html#state"><span class="id" title="definition">state</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#bequiv"><span class="id" title="definition">bequiv</span></a> <a class="idref" href="PLF.Equiv.html#b:69"><span class="id" title="variable">b</span></a> <a class="idref" href="PLF.Equiv.html#b':70"><span class="id" title="variable">b'</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="PLF.Equiv.html#cequiv"><span class="id" title="definition">cequiv</span></a> <a class="idref" href="PLF.Equiv.html#c:71"><span class="id" title="variable">c</span></a> <a class="idref" href="PLF.Equiv.html#c':72"><span class="id" title="variable">c'</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#st:73"><span class="id" title="variable">st</span></a> <a class="idref" href="PLF.Imp.html#6037d1f4787d63984beccd5510872ee9"><span class="id" title="notation">=[</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">while</span></a> <a class="idref" href="PLF.Equiv.html#b:69"><span class="id" title="variable">b</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">do</span></a> <a class="idref" href="PLF.Equiv.html#c:71"><span class="id" title="variable">c</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">end</span></a> <a class="idref" href="PLF.Imp.html#6037d1f4787d63984beccd5510872ee9"><span class="id" title="notation">]=&gt;</span></a> <a class="idref" href="PLF.Equiv.html#st':74"><span class="id" title="variable">st'</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#st:73"><span class="id" title="variable">st</span></a> <a class="idref" href="PLF.Imp.html#6037d1f4787d63984beccd5510872ee9"><span class="id" title="notation">=[</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">while</span></a> <a class="idref" href="PLF.Equiv.html#b':70"><span class="id" title="variable">b'</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">do</span></a> <a class="idref" href="PLF.Equiv.html#c':72"><span class="id" title="variable">c'</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">end</span></a> <a class="idref" href="PLF.Imp.html#6037d1f4787d63984beccd5510872ee9"><span class="id" title="notation">]=&gt;</span></a> <a class="idref" href="PLF.Equiv.html#st':74"><span class="id" title="variable">st'</span></a>).<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">unfold</span> <a class="idref" href="PLF.Equiv.html#bequiv"><span class="id" title="definition">bequiv</span></a>,<a class="idref" href="PLF.Equiv.html#cequiv"><span class="id" title="definition">cequiv</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">b</span> <span class="id" title="var">b'</span> <span class="id" title="var">c</span> <span class="id" title="var">c'</span> <span class="id" title="var">st</span> <span class="id" title="var">st'</span> <span class="id" title="var">Hbe</span> <span class="id" title="var">Hc1e</span> <span class="id" title="var">Hce</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">remember</span> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">while</span></a> <span class="id" title="var">b</span> <a class="idref" href="PLF.Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">do</span></a> <span class="id" title="var">c</span> <a class="idref" href="PLF.Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">end</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a> <span class="id" title="keyword">as</span> <span class="id" title="var">cwhile</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">eqn</span>:<span class="id" title="var">Heqcwhile</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">Hce</span>; <span class="id" title="tactic">inversion</span> <span class="id" title="var">Heqcwhile</span>; <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="PLF.Imp.html#E_WhileFalse"><span class="id" title="constructor">E_WhileFalse</span></a>. <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">Hbe</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="PLF.Imp.html#E_WhileTrue"><span class="id" title="constructor">E_WhileTrue</span></a> <span class="id" title="keyword">with</span> (<span class="id" title="var">st'</span> := <span class="id" title="var">st'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;×  <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">Hbe</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">Hc1e</span> <span class="id" title="var">st</span> <span class="id" title="var">st'</span>). <span class="id" title="tactic">apply</span> <span class="id" title="var">Hce1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHHce2</span>. <span class="id" title="tactic">reflexivity</span>. }<br/>
<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">A</span>; <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">A</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="PLF.Equiv.html#sym_bequiv"><span class="id" title="lemma">sym_bequiv</span></a>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="PLF.Equiv.html#sym_cequiv"><span class="id" title="lemma">sym_cequiv</span></a>. <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab21"></a><h4 class="section">Exercise: 3 stars, standard, optional (CSeq_congruence)</h4>

</div>
<div class="code">
<span class="id" title="keyword">Theorem</span> <a id="CSeq_congruence" class="idref" href="#CSeq_congruence"><span class="id" title="lemma">CSeq_congruence</span></a> : <span class="id" title="keyword">∀</span> <a id="c1:81" class="idref" href="#c1:81"><span class="id" title="binder">c1</span></a> <a id="c1':82" class="idref" href="#c1':82"><span class="id" title="binder">c1'</span></a> <a id="c2:83" class="idref" href="#c2:83"><span class="id" title="binder">c2</span></a> <a id="c2':84" class="idref" href="#c2':84"><span class="id" title="binder">c2'</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#cequiv"><span class="id" title="definition">cequiv</span></a> <a class="idref" href="PLF.Equiv.html#c1:81"><span class="id" title="variable">c1</span></a> <a class="idref" href="PLF.Equiv.html#c1':82"><span class="id" title="variable">c1'</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="PLF.Equiv.html#cequiv"><span class="id" title="definition">cequiv</span></a> <a class="idref" href="PLF.Equiv.html#c2:83"><span class="id" title="variable">c2</span></a> <a class="idref" href="PLF.Equiv.html#c2':84"><span class="id" title="variable">c2'</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#cequiv"><span class="id" title="definition">cequiv</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Equiv.html#c1:81"><span class="id" title="variable">c1</span></a><a class="idref" href="PLF.Imp.html#313afe74ec81f2da17d8e7bca3b042e7"><span class="id" title="notation">;</span></a><a class="idref" href="PLF.Equiv.html#c2:83"><span class="id" title="variable">c2</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Equiv.html#c1':82"><span class="id" title="variable">c1'</span></a><a class="idref" href="PLF.Imp.html#313afe74ec81f2da17d8e7bca3b042e7"><span class="id" title="notation">;</span></a><a class="idref" href="PLF.Equiv.html#c2':84"><span class="id" title="variable">c2'</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
<div class="paragraph"> </div>

<a id="lab22"></a><h4 class="section">Exercise: 3 stars, standard (CIf_congruence)</h4>

</div>
<div class="code">
<span class="id" title="keyword">Theorem</span> <a id="CIf_congruence" class="idref" href="#CIf_congruence"><span class="id" title="lemma">CIf_congruence</span></a> : <span class="id" title="keyword">∀</span> <a id="b:85" class="idref" href="#b:85"><span class="id" title="binder">b</span></a> <a id="b':86" class="idref" href="#b':86"><span class="id" title="binder">b'</span></a> <a id="c1:87" class="idref" href="#c1:87"><span class="id" title="binder">c1</span></a> <a id="c1':88" class="idref" href="#c1':88"><span class="id" title="binder">c1'</span></a> <a id="c2:89" class="idref" href="#c2:89"><span class="id" title="binder">c2</span></a> <a id="c2':90" class="idref" href="#c2':90"><span class="id" title="binder">c2'</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#bequiv"><span class="id" title="definition">bequiv</span></a> <a class="idref" href="PLF.Equiv.html#b:85"><span class="id" title="variable">b</span></a> <a class="idref" href="PLF.Equiv.html#b':86"><span class="id" title="variable">b'</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="PLF.Equiv.html#cequiv"><span class="id" title="definition">cequiv</span></a> <a class="idref" href="PLF.Equiv.html#c1:87"><span class="id" title="variable">c1</span></a> <a class="idref" href="PLF.Equiv.html#c1':88"><span class="id" title="variable">c1'</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="PLF.Equiv.html#cequiv"><span class="id" title="definition">cequiv</span></a> <a class="idref" href="PLF.Equiv.html#c2:89"><span class="id" title="variable">c2</span></a> <a class="idref" href="PLF.Equiv.html#c2':90"><span class="id" title="variable">c2'</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#cequiv"><span class="id" title="definition">cequiv</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">if</span></a> <a class="idref" href="PLF.Equiv.html#b:85"><span class="id" title="variable">b</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">then</span></a> <a class="idref" href="PLF.Equiv.html#c1:87"><span class="id" title="variable">c1</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">else</span></a> <a class="idref" href="PLF.Equiv.html#c2:89"><span class="id" title="variable">c2</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">end</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">if</span></a> <a class="idref" href="PLF.Equiv.html#b':86"><span class="id" title="variable">b'</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">then</span></a> <a class="idref" href="PLF.Equiv.html#c1':88"><span class="id" title="variable">c1'</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">else</span></a> <a class="idref" href="PLF.Equiv.html#c2':90"><span class="id" title="variable">c2'</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">end</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
<div class="paragraph"> </div>

 For example, here are two equivalent programs and a proof of their
    equivalence using these congruence theorems... 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Example</span> <a id="congruence_example" class="idref" href="#congruence_example"><span class="id" title="definition">congruence_example</span></a>:<br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#cequiv"><span class="id" title="definition">cequiv</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="PLF.Imp.html#91e9aa710642047a93142bdf557f1a1b"><span class="id" title="notation">:=</span></a> 0<a class="idref" href="PLF.Imp.html#313afe74ec81f2da17d8e7bca3b042e7"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#:com:com_scope:'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">if</span></a> <a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="PLF.Imp.html#9e5b22caf5d7cf490e97976162618c2a"><span class="id" title="notation">=</span></a> 0 <a class="idref" href="PLF.Imp.html#:com:com_scope:'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">then</span></a> <a class="idref" href="PLF.Imp.html#Y"><span class="id" title="definition">Y</span></a> <a class="idref" href="PLF.Imp.html#91e9aa710642047a93142bdf557f1a1b"><span class="id" title="notation">:=</span></a> 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#:com:com_scope:'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">else</span></a> <a class="idref" href="PLF.Imp.html#Y"><span class="id" title="definition">Y</span></a> <a class="idref" href="PLF.Imp.html#91e9aa710642047a93142bdf557f1a1b"><span class="id" title="notation">:=</span></a> 42 <a class="idref" href="PLF.Imp.html#:com:com_scope:'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">end</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="PLF.Imp.html#91e9aa710642047a93142bdf557f1a1b"><span class="id" title="notation">:=</span></a> 0<a class="idref" href="PLF.Imp.html#313afe74ec81f2da17d8e7bca3b042e7"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#:com:com_scope:'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">if</span></a> <a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="PLF.Imp.html#9e5b22caf5d7cf490e97976162618c2a"><span class="id" title="notation">=</span></a> 0 <a class="idref" href="PLF.Imp.html#:com:com_scope:'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">then</span></a> <a class="idref" href="PLF.Imp.html#Y"><span class="id" title="definition">Y</span></a> <a class="idref" href="PLF.Imp.html#91e9aa710642047a93142bdf557f1a1b"><span class="id" title="notation">:=</span></a> <a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="PLF.Imp.html#:com::x_'-'_x"><span class="id" title="notation">-</span></a> <a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a>   <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#:com:com_scope:'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">else</span></a> <a class="idref" href="PLF.Imp.html#Y"><span class="id" title="definition">Y</span></a> <a class="idref" href="PLF.Imp.html#91e9aa710642047a93142bdf557f1a1b"><span class="id" title="notation">:=</span></a> 42 <a class="idref" href="PLF.Imp.html#:com:com_scope:'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">end</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="PLF.Equiv.html#CSeq_congruence"><span class="id" title="axiom">CSeq_congruence</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="PLF.Equiv.html#refl_cequiv"><span class="id" title="lemma">refl_cequiv</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="PLF.Equiv.html#CIf_congruence"><span class="id" title="axiom">CIf_congruence</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="PLF.Equiv.html#refl_bequiv"><span class="id" title="lemma">refl_bequiv</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="PLF.Equiv.html#CAsgn_congruence"><span class="id" title="lemma">CAsgn_congruence</span></a>. <span class="id" title="tactic">unfold</span> <a class="idref" href="PLF.Equiv.html#aequiv"><span class="id" title="definition">aequiv</span></a>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">symmetry</span>. <span class="id" title="tactic">apply</span> <span class="id" title="lemma">sub_diag</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="PLF.Equiv.html#refl_cequiv"><span class="id" title="lemma">refl_cequiv</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab23"></a><h4 class="section">Exercise: 3 stars, advanced (not_congr)</h4>


<div class="paragraph"> </div>

    We've shown that the <span class="inlinecode"><span class="id" title="var">cequiv</span></span> relation is both an equivalence and
    a congruence on commands.  Can you think of a relation on commands
    that is an equivalence but <i>not</i> a congruence?  Write down the
    relation (formally), together with an informal sketch of a proof
    that it is an equivalence but not a congruence. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a id="manual_grade_for_not_congr" class="idref" href="#manual_grade_for_not_congr"><span class="id" title="definition">manual_grade_for_not_congr</span></a> : <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> (<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">×</span></a><span class="id" title="inductive">string</span>) := <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a id="lab24"></a><h1 class="section">Program Transformations</h1>

<div class="paragraph"> </div>

 A <i>program transformation</i> is a function that takes a program as
    input and produces a modified program as output.  Compiler
    optimizations such as constant folding are a canonical example,
    but there are many others. 
<div class="paragraph"> </div>

 A program transformation is said to be <i>sound</i> if it preserves the
    behavior of the original program. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a id="atrans_sound" class="idref" href="#atrans_sound"><span class="id" title="definition">atrans_sound</span></a> (<a id="atrans:91" class="idref" href="#atrans:91"><span class="id" title="binder">atrans</span></a> : <a class="idref" href="PLF.Imp.html#aexp"><span class="id" title="inductive">aexp</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="PLF.Imp.html#aexp"><span class="id" title="inductive">aexp</span></a>) : <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> (<a id="a:92" class="idref" href="#a:92"><span class="id" title="binder">a</span></a> : <a class="idref" href="PLF.Imp.html#aexp"><span class="id" title="inductive">aexp</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#aequiv"><span class="id" title="definition">aequiv</span></a> <a class="idref" href="PLF.Equiv.html#a:92"><span class="id" title="variable">a</span></a> (<a class="idref" href="PLF.Equiv.html#atrans:91"><span class="id" title="variable">atrans</span></a> <a class="idref" href="PLF.Equiv.html#a:92"><span class="id" title="variable">a</span></a>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="btrans_sound" class="idref" href="#btrans_sound"><span class="id" title="definition">btrans_sound</span></a> (<a id="btrans:93" class="idref" href="#btrans:93"><span class="id" title="binder">btrans</span></a> : <a class="idref" href="PLF.Imp.html#bexp"><span class="id" title="inductive">bexp</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="PLF.Imp.html#bexp"><span class="id" title="inductive">bexp</span></a>) : <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> (<a id="b:94" class="idref" href="#b:94"><span class="id" title="binder">b</span></a> : <a class="idref" href="PLF.Imp.html#bexp"><span class="id" title="inductive">bexp</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#bequiv"><span class="id" title="definition">bequiv</span></a> <a class="idref" href="PLF.Equiv.html#b:94"><span class="id" title="variable">b</span></a> (<a class="idref" href="PLF.Equiv.html#btrans:93"><span class="id" title="variable">btrans</span></a> <a class="idref" href="PLF.Equiv.html#b:94"><span class="id" title="variable">b</span></a>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="ctrans_sound" class="idref" href="#ctrans_sound"><span class="id" title="definition">ctrans_sound</span></a> (<a id="ctrans:95" class="idref" href="#ctrans:95"><span class="id" title="binder">ctrans</span></a> : <a class="idref" href="PLF.Imp.html#com"><span class="id" title="inductive">com</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="PLF.Imp.html#com"><span class="id" title="inductive">com</span></a>) : <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> (<a id="c:96" class="idref" href="#c:96"><span class="id" title="binder">c</span></a> : <a class="idref" href="PLF.Imp.html#com"><span class="id" title="inductive">com</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#cequiv"><span class="id" title="definition">cequiv</span></a> <a class="idref" href="PLF.Equiv.html#c:96"><span class="id" title="variable">c</span></a> (<a class="idref" href="PLF.Equiv.html#ctrans:95"><span class="id" title="variable">ctrans</span></a> <a class="idref" href="PLF.Equiv.html#c:96"><span class="id" title="variable">c</span></a>).<br/>

<br/>
</div>

<div class="doc">
<a id="lab25"></a><h2 class="section">The Constant-Folding Transformation</h2>

<div class="paragraph"> </div>

 An expression is <i>constant</i> if it contains no variable references.

<div class="paragraph"> </div>

    Constant folding is an optimization that finds constant
    expressions and replaces them by their values. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <a id="fold_constants_aexp" class="idref" href="#fold_constants_aexp"><span class="id" title="definition">fold_constants_aexp</span></a> (<a id="a:97" class="idref" href="#a:97"><span class="id" title="binder">a</span></a> : <a class="idref" href="PLF.Imp.html#aexp"><span class="id" title="inductive">aexp</span></a>) : <a class="idref" href="PLF.Imp.html#aexp"><span class="id" title="inductive">aexp</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="PLF.Equiv.html#a:97"><span class="id" title="variable">a</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="PLF.Imp.html#ANum"><span class="id" title="constructor">ANum</span></a> <span class="id" title="var">n</span>       ⇒ <a class="idref" href="PLF.Imp.html#ANum"><span class="id" title="constructor">ANum</span></a> <span class="id" title="var">n</span><br/>
&nbsp;&nbsp;| <a class="idref" href="PLF.Imp.html#AId"><span class="id" title="constructor">AId</span></a> <span class="id" title="var">x</span>        ⇒ <a class="idref" href="PLF.Imp.html#AId"><span class="id" title="constructor">AId</span></a> <span class="id" title="var">x</span><br/>
&nbsp;&nbsp;| <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <span class="id" title="var">a1</span> <a class="idref" href="PLF.Imp.html#ad27fd091d9c8494ce7e5135135d19a8"><span class="id" title="notation">+</span></a> <span class="id" title="var">a2</span> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a>  ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="PLF.Equiv.html#fold_constants_aexp:98"><span class="id" title="definition">fold_constants_aexp</span></a> <span class="id" title="var">a1</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#fold_constants_aexp:98"><span class="id" title="definition">fold_constants_aexp</span></a> <span class="id" title="var">a2</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="PLF.Imp.html#ANum"><span class="id" title="constructor">ANum</span></a> <span class="id" title="var">n1</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="PLF.Imp.html#ANum"><span class="id" title="constructor">ANum</span></a> <span class="id" title="var">n2</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> ⇒ <a class="idref" href="PLF.Imp.html#ANum"><span class="id" title="constructor">ANum</span></a> (<span class="id" title="var">n1</span> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Nat.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="var">n2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a1'</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">a2'</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> ⇒ <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <span class="id" title="var">a1'</span> <a class="idref" href="PLF.Imp.html#ad27fd091d9c8494ce7e5135135d19a8"><span class="id" title="notation">+</span></a> <span class="id" title="var">a2'</span> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;| <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <span class="id" title="var">a1</span> <a class="idref" href="PLF.Imp.html#:com::x_'-'_x"><span class="id" title="notation">-</span></a> <span class="id" title="var">a2</span> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="PLF.Equiv.html#fold_constants_aexp:98"><span class="id" title="definition">fold_constants_aexp</span></a> <span class="id" title="var">a1</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#fold_constants_aexp:98"><span class="id" title="definition">fold_constants_aexp</span></a> <span class="id" title="var">a2</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="PLF.Imp.html#ANum"><span class="id" title="constructor">ANum</span></a> <span class="id" title="var">n1</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="PLF.Imp.html#ANum"><span class="id" title="constructor">ANum</span></a> <span class="id" title="var">n2</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> ⇒ <a class="idref" href="PLF.Imp.html#ANum"><span class="id" title="constructor">ANum</span></a> (<span class="id" title="var">n1</span> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Nat.html#::nat_scope:x_'-'_x"><span class="id" title="notation">-</span></a> <span class="id" title="var">n2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a1'</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">a2'</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> ⇒ <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <span class="id" title="var">a1'</span> <a class="idref" href="PLF.Imp.html#:com::x_'-'_x"><span class="id" title="notation">-</span></a> <span class="id" title="var">a2'</span> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;| <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <span class="id" title="var">a1</span> <a class="idref" href="PLF.Imp.html#a73c7b35e67094dc8ae672f3a93da066"><span class="id" title="notation">×</span></a> <span class="id" title="var">a2</span> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a>  ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="PLF.Equiv.html#fold_constants_aexp:98"><span class="id" title="definition">fold_constants_aexp</span></a> <span class="id" title="var">a1</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#fold_constants_aexp:98"><span class="id" title="definition">fold_constants_aexp</span></a> <span class="id" title="var">a2</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="PLF.Imp.html#ANum"><span class="id" title="constructor">ANum</span></a> <span class="id" title="var">n1</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="PLF.Imp.html#ANum"><span class="id" title="constructor">ANum</span></a> <span class="id" title="var">n2</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> ⇒ <a class="idref" href="PLF.Imp.html#ANum"><span class="id" title="constructor">ANum</span></a> (<span class="id" title="var">n1</span> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Nat.html#ea2ff3d561159081cea6fb2e8113cc54"><span class="id" title="notation">×</span></a> <span class="id" title="var">n2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a1'</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">a2'</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> ⇒ <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <span class="id" title="var">a1'</span> <a class="idref" href="PLF.Imp.html#a73c7b35e67094dc8ae672f3a93da066"><span class="id" title="notation">×</span></a> <span class="id" title="var">a2'</span> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Example</span> <a id="fold_aexp_ex1" class="idref" href="#fold_aexp_ex1"><span class="id" title="definition">fold_aexp_ex1</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#fold_constants_aexp"><span class="id" title="definition">fold_constants_aexp</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Imp.html#5a96623d056c293ebbcdf03005796e09"><span class="id" title="notation">(</span></a>1 <a class="idref" href="PLF.Imp.html#ad27fd091d9c8494ce7e5135135d19a8"><span class="id" title="notation">+</span></a> 2<a class="idref" href="PLF.Imp.html#5a96623d056c293ebbcdf03005796e09"><span class="id" title="notation">)</span></a> <a class="idref" href="PLF.Imp.html#a73c7b35e67094dc8ae672f3a93da066"><span class="id" title="notation">×</span></a> <a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> 3 <a class="idref" href="PLF.Imp.html#a73c7b35e67094dc8ae672f3a93da066"><span class="id" title="notation">×</span></a> <a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
Note that this version of constant folding doesn't do other
    "obvious" things like eliminating trivial additions (e.g.,
    rewriting <span class="inlinecode">0</span> <span class="inlinecode">+</span> <span class="inlinecode"><span class="id" title="var">X</span></span> to just <span class="inlinecode"><span class="id" title="var">X</span></span>).: we are focusing attention on a
    single optimization for the sake of simplicity.

<div class="paragraph"> </div>

    It is not hard to incorporate other ways of simplifying
    expressions -- the definitions and proofs just get longer.  We'll
    consider optimizations in the exercises. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Example</span> <a id="fold_aexp_ex2" class="idref" href="#fold_aexp_ex2"><span class="id" title="definition">fold_aexp_ex2</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#fold_constants_aexp"><span class="id" title="definition">fold_constants_aexp</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="PLF.Imp.html#:com::x_'-'_x"><span class="id" title="notation">-</span></a> <a class="idref" href="PLF.Imp.html#5a96623d056c293ebbcdf03005796e09"><span class="id" title="notation">((</span></a>0 <a class="idref" href="PLF.Imp.html#a73c7b35e67094dc8ae672f3a93da066"><span class="id" title="notation">×</span></a> 6<a class="idref" href="PLF.Imp.html#5a96623d056c293ebbcdf03005796e09"><span class="id" title="notation">)</span></a> <a class="idref" href="PLF.Imp.html#ad27fd091d9c8494ce7e5135135d19a8"><span class="id" title="notation">+</span></a> <a class="idref" href="PLF.Imp.html#Y"><span class="id" title="definition">Y</span></a><a class="idref" href="PLF.Imp.html#5a96623d056c293ebbcdf03005796e09"><span class="id" title="notation">)</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="PLF.Imp.html#:com::x_'-'_x"><span class="id" title="notation">-</span></a> <a class="idref" href="PLF.Imp.html#5a96623d056c293ebbcdf03005796e09"><span class="id" title="notation">(</span></a>0 <a class="idref" href="PLF.Imp.html#ad27fd091d9c8494ce7e5135135d19a8"><span class="id" title="notation">+</span></a> <a class="idref" href="PLF.Imp.html#Y"><span class="id" title="definition">Y</span></a><a class="idref" href="PLF.Imp.html#5a96623d056c293ebbcdf03005796e09"><span class="id" title="notation">)</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
Not only can we lift <span class="inlinecode"><span class="id" title="var">fold_constants_aexp</span></span> to <span class="inlinecode"><span class="id" title="var">bexp</span></span>s (in the
    <span class="inlinecode"><span class="id" title="var">BEq</span></span>, <span class="inlinecode"><span class="id" title="var">BNeq</span></span>, and <span class="inlinecode"><span class="id" title="var">BLe</span></span> cases); we can also look for constant
    <i>boolean</i> expressions and evaluate them in-place as well. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <a id="fold_constants_bexp" class="idref" href="#fold_constants_bexp"><span class="id" title="definition">fold_constants_bexp</span></a> (<a id="b:100" class="idref" href="#b:100"><span class="id" title="binder">b</span></a> : <a class="idref" href="PLF.Imp.html#bexp"><span class="id" title="inductive">bexp</span></a>) : <a class="idref" href="PLF.Imp.html#bexp"><span class="id" title="inductive">bexp</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="PLF.Equiv.html#b:100"><span class="id" title="variable">b</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a><a class="idref" href="PLF.Imp.html#:com::'true'"><span class="id" title="notation">true</span></a><a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a>        ⇒ <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a><a class="idref" href="PLF.Imp.html#:com::'true'"><span class="id" title="notation">true</span></a><a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a><a class="idref" href="PLF.Imp.html#:com::'false'"><span class="id" title="notation">false</span></a><a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a>       ⇒ <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a><a class="idref" href="PLF.Imp.html#:com::'false'"><span class="id" title="notation">false</span></a><a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <span class="id" title="var">a1</span> <a class="idref" href="PLF.Imp.html#9e5b22caf5d7cf490e97976162618c2a"><span class="id" title="notation">=</span></a> <span class="id" title="var">a2</span> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a>  ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="PLF.Equiv.html#fold_constants_aexp"><span class="id" title="definition">fold_constants_aexp</span></a> <span class="id" title="var">a1</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#fold_constants_aexp"><span class="id" title="definition">fold_constants_aexp</span></a> <span class="id" title="var">a2</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="PLF.Imp.html#ANum"><span class="id" title="constructor">ANum</span></a> <span class="id" title="var">n1</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="PLF.Imp.html#ANum"><span class="id" title="constructor">ANum</span></a> <span class="id" title="var">n2</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="var">n1</span> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Nat.html#ad2ec4e405f68c46c0a176e3e94ae2e3"><span class="id" title="notation">=?</span></a> <span class="id" title="var">n2</span> <span class="id" title="keyword">then</span> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a><a class="idref" href="PLF.Imp.html#:com::'true'"><span class="id" title="notation">true</span></a><a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a> <span class="id" title="keyword">else</span> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a><a class="idref" href="PLF.Imp.html#:com::'false'"><span class="id" title="notation">false</span></a><a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a1'</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">a2'</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <span class="id" title="var">a1'</span> <a class="idref" href="PLF.Imp.html#9e5b22caf5d7cf490e97976162618c2a"><span class="id" title="notation">=</span></a> <span class="id" title="var">a2'</span> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;| <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <span class="id" title="var">a1</span> <a class="idref" href="PLF.Imp.html#:com::x_'&lt;&gt;'_x"><span class="id" title="notation">≠</span></a> <span class="id" title="var">a2</span> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a>  ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="PLF.Equiv.html#fold_constants_aexp"><span class="id" title="definition">fold_constants_aexp</span></a> <span class="id" title="var">a1</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#fold_constants_aexp"><span class="id" title="definition">fold_constants_aexp</span></a> <span class="id" title="var">a2</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="PLF.Imp.html#ANum"><span class="id" title="constructor">ANum</span></a> <span class="id" title="var">n1</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="PLF.Imp.html#ANum"><span class="id" title="constructor">ANum</span></a> <span class="id" title="var">n2</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#negb"><span class="id" title="definition">negb</span></a> (<span class="id" title="var">n1</span> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Nat.html#ad2ec4e405f68c46c0a176e3e94ae2e3"><span class="id" title="notation">=?</span></a> <span class="id" title="var">n2</span>) <span class="id" title="keyword">then</span> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a><a class="idref" href="PLF.Imp.html#:com::'true'"><span class="id" title="notation">true</span></a><a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a> <span class="id" title="keyword">else</span> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a><a class="idref" href="PLF.Imp.html#:com::'false'"><span class="id" title="notation">false</span></a><a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a1'</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">a2'</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <span class="id" title="var">a1'</span> <a class="idref" href="PLF.Imp.html#:com::x_'&lt;&gt;'_x"><span class="id" title="notation">≠</span></a> <span class="id" title="var">a2'</span> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;| <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <span class="id" title="var">a1</span> <a class="idref" href="PLF.Imp.html#d43f15edd52d29ae8e0f90730a25ed5c"><span class="id" title="notation">≤</span></a> <span class="id" title="var">a2</span> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a>  ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="PLF.Equiv.html#fold_constants_aexp"><span class="id" title="definition">fold_constants_aexp</span></a> <span class="id" title="var">a1</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#fold_constants_aexp"><span class="id" title="definition">fold_constants_aexp</span></a> <span class="id" title="var">a2</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="PLF.Imp.html#ANum"><span class="id" title="constructor">ANum</span></a> <span class="id" title="var">n1</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="PLF.Imp.html#ANum"><span class="id" title="constructor">ANum</span></a> <span class="id" title="var">n2</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="var">n1</span> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Nat.html#0f31f5c1c6b6a21a3a187247222bc9e4"><span class="id" title="notation">&lt;=?</span></a> <span class="id" title="var">n2</span> <span class="id" title="keyword">then</span> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a><a class="idref" href="PLF.Imp.html#:com::'true'"><span class="id" title="notation">true</span></a><a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a> <span class="id" title="keyword">else</span> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a><a class="idref" href="PLF.Imp.html#:com::'false'"><span class="id" title="notation">false</span></a><a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a1'</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">a2'</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <span class="id" title="var">a1'</span> <a class="idref" href="PLF.Imp.html#d43f15edd52d29ae8e0f90730a25ed5c"><span class="id" title="notation">≤</span></a> <span class="id" title="var">a2'</span> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;| <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <span class="id" title="var">a1</span> <a class="idref" href="PLF.Imp.html#:com::x_'&gt;'_x"><span class="id" title="notation">&gt;</span></a> <span class="id" title="var">a2</span> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a>  ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="PLF.Equiv.html#fold_constants_aexp"><span class="id" title="definition">fold_constants_aexp</span></a> <span class="id" title="var">a1</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#fold_constants_aexp"><span class="id" title="definition">fold_constants_aexp</span></a> <span class="id" title="var">a2</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="PLF.Imp.html#ANum"><span class="id" title="constructor">ANum</span></a> <span class="id" title="var">n1</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="PLF.Imp.html#ANum"><span class="id" title="constructor">ANum</span></a> <span class="id" title="var">n2</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="var">n1</span> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Nat.html#0f31f5c1c6b6a21a3a187247222bc9e4"><span class="id" title="notation">&lt;=?</span></a> <span class="id" title="var">n2</span> <span class="id" title="keyword">then</span> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a><a class="idref" href="PLF.Imp.html#:com::'false'"><span class="id" title="notation">false</span></a><a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a> <span class="id" title="keyword">else</span> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a><a class="idref" href="PLF.Imp.html#:com::'true'"><span class="id" title="notation">true</span></a><a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a1'</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">a2'</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <span class="id" title="var">a1'</span> <a class="idref" href="PLF.Imp.html#:com::x_'&gt;'_x"><span class="id" title="notation">&gt;</span></a> <span class="id" title="var">a2'</span> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;| <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Imp.html#dfe50505b2b595242030c436d0d7d15f"><span class="id" title="notation">¬</span></a> <span class="id" title="var">b1</span> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a>  ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> (<a class="idref" href="PLF.Equiv.html#fold_constants_bexp:101"><span class="id" title="definition">fold_constants_bexp</span></a> <span class="id" title="var">b1</span>) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a><a class="idref" href="PLF.Imp.html#:com::'true'"><span class="id" title="notation">true</span></a><a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a> ⇒ <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a><a class="idref" href="PLF.Imp.html#:com::'false'"><span class="id" title="notation">false</span></a><a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a><a class="idref" href="PLF.Imp.html#:com::'false'"><span class="id" title="notation">false</span></a><a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a> ⇒ <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a><a class="idref" href="PLF.Imp.html#:com::'true'"><span class="id" title="notation">true</span></a><a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">b1'</span> ⇒ <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Imp.html#dfe50505b2b595242030c436d0d7d15f"><span class="id" title="notation">¬</span></a> <span class="id" title="var">b1'</span> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;| <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <span class="id" title="var">b1</span> <a class="idref" href="PLF.Imp.html#:com::x_'&amp;&amp;'_x"><span class="id" title="notation">&amp;&amp;</span></a> <span class="id" title="var">b2</span> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a>  ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="PLF.Equiv.html#fold_constants_bexp:101"><span class="id" title="definition">fold_constants_bexp</span></a> <span class="id" title="var">b1</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#fold_constants_bexp:101"><span class="id" title="definition">fold_constants_bexp</span></a> <span class="id" title="var">b2</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a><a class="idref" href="PLF.Imp.html#:com::'true'"><span class="id" title="notation">true</span></a><a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a><a class="idref" href="PLF.Imp.html#:com::'true'"><span class="id" title="notation">true</span></a><a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> ⇒ <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a><a class="idref" href="PLF.Imp.html#:com::'true'"><span class="id" title="notation">true</span></a><a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a><a class="idref" href="PLF.Imp.html#:com::'true'"><span class="id" title="notation">true</span></a><a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a><a class="idref" href="PLF.Imp.html#:com::'false'"><span class="id" title="notation">false</span></a><a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> ⇒ <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a><a class="idref" href="PLF.Imp.html#:com::'false'"><span class="id" title="notation">false</span></a><a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a><a class="idref" href="PLF.Imp.html#:com::'false'"><span class="id" title="notation">false</span></a><a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a><a class="idref" href="PLF.Imp.html#:com::'true'"><span class="id" title="notation">true</span></a><a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> ⇒ <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a><a class="idref" href="PLF.Imp.html#:com::'false'"><span class="id" title="notation">false</span></a><a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a><a class="idref" href="PLF.Imp.html#:com::'false'"><span class="id" title="notation">false</span></a><a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a><a class="idref" href="PLF.Imp.html#:com::'false'"><span class="id" title="notation">false</span></a><a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> ⇒ <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a><a class="idref" href="PLF.Imp.html#:com::'false'"><span class="id" title="notation">false</span></a><a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">b1'</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">b2'</span><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> ⇒ <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <span class="id" title="var">b1'</span> <a class="idref" href="PLF.Imp.html#:com::x_'&amp;&amp;'_x"><span class="id" title="notation">&amp;&amp;</span></a> <span class="id" title="var">b2'</span> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Example</span> <a id="fold_bexp_ex1" class="idref" href="#fold_bexp_ex1"><span class="id" title="definition">fold_bexp_ex1</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#fold_constants_bexp"><span class="id" title="definition">fold_constants_bexp</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Imp.html#:com::'true'"><span class="id" title="notation">true</span></a> <a class="idref" href="PLF.Imp.html#:com::x_'&amp;&amp;'_x"><span class="id" title="notation">&amp;&amp;</span></a> <a class="idref" href="PLF.Imp.html#dfe50505b2b595242030c436d0d7d15f"><span class="id" title="notation">¬</span></a><a class="idref" href="PLF.Imp.html#5a96623d056c293ebbcdf03005796e09"><span class="id" title="notation">(</span></a><a class="idref" href="PLF.Imp.html#:com::'false'"><span class="id" title="notation">false</span></a> <a class="idref" href="PLF.Imp.html#:com::x_'&amp;&amp;'_x"><span class="id" title="notation">&amp;&amp;</span></a> <a class="idref" href="PLF.Imp.html#:com::'true'"><span class="id" title="notation">true</span></a><a class="idref" href="PLF.Imp.html#5a96623d056c293ebbcdf03005796e09"><span class="id" title="notation">)</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Imp.html#:com::'true'"><span class="id" title="notation">true</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Example</span> <a id="fold_bexp_ex2" class="idref" href="#fold_bexp_ex2"><span class="id" title="definition">fold_bexp_ex2</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#fold_constants_bexp"><span class="id" title="definition">fold_constants_bexp</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Imp.html#5a96623d056c293ebbcdf03005796e09"><span class="id" title="notation">(</span></a><a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="PLF.Imp.html#9e5b22caf5d7cf490e97976162618c2a"><span class="id" title="notation">=</span></a> <a class="idref" href="PLF.Imp.html#Y"><span class="id" title="definition">Y</span></a><a class="idref" href="PLF.Imp.html#5a96623d056c293ebbcdf03005796e09"><span class="id" title="notation">)</span></a> <a class="idref" href="PLF.Imp.html#:com::x_'&amp;&amp;'_x"><span class="id" title="notation">&amp;&amp;</span></a> <a class="idref" href="PLF.Imp.html#5a96623d056c293ebbcdf03005796e09"><span class="id" title="notation">(</span></a>0 <a class="idref" href="PLF.Imp.html#9e5b22caf5d7cf490e97976162618c2a"><span class="id" title="notation">=</span></a> <a class="idref" href="PLF.Imp.html#5a96623d056c293ebbcdf03005796e09"><span class="id" title="notation">(</span></a>2 <a class="idref" href="PLF.Imp.html#:com::x_'-'_x"><span class="id" title="notation">-</span></a> <a class="idref" href="PLF.Imp.html#5a96623d056c293ebbcdf03005796e09"><span class="id" title="notation">(</span></a>1 <a class="idref" href="PLF.Imp.html#ad27fd091d9c8494ce7e5135135d19a8"><span class="id" title="notation">+</span></a> 1<a class="idref" href="PLF.Imp.html#5a96623d056c293ebbcdf03005796e09"><span class="id" title="notation">)))</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Imp.html#5a96623d056c293ebbcdf03005796e09"><span class="id" title="notation">(</span></a><a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="PLF.Imp.html#9e5b22caf5d7cf490e97976162618c2a"><span class="id" title="notation">=</span></a> <a class="idref" href="PLF.Imp.html#Y"><span class="id" title="definition">Y</span></a><a class="idref" href="PLF.Imp.html#5a96623d056c293ebbcdf03005796e09"><span class="id" title="notation">)</span></a> <a class="idref" href="PLF.Imp.html#:com::x_'&amp;&amp;'_x"><span class="id" title="notation">&amp;&amp;</span></a> <a class="idref" href="PLF.Imp.html#:com::'true'"><span class="id" title="notation">true</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
To fold constants in a command, we apply the appropriate folding
    functions on all embedded expressions. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <a id="fold_constants_com" class="idref" href="#fold_constants_com"><span class="id" title="definition">fold_constants_com</span></a> (<a id="c:103" class="idref" href="#c:103"><span class="id" title="binder">c</span></a> : <a class="idref" href="PLF.Imp.html#com"><span class="id" title="inductive">com</span></a>) : <a class="idref" href="PLF.Imp.html#com"><span class="id" title="inductive">com</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="PLF.Equiv.html#c:103"><span class="id" title="variable">c</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'skip'"><span class="id" title="notation">skip</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'skip'"><span class="id" title="notation">skip</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <span class="id" title="var">x</span> <a class="idref" href="PLF.Imp.html#91e9aa710642047a93142bdf557f1a1b"><span class="id" title="notation">:=</span></a> <span class="id" title="var">a</span> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <span class="id" title="var">x</span> <a class="idref" href="PLF.Imp.html#91e9aa710642047a93142bdf557f1a1b"><span class="id" title="notation">:=</span></a> <a class="idref" href="PLF.Imp.html#5a96623d056c293ebbcdf03005796e09"><span class="id" title="notation">(</span></a><a class="idref" href="PLF.Equiv.html#fold_constants_aexp"><span class="id" title="definition">fold_constants_aexp</span></a> <span class="id" title="var">a</span><a class="idref" href="PLF.Imp.html#5a96623d056c293ebbcdf03005796e09"><span class="id" title="notation">)</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <span class="id" title="var">c1</span> <a class="idref" href="PLF.Imp.html#313afe74ec81f2da17d8e7bca3b042e7"><span class="id" title="notation">;</span></a> <span class="id" title="var">c2</span> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a>  ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Equiv.html#fold_constants_com:104"><span class="id" title="definition">fold_constants_com</span></a> <span class="id" title="var">c1</span> <a class="idref" href="PLF.Imp.html#313afe74ec81f2da17d8e7bca3b042e7"><span class="id" title="notation">;</span></a> <a class="idref" href="PLF.Equiv.html#fold_constants_com:104"><span class="id" title="definition">fold_constants_com</span></a> <span class="id" title="var">c2</span> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">if</span></a> <span class="id" title="var">b</span> <a class="idref" href="PLF.Imp.html#:com:com_scope:'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">then</span></a> <span class="id" title="var">c1</span> <a class="idref" href="PLF.Imp.html#:com:com_scope:'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">else</span></a> <span class="id" title="var">c2</span> <a class="idref" href="PLF.Imp.html#:com:com_scope:'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">end</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="PLF.Equiv.html#fold_constants_bexp"><span class="id" title="definition">fold_constants_bexp</span></a> <span class="id" title="var">b</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a><a class="idref" href="PLF.Imp.html#:com::'true'"><span class="id" title="notation">true</span></a><a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a>  ⇒ <a class="idref" href="PLF.Equiv.html#fold_constants_com:104"><span class="id" title="definition">fold_constants_com</span></a> <span class="id" title="var">c1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a><a class="idref" href="PLF.Imp.html#:com::'false'"><span class="id" title="notation">false</span></a><a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a> ⇒ <a class="idref" href="PLF.Equiv.html#fold_constants_com:104"><span class="id" title="definition">fold_constants_com</span></a> <span class="id" title="var">c2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">b'</span> ⇒ <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">if</span></a> <span class="id" title="var">b'</span> <a class="idref" href="PLF.Imp.html#:com:com_scope:'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">then</span></a> <a class="idref" href="PLF.Equiv.html#fold_constants_com:104"><span class="id" title="definition">fold_constants_com</span></a> <span class="id" title="var">c1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#:com:com_scope:'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">else</span></a> <a class="idref" href="PLF.Equiv.html#fold_constants_com:104"><span class="id" title="definition">fold_constants_com</span></a> <span class="id" title="var">c2</span> <a class="idref" href="PLF.Imp.html#:com:com_scope:'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">end</span></a><a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;| <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">while</span></a> <span class="id" title="var">b</span> <a class="idref" href="PLF.Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">do</span></a> <span class="id" title="var">c1</span> <a class="idref" href="PLF.Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">end</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="PLF.Equiv.html#fold_constants_bexp"><span class="id" title="definition">fold_constants_bexp</span></a> <span class="id" title="var">b</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a><a class="idref" href="PLF.Imp.html#:com::'true'"><span class="id" title="notation">true</span></a><a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a> ⇒ <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">while</span></a> <a class="idref" href="PLF.Imp.html#:com::'true'"><span class="id" title="notation">true</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">do</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'skip'"><span class="id" title="notation">skip</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">end</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a><a class="idref" href="PLF.Imp.html#:com::'false'"><span class="id" title="notation">false</span></a><a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a> ⇒ <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'skip'"><span class="id" title="notation">skip</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">b'</span> ⇒ <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">while</span></a> <span class="id" title="var">b'</span> <a class="idref" href="PLF.Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">do</span></a> <a class="idref" href="PLF.Imp.html#5a96623d056c293ebbcdf03005796e09"><span class="id" title="notation">(</span></a><a class="idref" href="PLF.Equiv.html#fold_constants_com:104"><span class="id" title="definition">fold_constants_com</span></a> <span class="id" title="var">c1</span><a class="idref" href="PLF.Imp.html#5a96623d056c293ebbcdf03005796e09"><span class="id" title="notation">)</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">end</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Example</span> <a id="fold_com_ex1" class="idref" href="#fold_com_ex1"><span class="id" title="definition">fold_com_ex1</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#fold_constants_com"><span class="id" title="definition">fold_constants_com</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="PLF.Imp.html#91e9aa710642047a93142bdf557f1a1b"><span class="id" title="notation">:=</span></a> 4 <a class="idref" href="PLF.Imp.html#ad27fd091d9c8494ce7e5135135d19a8"><span class="id" title="notation">+</span></a> 5<a class="idref" href="PLF.Imp.html#313afe74ec81f2da17d8e7bca3b042e7"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#Y"><span class="id" title="definition">Y</span></a> <a class="idref" href="PLF.Imp.html#91e9aa710642047a93142bdf557f1a1b"><span class="id" title="notation">:=</span></a> <a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="PLF.Imp.html#:com::x_'-'_x"><span class="id" title="notation">-</span></a> 3<a class="idref" href="PLF.Imp.html#313afe74ec81f2da17d8e7bca3b042e7"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#:com:com_scope:'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">if</span></a> <a class="idref" href="PLF.Imp.html#5a96623d056c293ebbcdf03005796e09"><span class="id" title="notation">(</span></a><a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="PLF.Imp.html#:com::x_'-'_x"><span class="id" title="notation">-</span></a> <a class="idref" href="PLF.Imp.html#Y"><span class="id" title="definition">Y</span></a><a class="idref" href="PLF.Imp.html#5a96623d056c293ebbcdf03005796e09"><span class="id" title="notation">)</span></a> <a class="idref" href="PLF.Imp.html#9e5b22caf5d7cf490e97976162618c2a"><span class="id" title="notation">=</span></a> <a class="idref" href="PLF.Imp.html#5a96623d056c293ebbcdf03005796e09"><span class="id" title="notation">(</span></a>2 <a class="idref" href="PLF.Imp.html#ad27fd091d9c8494ce7e5135135d19a8"><span class="id" title="notation">+</span></a> 4<a class="idref" href="PLF.Imp.html#5a96623d056c293ebbcdf03005796e09"><span class="id" title="notation">)</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">then</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'skip'"><span class="id" title="notation">skip</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#:com:com_scope:'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">else</span></a> <a class="idref" href="PLF.Imp.html#Y"><span class="id" title="definition">Y</span></a> <a class="idref" href="PLF.Imp.html#91e9aa710642047a93142bdf557f1a1b"><span class="id" title="notation">:=</span></a> 0 <a class="idref" href="PLF.Imp.html#:com:com_scope:'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">end</span></a><a class="idref" href="PLF.Imp.html#313afe74ec81f2da17d8e7bca3b042e7"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#:com:com_scope:'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">if</span></a> 0 <a class="idref" href="PLF.Imp.html#d43f15edd52d29ae8e0f90730a25ed5c"><span class="id" title="notation">≤</span></a> <a class="idref" href="PLF.Imp.html#5a96623d056c293ebbcdf03005796e09"><span class="id" title="notation">(</span></a>4 <a class="idref" href="PLF.Imp.html#:com::x_'-'_x"><span class="id" title="notation">-</span></a> <a class="idref" href="PLF.Imp.html#5a96623d056c293ebbcdf03005796e09"><span class="id" title="notation">(</span></a>2 <a class="idref" href="PLF.Imp.html#ad27fd091d9c8494ce7e5135135d19a8"><span class="id" title="notation">+</span></a> 1<a class="idref" href="PLF.Imp.html#5a96623d056c293ebbcdf03005796e09"><span class="id" title="notation">))</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">then</span></a> <a class="idref" href="PLF.Imp.html#Y"><span class="id" title="definition">Y</span></a> <a class="idref" href="PLF.Imp.html#91e9aa710642047a93142bdf557f1a1b"><span class="id" title="notation">:=</span></a> 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#:com:com_scope:'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">else</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'skip'"><span class="id" title="notation">skip</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">end</span></a><a class="idref" href="PLF.Imp.html#313afe74ec81f2da17d8e7bca3b042e7"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">while</span></a> <a class="idref" href="PLF.Imp.html#Y"><span class="id" title="definition">Y</span></a> <a class="idref" href="PLF.Imp.html#9e5b22caf5d7cf490e97976162618c2a"><span class="id" title="notation">=</span></a> 0 <a class="idref" href="PLF.Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">do</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="PLF.Imp.html#91e9aa710642047a93142bdf557f1a1b"><span class="id" title="notation">:=</span></a> <a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="PLF.Imp.html#ad27fd091d9c8494ce7e5135135d19a8"><span class="id" title="notation">+</span></a> 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">end</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="PLF.Imp.html#91e9aa710642047a93142bdf557f1a1b"><span class="id" title="notation">:=</span></a> 9<a class="idref" href="PLF.Imp.html#313afe74ec81f2da17d8e7bca3b042e7"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#Y"><span class="id" title="definition">Y</span></a> <a class="idref" href="PLF.Imp.html#91e9aa710642047a93142bdf557f1a1b"><span class="id" title="notation">:=</span></a> <a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="PLF.Imp.html#:com::x_'-'_x"><span class="id" title="notation">-</span></a> 3<a class="idref" href="PLF.Imp.html#313afe74ec81f2da17d8e7bca3b042e7"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#:com:com_scope:'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">if</span></a> <a class="idref" href="PLF.Imp.html#5a96623d056c293ebbcdf03005796e09"><span class="id" title="notation">(</span></a><a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="PLF.Imp.html#:com::x_'-'_x"><span class="id" title="notation">-</span></a> <a class="idref" href="PLF.Imp.html#Y"><span class="id" title="definition">Y</span></a><a class="idref" href="PLF.Imp.html#5a96623d056c293ebbcdf03005796e09"><span class="id" title="notation">)</span></a> <a class="idref" href="PLF.Imp.html#9e5b22caf5d7cf490e97976162618c2a"><span class="id" title="notation">=</span></a> 6 <a class="idref" href="PLF.Imp.html#:com:com_scope:'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">then</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'skip'"><span class="id" title="notation">skip</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#:com:com_scope:'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">else</span></a> <a class="idref" href="PLF.Imp.html#Y"><span class="id" title="definition">Y</span></a> <a class="idref" href="PLF.Imp.html#91e9aa710642047a93142bdf557f1a1b"><span class="id" title="notation">:=</span></a> 0 <a class="idref" href="PLF.Imp.html#:com:com_scope:'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">end</span></a><a class="idref" href="PLF.Imp.html#313afe74ec81f2da17d8e7bca3b042e7"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#Y"><span class="id" title="definition">Y</span></a> <a class="idref" href="PLF.Imp.html#91e9aa710642047a93142bdf557f1a1b"><span class="id" title="notation">:=</span></a> 0<a class="idref" href="PLF.Imp.html#313afe74ec81f2da17d8e7bca3b042e7"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">while</span></a> <a class="idref" href="PLF.Imp.html#Y"><span class="id" title="definition">Y</span></a> <a class="idref" href="PLF.Imp.html#9e5b22caf5d7cf490e97976162618c2a"><span class="id" title="notation">=</span></a> 0 <a class="idref" href="PLF.Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">do</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="PLF.Imp.html#91e9aa710642047a93142bdf557f1a1b"><span class="id" title="notation">:=</span></a> <a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="PLF.Imp.html#ad27fd091d9c8494ce7e5135135d19a8"><span class="id" title="notation">+</span></a> 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">end</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab26"></a><h2 class="section">Soundness of Constant Folding</h2>

<div class="paragraph"> </div>

 Now we need to show that what we've done is correct. 
<div class="paragraph"> </div>

 Here's the proof for arithmetic expressions: 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a id="fold_constants_aexp_sound" class="idref" href="#fold_constants_aexp_sound"><span class="id" title="lemma">fold_constants_aexp_sound</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#atrans_sound"><span class="id" title="definition">atrans_sound</span></a> <a class="idref" href="PLF.Equiv.html#fold_constants_aexp"><span class="id" title="definition">fold_constants_aexp</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="PLF.Equiv.html#atrans_sound"><span class="id" title="definition">atrans_sound</span></a>. <span class="id" title="tactic">intros</span> <span class="id" title="var">a</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="PLF.Equiv.html#aequiv"><span class="id" title="definition">aequiv</span></a>. <span class="id" title="tactic">intros</span> <span class="id" title="var">st</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">a</span>; <span class="id" title="tactic">simpl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">reflexivity</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> (<span class="id" title="tactic">destruct</span> (<a class="idref" href="PLF.Equiv.html#fold_constants_aexp"><span class="id" title="definition">fold_constants_aexp</span></a> <span class="id" title="var">a1</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="PLF.Equiv.html#fold_constants_aexp"><span class="id" title="definition">fold_constants_aexp</span></a> <span class="id" title="var">a2</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHa1</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHa2</span>; <span class="id" title="tactic">reflexivity</span>). <span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab27"></a><h4 class="section">Exercise: 3 stars, standard, optional (fold_bexp_Eq_informal)</h4>


<div class="paragraph"> </div>

    Here is an informal proof of the <span class="inlinecode"><span class="id" title="var">BEq</span></span> case of the soundness
    argument for boolean expression constant folding.  Read it
    carefully and compare it to the formal proof that follows.  Then
    fill in the <span class="inlinecode"><span class="id" title="var">BLe</span></span> case of the formal proof (without looking at the
    <span class="inlinecode"><span class="id" title="var">BEq</span></span> case, if possible).

<div class="paragraph"> </div>

   <i>Theorem</i>: The constant folding function for booleans,
   <span class="inlinecode"><span class="id" title="var">fold_constants_bexp</span></span>, is sound.

<div class="paragraph"> </div>

   <i>Proof</i>: We must show that <span class="inlinecode"><span class="id" title="var">b</span></span> is equivalent to <span class="inlinecode"><span class="id" title="var">fold_constants_bexp</span></span> <span class="inlinecode"><span class="id" title="var">b</span></span>,
   for all boolean expressions <span class="inlinecode"><span class="id" title="var">b</span></span>.  Proceed by induction on <span class="inlinecode"><span class="id" title="var">b</span></span>.  We
   show just the case where <span class="inlinecode"><span class="id" title="var">b</span></span> has the form <span class="inlinecode"><span class="id" title="var">a1</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">a2</span></span>.

<div class="paragraph"> </div>

   In this case, we must show

<div class="paragraph"> </div>

       beval st &lt;{ a1 = a2 }&gt;
     = beval st (fold_constants_bexp &lt;{ a1 = a2 }&gt;).

<div class="paragraph"> </div>

   There are two cases to consider:

<div class="paragraph"> </div>

<ul class="doclist">
<li> First, suppose <span class="inlinecode"><span class="id" title="var">fold_constants_aexp</span></span> <span class="inlinecode"><span class="id" title="var">a1</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">ANum</span></span> <span class="inlinecode"><span class="id" title="var">n1</span></span> and
       <span class="inlinecode"><span class="id" title="var">fold_constants_aexp</span></span> <span class="inlinecode"><span class="id" title="var">a2</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">ANum</span></span> <span class="inlinecode"><span class="id" title="var">n2</span></span> for some <span class="inlinecode"><span class="id" title="var">n1</span></span> and <span class="inlinecode"><span class="id" title="var">n2</span></span>.

<div class="paragraph"> </div>

       In this case, we have

<div class="paragraph"> </div>

           fold_constants_bexp &lt;{ a1 = a2 }&gt;
         = if n1 =? n2 then &lt;{true}&gt; else &lt;{false}&gt;

<div class="paragraph"> </div>

       and

<div class="paragraph"> </div>

           beval st &lt;{a1 = a2}&gt;
         = (aeval st a1) =? (aeval st a2).

<div class="paragraph"> </div>

       By the soundness of constant folding for arithmetic
       expressions (Lemma <span class="inlinecode"><span class="id" title="var">fold_constants_aexp_sound</span></span>), we know

<div class="paragraph"> </div>

           aeval st a1
         = aeval st (fold_constants_aexp a1)
         = aeval st (ANum n1)
         = n1

<div class="paragraph"> </div>

       and

<div class="paragraph"> </div>

           aeval st a2
         = aeval st (fold_constants_aexp a2)
         = aeval st (ANum n2)
         = n2,

<div class="paragraph"> </div>

       so

<div class="paragraph"> </div>

           beval st &lt;{a1 = a2}&gt;
         = (aeval a1) =? (aeval a2)
         = n1 =? n2.

<div class="paragraph"> </div>

       Also, it is easy to see (by considering the cases <span class="inlinecode"><span class="id" title="var">n1</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">n2</span></span> and
       <span class="inlinecode"><span class="id" title="var">n1</span></span> <span class="inlinecode">≠</span> <span class="inlinecode"><span class="id" title="var">n2</span></span> separately) that

<div class="paragraph"> </div>

           beval st (if n1 =? n2 then &lt;{true}&gt; else &lt;{false}&gt;)
         = if n1 =? n2 then beval st &lt;{true}&gt; else beval st &lt;{false}&gt;
         = if n1 =? n2 then true else false
         = n1 =? n2.

<div class="paragraph"> </div>

       So

<div class="paragraph"> </div>

           beval st (&lt;{ a1 = a2 }&gt;)
         = n1 =? n2.
         = beval st (if n1 =? n2 then &lt;{true}&gt; else &lt;{false}&gt;),

<div class="paragraph"> </div>

       as required.

<div class="paragraph"> </div>


</li>
<li> Otherwise, one of <span class="inlinecode"><span class="id" title="var">fold_constants_aexp</span></span> <span class="inlinecode"><span class="id" title="var">a1</span></span> and
       <span class="inlinecode"><span class="id" title="var">fold_constants_aexp</span></span> <span class="inlinecode"><span class="id" title="var">a2</span></span> is not a constant.  In this case, we
       must show

<div class="paragraph"> </div>

           beval st &lt;{a1 = a2}&gt;
         = beval st (&lt;{ (fold_constants_aexp a1) =
                         (fold_constants_aexp a2) }&gt;),

<div class="paragraph"> </div>

       which, by the definition of <span class="inlinecode"><span class="id" title="var">beval</span></span>, is the same as showing

<div class="paragraph"> </div>

           (aeval st a1) =? (aeval st a2)
         = (aeval st (fold_constants_aexp a1)) =?
                   (aeval st (fold_constants_aexp a2)).

<div class="paragraph"> </div>

       But the soundness of constant folding for arithmetic
       expressions (<span class="inlinecode"><span class="id" title="var">fold_constants_aexp_sound</span></span>) gives us

<div class="paragraph"> </div>

         aeval st a1 = aeval st (fold_constants_aexp a1)
         aeval st a2 = aeval st (fold_constants_aexp a2),

<div class="paragraph"> </div>

       completing the case.  <font size=-2>&#9744;</font> 

</li>
</ul>
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a id="fold_constants_bexp_sound" class="idref" href="#fold_constants_bexp_sound"><span class="id" title="lemma">fold_constants_bexp_sound</span></a>:<br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#btrans_sound"><span class="id" title="definition">btrans_sound</span></a> <a class="idref" href="PLF.Equiv.html#fold_constants_bexp"><span class="id" title="definition">fold_constants_bexp</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="PLF.Equiv.html#btrans_sound"><span class="id" title="definition">btrans_sound</span></a>. <span class="id" title="tactic">intros</span> <span class="id" title="var">b</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="PLF.Equiv.html#bequiv"><span class="id" title="definition">bequiv</span></a>. <span class="id" title="tactic">intros</span> <span class="id" title="var">st</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">b</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">remember</span> (<a class="idref" href="PLF.Equiv.html#fold_constants_aexp"><span class="id" title="definition">fold_constants_aexp</span></a> <span class="id" title="var">a1</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">a1'</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">Heqa1'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">remember</span> (<a class="idref" href="PLF.Equiv.html#fold_constants_aexp"><span class="id" title="definition">fold_constants_aexp</span></a> <span class="id" title="var">a2</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">a2'</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">Heqa2'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<a class="idref" href="PLF.Imp.html#aeval"><span class="id" title="definition">aeval</span></a> <span class="id" title="var">st</span> <span class="id" title="var">a1</span>) <span class="id" title="keyword">with</span> (<a class="idref" href="PLF.Imp.html#aeval"><span class="id" title="definition">aeval</span></a> <span class="id" title="var">st</span> <span class="id" title="var">a1'</span>) <span class="id" title="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">subst</span> <span class="id" title="var">a1'</span>; <span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="PLF.Equiv.html#fold_constants_aexp_sound"><span class="id" title="lemma">fold_constants_aexp_sound</span></a>; <span class="id" title="tactic">reflexivity</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<a class="idref" href="PLF.Imp.html#aeval"><span class="id" title="definition">aeval</span></a> <span class="id" title="var">st</span> <span class="id" title="var">a2</span>) <span class="id" title="keyword">with</span> (<a class="idref" href="PLF.Imp.html#aeval"><span class="id" title="definition">aeval</span></a> <span class="id" title="var">st</span> <span class="id" title="var">a2'</span>) <span class="id" title="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">subst</span> <span class="id" title="var">a2'</span>; <span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="PLF.Equiv.html#fold_constants_aexp_sound"><span class="id" title="lemma">fold_constants_aexp_sound</span></a>; <span class="id" title="tactic">reflexivity</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">a1'</span>; <span class="id" title="tactic">destruct</span> <span class="id" title="var">a2'</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">destruct</span> (<span class="id" title="var">n</span> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Nat.html#ad2ec4e405f68c46c0a176e3e94ae2e3"><span class="id" title="notation">=?</span></a> <span class="id" title="var">n0</span>); <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">remember</span> (<a class="idref" href="PLF.Equiv.html#fold_constants_aexp"><span class="id" title="definition">fold_constants_aexp</span></a> <span class="id" title="var">a1</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">a1'</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">Heqa1'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">remember</span> (<a class="idref" href="PLF.Equiv.html#fold_constants_aexp"><span class="id" title="definition">fold_constants_aexp</span></a> <span class="id" title="var">a2</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">a2'</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">Heqa2'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<a class="idref" href="PLF.Imp.html#aeval"><span class="id" title="definition">aeval</span></a> <span class="id" title="var">st</span> <span class="id" title="var">a1</span>) <span class="id" title="keyword">with</span> (<a class="idref" href="PLF.Imp.html#aeval"><span class="id" title="definition">aeval</span></a> <span class="id" title="var">st</span> <span class="id" title="var">a1'</span>) <span class="id" title="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">subst</span> <span class="id" title="var">a1'</span>; <span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="PLF.Equiv.html#fold_constants_aexp_sound"><span class="id" title="lemma">fold_constants_aexp_sound</span></a>; <span class="id" title="tactic">reflexivity</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<a class="idref" href="PLF.Imp.html#aeval"><span class="id" title="definition">aeval</span></a> <span class="id" title="var">st</span> <span class="id" title="var">a2</span>) <span class="id" title="keyword">with</span> (<a class="idref" href="PLF.Imp.html#aeval"><span class="id" title="definition">aeval</span></a> <span class="id" title="var">st</span> <span class="id" title="var">a2'</span>) <span class="id" title="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">subst</span> <span class="id" title="var">a2'</span>; <span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="PLF.Equiv.html#fold_constants_aexp_sound"><span class="id" title="lemma">fold_constants_aexp_sound</span></a>; <span class="id" title="tactic">reflexivity</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">a1'</span>; <span class="id" title="tactic">destruct</span> <span class="id" title="var">a2'</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">destruct</span> (<span class="id" title="var">n</span> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Nat.html#ad2ec4e405f68c46c0a176e3e94ae2e3"><span class="id" title="notation">=?</span></a> <span class="id" title="var">n0</span>); <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp; <span class="id" title="var">admit</span>.<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp; <span class="id" title="var">admit</span>.<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="var">remember</span> (<a class="idref" href="PLF.Equiv.html#fold_constants_bexp"><span class="id" title="definition">fold_constants_bexp</span></a> <span class="id" title="var">b</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">b'</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">Heqb'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">b'</span>; <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">remember</span> (<a class="idref" href="PLF.Equiv.html#fold_constants_bexp"><span class="id" title="definition">fold_constants_bexp</span></a> <span class="id" title="var">b1</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">b1'</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">Heqb1'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">remember</span> (<a class="idref" href="PLF.Equiv.html#fold_constants_bexp"><span class="id" title="definition">fold_constants_bexp</span></a> <span class="id" title="var">b2</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">b2'</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">Heqb2'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHb1</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHb2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">b1'</span>; <span class="id" title="tactic">destruct</span> <span class="id" title="var">b2'</span>; <span class="id" title="tactic">reflexivity</span>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
<div class="paragraph"> </div>

<a id="lab28"></a><h4 class="section">Exercise: 3 stars, standard (fold_constants_com_sound)</h4>


<div class="paragraph"> </div>

    Complete the <span class="inlinecode"><span class="id" title="var">while</span></span> case of the following proof. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a id="fold_constants_com_sound" class="idref" href="#fold_constants_com_sound"><span class="id" title="lemma">fold_constants_com_sound</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#ctrans_sound"><span class="id" title="definition">ctrans_sound</span></a> <a class="idref" href="PLF.Equiv.html#fold_constants_com"><span class="id" title="definition">fold_constants_com</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="PLF.Equiv.html#ctrans_sound"><span class="id" title="definition">ctrans_sound</span></a>. <span class="id" title="tactic">intros</span> <span class="id" title="var">c</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">c</span>; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;-  <span class="id" title="tactic">apply</span> <a class="idref" href="PLF.Equiv.html#refl_cequiv"><span class="id" title="lemma">refl_cequiv</span></a>.<br/>
&nbsp;&nbsp;-  <span class="id" title="tactic">apply</span> <a class="idref" href="PLF.Equiv.html#CAsgn_congruence"><span class="id" title="lemma">CAsgn_congruence</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="PLF.Equiv.html#fold_constants_aexp_sound"><span class="id" title="lemma">fold_constants_aexp_sound</span></a>.<br/>
&nbsp;&nbsp;-  <span class="id" title="tactic">apply</span> <a class="idref" href="PLF.Equiv.html#CSeq_congruence"><span class="id" title="axiom">CSeq_congruence</span></a>; <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="PLF.Equiv.html#bequiv"><span class="id" title="definition">bequiv</span></a> <span class="id" title="var">b</span> (<a class="idref" href="PLF.Equiv.html#fold_constants_bexp"><span class="id" title="definition">fold_constants_bexp</span></a> <span class="id" title="var">b</span>)). {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="PLF.Equiv.html#fold_constants_bexp_sound"><span class="id" title="axiom">fold_constants_bexp_sound</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="PLF.Equiv.html#fold_constants_bexp"><span class="id" title="definition">fold_constants_bexp</span></a> <span class="id" title="var">b</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">Heqb</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> (<span class="id" title="tactic">apply</span> <a class="idref" href="PLF.Equiv.html#CIf_congruence"><span class="id" title="axiom">CIf_congruence</span></a>; <span class="id" title="tactic">assumption</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="PLF.Equiv.html#trans_cequiv"><span class="id" title="lemma">trans_cequiv</span></a> <span class="id" title="keyword">with</span> <span class="id" title="var">c1</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="PLF.Equiv.html#if_true"><span class="id" title="lemma">if_true</span></a>; <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="PLF.Equiv.html#trans_cequiv"><span class="id" title="lemma">trans_cequiv</span></a> <span class="id" title="keyword">with</span> <span class="id" title="var">c2</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="PLF.Equiv.html#if_false"><span class="id" title="axiom">if_false</span></a>; <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp; <span class="id" title="var">Admitted</span>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a id="lab29"></a><h2 class="section">Soundness of (0 + n) Elimination, Redux</h2>

<div class="paragraph"> </div>

<a id="lab30"></a><h4 class="section">Exercise: 4 stars, standard, optional (optimize_0plus_var)</h4>


<div class="paragraph"> </div>

    Recall the definition <span class="inlinecode"><span class="id" title="var">optimize_0plus</span></span> from the <span class="inlinecode"><span class="id" title="var">Imp</span></span> chapter
    of <i>Logical Foundations</i>:

<div class="paragraph"> </div>

    Fixpoint optimize_0plus (a:aexp) : aexp :=
      match a with
      | ANum n =&gt;
          ANum n
      | &lt;{ 0 + a2 }&gt; =&gt;
          optimize_0plus a2
      | &lt;{ a1 + a2 }&gt; =&gt;
          &lt;{ (optimize_0plus a1) + (optimize_0plus a2) }&gt;
      | &lt;{ a1 - a2 }&gt; =&gt;
          &lt;{ (optimize_0plus a1) - (optimize_0plus a2) }&gt;
      | &lt;{ a1 * a2 }&gt; =&gt;
          &lt;{ (optimize_0plus a1) * (optimize_0plus a2) }&gt;
      end.

<div class="paragraph"> </div>

   Note that this function is defined over the old version of <span class="inlinecode"><span class="id" title="var">aexp</span></span>s,
   without states.

<div class="paragraph"> </div>

   Write a new version of this function that deals with variables (by
   leaving them alone), plus analogous ones for <span class="inlinecode"><span class="id" title="var">bexp</span></span>s and commands:

<div class="paragraph"> </div>

     optimize_0plus_aexp
     optimize_0plus_bexp
     optimize_0plus_com

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <a id="optimize_0plus_aexp" class="idref" href="#optimize_0plus_aexp"><span class="id" title="definition">optimize_0plus_aexp</span></a> (<a id="a:106" class="idref" href="#a:106"><span class="id" title="binder">a</span></a> : <a class="idref" href="PLF.Imp.html#aexp"><span class="id" title="inductive">aexp</span></a>) : <a class="idref" href="PLF.Imp.html#aexp"><span class="id" title="inductive">aexp</span></a><br/>
&nbsp;&nbsp;. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <a id="optimize_0plus_bexp" class="idref" href="#optimize_0plus_bexp"><span class="id" title="definition">optimize_0plus_bexp</span></a> (<a id="b:108" class="idref" href="#b:108"><span class="id" title="binder">b</span></a> : <a class="idref" href="PLF.Imp.html#bexp"><span class="id" title="inductive">bexp</span></a>) : <a class="idref" href="PLF.Imp.html#bexp"><span class="id" title="inductive">bexp</span></a><br/>
&nbsp;&nbsp;. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <a id="optimize_0plus_com" class="idref" href="#optimize_0plus_com"><span class="id" title="definition">optimize_0plus_com</span></a> (<a id="c:110" class="idref" href="#c:110"><span class="id" title="binder">c</span></a> : <a class="idref" href="PLF.Imp.html#com"><span class="id" title="inductive">com</span></a>) : <a class="idref" href="PLF.Imp.html#com"><span class="id" title="inductive">com</span></a><br/>
&nbsp;&nbsp;. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Example</span> <a id="test_optimize_0plus" class="idref" href="#test_optimize_0plus"><span class="id" title="definition">test_optimize_0plus</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#optimize_0plus_com"><span class="id" title="axiom">optimize_0plus_com</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">while</span></a> <a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="PLF.Imp.html#:com::x_'&lt;&gt;'_x"><span class="id" title="notation">≠</span></a> 0 <a class="idref" href="PLF.Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">do</span></a> <a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="PLF.Imp.html#91e9aa710642047a93142bdf557f1a1b"><span class="id" title="notation">:=</span></a> 0 <a class="idref" href="PLF.Imp.html#ad27fd091d9c8494ce7e5135135d19a8"><span class="id" title="notation">+</span></a> <a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="PLF.Imp.html#:com::x_'-'_x"><span class="id" title="notation">-</span></a> 1 <a class="idref" href="PLF.Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">end</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a>    <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">while</span></a> <a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="PLF.Imp.html#:com::x_'&lt;&gt;'_x"><span class="id" title="notation">≠</span></a> 0 <a class="idref" href="PLF.Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">do</span></a> <a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="PLF.Imp.html#91e9aa710642047a93142bdf557f1a1b"><span class="id" title="notation">:=</span></a> <a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="PLF.Imp.html#:com::x_'-'_x"><span class="id" title="notation">-</span></a> 1 <a class="idref" href="PLF.Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">end</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>

<br/>
</div>

<div class="doc">
Prove that these three functions are sound, as we did for
    <span class="inlinecode"><span class="id" title="var">fold_constants_</span>×</span>.  Make sure you use the congruence lemmas in the
    proof of <span class="inlinecode"><span class="id" title="var">optimize_0plus_com</span></span> -- otherwise it will be <i>long</i>! 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a id="optimize_0plus_aexp_sound" class="idref" href="#optimize_0plus_aexp_sound"><span class="id" title="lemma">optimize_0plus_aexp_sound</span></a>:<br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#atrans_sound"><span class="id" title="definition">atrans_sound</span></a> <a class="idref" href="PLF.Equiv.html#optimize_0plus_aexp"><span class="id" title="axiom">optimize_0plus_aexp</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Theorem</span> <a id="optimize_0plus_bexp_sound" class="idref" href="#optimize_0plus_bexp_sound"><span class="id" title="lemma">optimize_0plus_bexp_sound</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#btrans_sound"><span class="id" title="definition">btrans_sound</span></a> <a class="idref" href="PLF.Equiv.html#optimize_0plus_bexp"><span class="id" title="axiom">optimize_0plus_bexp</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Theorem</span> <a id="optimize_0plus_com_sound" class="idref" href="#optimize_0plus_com_sound"><span class="id" title="lemma">optimize_0plus_com_sound</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#ctrans_sound"><span class="id" title="definition">ctrans_sound</span></a> <a class="idref" href="PLF.Equiv.html#optimize_0plus_com"><span class="id" title="axiom">optimize_0plus_com</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>

<br/>
</div>

<div class="doc">
Finally, let's define a compound optimizer on commands that first
    folds constants (using <span class="inlinecode"><span class="id" title="var">fold_constants_com</span></span>) and then eliminates
    <span class="inlinecode">0</span> <span class="inlinecode">+</span> <span class="inlinecode"><span class="id" title="var">n</span></span> terms (using <span class="inlinecode"><span class="id" title="var">optimize_0plus_com</span></span>). 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a id="optimizer" class="idref" href="#optimizer"><span class="id" title="definition">optimizer</span></a> (<a id="c:112" class="idref" href="#c:112"><span class="id" title="binder">c</span></a> : <a class="idref" href="PLF.Imp.html#com"><span class="id" title="inductive">com</span></a>) := <a class="idref" href="PLF.Equiv.html#optimize_0plus_com"><span class="id" title="axiom">optimize_0plus_com</span></a> (<a class="idref" href="PLF.Equiv.html#fold_constants_com"><span class="id" title="definition">fold_constants_com</span></a> <a class="idref" href="PLF.Equiv.html#c:112"><span class="id" title="variable">c</span></a>).<br/>

<br/>
</div>

<div class="doc">
Prove that this optimizer is sound. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a id="optimizer_sound" class="idref" href="#optimizer_sound"><span class="id" title="lemma">optimizer_sound</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#ctrans_sound"><span class="id" title="definition">ctrans_sound</span></a> <a class="idref" href="PLF.Equiv.html#optimizer"><span class="id" title="definition">optimizer</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a id="lab31"></a><h1 class="section">Proving Inequivalence</h1>

<div class="paragraph"> </div>

 Next, let's look at some programs that are <i>not</i> equivalent. 
<div class="paragraph"> </div>

 Suppose that <span class="inlinecode"><span class="id" title="var">c1</span></span> is a command of the form

<div class="paragraph"> </div>

       X := a1; Y := a2

<div class="paragraph"> </div>

    and <span class="inlinecode"><span class="id" title="var">c2</span></span> is the command

<div class="paragraph"> </div>

       X := a1; Y := a2'

<div class="paragraph"> </div>

    where <span class="inlinecode"><span class="id" title="var">a2'</span></span> is formed by substituting <span class="inlinecode"><span class="id" title="var">a1</span></span> for all occurrences
    of <span class="inlinecode"><span class="id" title="var">X</span></span> in <span class="inlinecode"><span class="id" title="var">a2</span></span>.

<div class="paragraph"> </div>

    For example, <span class="inlinecode"><span class="id" title="var">c1</span></span> and <span class="inlinecode"><span class="id" title="var">c2</span></span> might be:

<div class="paragraph"> </div>

       c1  =  (X := 42 + 53;
               Y := Y + X)
       c2  =  (X := 42 + 53;
               Y := Y + (42 + 53))

<div class="paragraph"> </div>

    Clearly, this <i>particular</i> <span class="inlinecode"><span class="id" title="var">c1</span></span> and <span class="inlinecode"><span class="id" title="var">c2</span></span> are equivalent.  Is this
    true in general? 
<div class="paragraph"> </div>

 We will see in a moment that it is not, but it is worthwhile
    to pause, now, and see if you can find a counter-example on your
    own. 
<div class="paragraph"> </div>

 More formally, here is the function that substitutes an arithmetic
    expression <span class="inlinecode"><span class="id" title="var">u</span></span> for each occurrence of a given variable <span class="inlinecode"><span class="id" title="var">x</span></span> in
    another expression <span class="inlinecode"><span class="id" title="var">a</span></span>: 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <a id="subst_aexp" class="idref" href="#subst_aexp"><span class="id" title="definition">subst_aexp</span></a> (<a id="x:113" class="idref" href="#x:113"><span class="id" title="binder">x</span></a> : <span class="id" title="inductive">string</span>) (<a id="u:114" class="idref" href="#u:114"><span class="id" title="binder">u</span></a> : <a class="idref" href="PLF.Imp.html#aexp"><span class="id" title="inductive">aexp</span></a>) (<a id="a:115" class="idref" href="#a:115"><span class="id" title="binder">a</span></a> : <a class="idref" href="PLF.Imp.html#aexp"><span class="id" title="inductive">aexp</span></a>) : <a class="idref" href="PLF.Imp.html#aexp"><span class="id" title="inductive">aexp</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="PLF.Equiv.html#a:115"><span class="id" title="variable">a</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="PLF.Imp.html#ANum"><span class="id" title="constructor">ANum</span></a> <span class="id" title="var">n</span>       ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#ANum"><span class="id" title="constructor">ANum</span></a> <span class="id" title="var">n</span><br/>
&nbsp;&nbsp;| <a class="idref" href="PLF.Imp.html#AId"><span class="id" title="constructor">AId</span></a> <span class="id" title="var">x'</span>       ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="definition">String.eqb</span> <a class="idref" href="PLF.Equiv.html#x:113"><span class="id" title="variable">x</span></a> <span class="id" title="var">x'</span> <span class="id" title="keyword">then</span> <a class="idref" href="PLF.Equiv.html#u:114"><span class="id" title="variable">u</span></a> <span class="id" title="keyword">else</span> <a class="idref" href="PLF.Imp.html#AId"><span class="id" title="constructor">AId</span></a> <span class="id" title="var">x'</span><br/>
&nbsp;&nbsp;| <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <span class="id" title="var">a1</span> <a class="idref" href="PLF.Imp.html#ad27fd091d9c8494ce7e5135135d19a8"><span class="id" title="notation">+</span></a> <span class="id" title="var">a2</span> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a>  ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Imp.html#5a96623d056c293ebbcdf03005796e09"><span class="id" title="notation">(</span></a><a class="idref" href="PLF.Equiv.html#subst_aexp:116"><span class="id" title="definition">subst_aexp</span></a> <a class="idref" href="PLF.Equiv.html#x:113"><span class="id" title="variable">x</span></a> <a class="idref" href="PLF.Equiv.html#u:114"><span class="id" title="variable">u</span></a> <span class="id" title="var">a1</span><a class="idref" href="PLF.Imp.html#5a96623d056c293ebbcdf03005796e09"><span class="id" title="notation">)</span></a> <a class="idref" href="PLF.Imp.html#ad27fd091d9c8494ce7e5135135d19a8"><span class="id" title="notation">+</span></a> <a class="idref" href="PLF.Imp.html#5a96623d056c293ebbcdf03005796e09"><span class="id" title="notation">(</span></a><a class="idref" href="PLF.Equiv.html#subst_aexp:116"><span class="id" title="definition">subst_aexp</span></a> <a class="idref" href="PLF.Equiv.html#x:113"><span class="id" title="variable">x</span></a> <a class="idref" href="PLF.Equiv.html#u:114"><span class="id" title="variable">u</span></a> <span class="id" title="var">a2</span><a class="idref" href="PLF.Imp.html#5a96623d056c293ebbcdf03005796e09"><span class="id" title="notation">)</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <span class="id" title="var">a1</span> <a class="idref" href="PLF.Imp.html#:com::x_'-'_x"><span class="id" title="notation">-</span></a> <span class="id" title="var">a2</span> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Imp.html#5a96623d056c293ebbcdf03005796e09"><span class="id" title="notation">(</span></a><a class="idref" href="PLF.Equiv.html#subst_aexp:116"><span class="id" title="definition">subst_aexp</span></a> <a class="idref" href="PLF.Equiv.html#x:113"><span class="id" title="variable">x</span></a> <a class="idref" href="PLF.Equiv.html#u:114"><span class="id" title="variable">u</span></a> <span class="id" title="var">a1</span><a class="idref" href="PLF.Imp.html#5a96623d056c293ebbcdf03005796e09"><span class="id" title="notation">)</span></a> <a class="idref" href="PLF.Imp.html#:com::x_'-'_x"><span class="id" title="notation">-</span></a> <a class="idref" href="PLF.Imp.html#5a96623d056c293ebbcdf03005796e09"><span class="id" title="notation">(</span></a><a class="idref" href="PLF.Equiv.html#subst_aexp:116"><span class="id" title="definition">subst_aexp</span></a> <a class="idref" href="PLF.Equiv.html#x:113"><span class="id" title="variable">x</span></a> <a class="idref" href="PLF.Equiv.html#u:114"><span class="id" title="variable">u</span></a> <span class="id" title="var">a2</span><a class="idref" href="PLF.Imp.html#5a96623d056c293ebbcdf03005796e09"><span class="id" title="notation">)</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <span class="id" title="var">a1</span> <a class="idref" href="PLF.Imp.html#a73c7b35e67094dc8ae672f3a93da066"><span class="id" title="notation">×</span></a> <span class="id" title="var">a2</span> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a>  ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Imp.html#5a96623d056c293ebbcdf03005796e09"><span class="id" title="notation">(</span></a><a class="idref" href="PLF.Equiv.html#subst_aexp:116"><span class="id" title="definition">subst_aexp</span></a> <a class="idref" href="PLF.Equiv.html#x:113"><span class="id" title="variable">x</span></a> <a class="idref" href="PLF.Equiv.html#u:114"><span class="id" title="variable">u</span></a> <span class="id" title="var">a1</span><a class="idref" href="PLF.Imp.html#5a96623d056c293ebbcdf03005796e09"><span class="id" title="notation">)</span></a> <a class="idref" href="PLF.Imp.html#a73c7b35e67094dc8ae672f3a93da066"><span class="id" title="notation">×</span></a> <a class="idref" href="PLF.Imp.html#5a96623d056c293ebbcdf03005796e09"><span class="id" title="notation">(</span></a><a class="idref" href="PLF.Equiv.html#subst_aexp:116"><span class="id" title="definition">subst_aexp</span></a> <a class="idref" href="PLF.Equiv.html#x:113"><span class="id" title="variable">x</span></a> <a class="idref" href="PLF.Equiv.html#u:114"><span class="id" title="variable">u</span></a> <span class="id" title="var">a2</span><a class="idref" href="PLF.Imp.html#5a96623d056c293ebbcdf03005796e09"><span class="id" title="notation">)</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Example</span> <a id="subst_aexp_ex" class="idref" href="#subst_aexp_ex"><span class="id" title="definition">subst_aexp_ex</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#subst_aexp"><span class="id" title="definition">subst_aexp</span></a> <a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a>42 <a class="idref" href="PLF.Imp.html#ad27fd091d9c8494ce7e5135135d19a8"><span class="id" title="notation">+</span></a> 53<a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a><a class="idref" href="PLF.Imp.html#Y"><span class="id" title="definition">Y</span></a> <a class="idref" href="PLF.Imp.html#ad27fd091d9c8494ce7e5135135d19a8"><span class="id" title="notation">+</span></a> <a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a><a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Imp.html#Y"><span class="id" title="definition">Y</span></a> <a class="idref" href="PLF.Imp.html#ad27fd091d9c8494ce7e5135135d19a8"><span class="id" title="notation">+</span></a> <a class="idref" href="PLF.Imp.html#5a96623d056c293ebbcdf03005796e09"><span class="id" title="notation">(</span></a>42 <a class="idref" href="PLF.Imp.html#ad27fd091d9c8494ce7e5135135d19a8"><span class="id" title="notation">+</span></a> 53<a class="idref" href="PLF.Imp.html#5a96623d056c293ebbcdf03005796e09"><span class="id" title="notation">)</span></a><a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
And here is the property we are interested in, expressing the
    claim that commands <span class="inlinecode"><span class="id" title="var">c1</span></span> and <span class="inlinecode"><span class="id" title="var">c2</span></span> as described above are
    always equivalent.  
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a id="subst_equiv_property" class="idref" href="#subst_equiv_property"><span class="id" title="definition">subst_equiv_property</span></a> : <span class="id" title="keyword">Prop</span> := <span class="id" title="keyword">∀</span> <a id="x1:118" class="idref" href="#x1:118"><span class="id" title="binder">x1</span></a> <a id="x2:119" class="idref" href="#x2:119"><span class="id" title="binder">x2</span></a> <a id="a1:120" class="idref" href="#a1:120"><span class="id" title="binder">a1</span></a> <a id="a2:121" class="idref" href="#a2:121"><span class="id" title="binder">a2</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#cequiv"><span class="id" title="definition">cequiv</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Equiv.html#x1:118"><span class="id" title="variable">x1</span></a> <a class="idref" href="PLF.Imp.html#91e9aa710642047a93142bdf557f1a1b"><span class="id" title="notation">:=</span></a> <a class="idref" href="PLF.Equiv.html#a1:120"><span class="id" title="variable">a1</span></a><a class="idref" href="PLF.Imp.html#313afe74ec81f2da17d8e7bca3b042e7"><span class="id" title="notation">;</span></a> <a class="idref" href="PLF.Equiv.html#x2:119"><span class="id" title="variable">x2</span></a> <a class="idref" href="PLF.Imp.html#91e9aa710642047a93142bdf557f1a1b"><span class="id" title="notation">:=</span></a> <a class="idref" href="PLF.Equiv.html#a2:121"><span class="id" title="variable">a2</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Equiv.html#x1:118"><span class="id" title="variable">x1</span></a> <a class="idref" href="PLF.Imp.html#91e9aa710642047a93142bdf557f1a1b"><span class="id" title="notation">:=</span></a> <a class="idref" href="PLF.Equiv.html#a1:120"><span class="id" title="variable">a1</span></a><a class="idref" href="PLF.Imp.html#313afe74ec81f2da17d8e7bca3b042e7"><span class="id" title="notation">;</span></a> <a class="idref" href="PLF.Equiv.html#x2:119"><span class="id" title="variable">x2</span></a> <a class="idref" href="PLF.Imp.html#91e9aa710642047a93142bdf557f1a1b"><span class="id" title="notation">:=</span></a> <a class="idref" href="PLF.Equiv.html#subst_aexp"><span class="id" title="definition">subst_aexp</span></a> <a class="idref" href="PLF.Equiv.html#x1:118"><span class="id" title="variable">x1</span></a> <a class="idref" href="PLF.Equiv.html#a1:120"><span class="id" title="variable">a1</span></a> <a class="idref" href="PLF.Equiv.html#a2:121"><span class="id" title="variable">a2</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a>.<br/>

<br/>
</div>

<div class="doc">
Sadly, the property does <i>not</i> always hold.

<div class="paragraph"> </div>

    Here is a counterexample:

<div class="paragraph"> </div>

       X := X + 1; Y := X

<div class="paragraph"> </div>

    If we perform the substitution, we get

<div class="paragraph"> </div>

       X := X + 1; Y := X + 1

<div class="paragraph"> </div>

    which clearly isn't equivalent. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a id="subst_inequiv" class="idref" href="#subst_inequiv"><span class="id" title="lemma">subst_inequiv</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">¬</span></a> <a class="idref" href="PLF.Equiv.html#subst_equiv_property"><span class="id" title="definition">subst_equiv_property</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="PLF.Equiv.html#subst_equiv_property"><span class="id" title="definition">subst_equiv_property</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Contra</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="var">remember</span> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="PLF.Imp.html#91e9aa710642047a93142bdf557f1a1b"><span class="id" title="notation">:=</span></a> <a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="PLF.Imp.html#ad27fd091d9c8494ce7e5135135d19a8"><span class="id" title="notation">+</span></a> 1<a class="idref" href="PLF.Imp.html#313afe74ec81f2da17d8e7bca3b042e7"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#Y"><span class="id" title="definition">Y</span></a> <a class="idref" href="PLF.Imp.html#91e9aa710642047a93142bdf557f1a1b"><span class="id" title="notation">:=</span></a> <a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">as</span> <span class="id" title="var">c1</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">remember</span> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="PLF.Imp.html#91e9aa710642047a93142bdf557f1a1b"><span class="id" title="notation">:=</span></a> <a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="PLF.Imp.html#ad27fd091d9c8494ce7e5135135d19a8"><span class="id" title="notation">+</span></a> 1<a class="idref" href="PLF.Imp.html#313afe74ec81f2da17d8e7bca3b042e7"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#Y"><span class="id" title="definition">Y</span></a> <a class="idref" href="PLF.Imp.html#91e9aa710642047a93142bdf557f1a1b"><span class="id" title="notation">:=</span></a> <a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="PLF.Imp.html#ad27fd091d9c8494ce7e5135135d19a8"><span class="id" title="notation">+</span></a> 1 <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">as</span> <span class="id" title="var">c2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="PLF.Equiv.html#cequiv"><span class="id" title="definition">cequiv</span></a> <span class="id" title="var">c1</span> <span class="id" title="var">c2</span>) <span class="id" title="tactic">by</span> (<span class="id" title="tactic">subst</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">Contra</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">Contra</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="var">remember</span> (<a class="idref" href="PLF.Imp.html#Y"><span class="id" title="definition">Y</span></a> <a class="idref" href="PLF.Maps.html#630986d105c0f1782d085b9a306379a7"><span class="id" title="notation">!-&gt;</span></a> 1 <a class="idref" href="PLF.Maps.html#630986d105c0f1782d085b9a306379a7"><span class="id" title="notation">;</span></a> <a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="PLF.Imp.html#c78e6ed7f05f8146dc2bcb368255bece"><span class="id" title="notation">!-&gt;</span></a> 1) <span class="id" title="keyword">as</span> <span class="id" title="var">st1</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">remember</span> (<a class="idref" href="PLF.Imp.html#Y"><span class="id" title="definition">Y</span></a> <a class="idref" href="PLF.Maps.html#630986d105c0f1782d085b9a306379a7"><span class="id" title="notation">!-&gt;</span></a> 2 <a class="idref" href="PLF.Maps.html#630986d105c0f1782d085b9a306379a7"><span class="id" title="notation">;</span></a> <a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="PLF.Imp.html#c78e6ed7f05f8146dc2bcb368255bece"><span class="id" title="notation">!-&gt;</span></a> 1) <span class="id" title="keyword">as</span> <span class="id" title="var">st2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">H1</span> : <a class="idref" href="PLF.Imp.html#empty_st"><span class="id" title="definition">empty_st</span></a> <a class="idref" href="PLF.Imp.html#6037d1f4787d63984beccd5510872ee9"><span class="id" title="notation">=[</span></a> <span class="id" title="var">c1</span> <a class="idref" href="PLF.Imp.html#6037d1f4787d63984beccd5510872ee9"><span class="id" title="notation">]=&gt;</span></a> <span class="id" title="var">st1</span>);<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">H2</span> : <a class="idref" href="PLF.Imp.html#empty_st"><span class="id" title="definition">empty_st</span></a> <a class="idref" href="PLF.Imp.html#6037d1f4787d63984beccd5510872ee9"><span class="id" title="notation">=[</span></a> <span class="id" title="var">c2</span> <a class="idref" href="PLF.Imp.html#6037d1f4787d63984beccd5510872ee9"><span class="id" title="notation">]=&gt;</span></a> <span class="id" title="var">st2</span>);<br/>
&nbsp;&nbsp;<span class="id" title="tactic">try</span> (<span class="id" title="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="PLF.Imp.html#E_Seq"><span class="id" title="constructor">E_Seq</span></a> <span class="id" title="keyword">with</span> (<span class="id" title="var">st'</span> := (<a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="PLF.Imp.html#c78e6ed7f05f8146dc2bcb368255bece"><span class="id" title="notation">!-&gt;</span></a> 1));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="PLF.Imp.html#E_Asgn"><span class="id" title="constructor">E_Asgn</span></a>; <span class="id" title="tactic">reflexivity</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">Heqc1</span> <span class="id" title="var">Heqc2</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">H</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hcontra</span> : <span class="id" title="var">st1</span> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">st2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> (<span class="id" title="tactic">apply</span> (<a class="idref" href="PLF.Imp.html#ceval_deterministic"><span class="id" title="lemma">ceval_deterministic</span></a> <span class="id" title="var">c2</span> <a class="idref" href="PLF.Imp.html#empty_st"><span class="id" title="definition">empty_st</span></a>); <span class="id" title="tactic">assumption</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">H1</span> <span class="id" title="var">H2</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hcontra'</span> : <span class="id" title="var">st1</span> <a class="idref" href="PLF.Imp.html#Y"><span class="id" title="definition">Y</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">st2</span> <a class="idref" href="PLF.Imp.html#Y"><span class="id" title="definition">Y</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> (<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hcontra</span>; <span class="id" title="tactic">reflexivity</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">subst</span>. <span class="id" title="tactic">discriminate</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab32"></a><h4 class="section">Exercise: 4 stars, standard, optional (better_subst_equiv)</h4>


<div class="paragraph"> </div>

    The equivalence we had in mind above was not complete nonsense --
    in fact, it was actually almost right.  To make it correct, we
    just need to exclude the case where the variable <span class="inlinecode"><span class="id" title="var">X</span></span> occurs in the
    right-hand side of the first assignment statement. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Inductive</span> <a id="var_not_used_in_aexp" class="idref" href="#var_not_used_in_aexp"><span class="id" title="definition, inductive"><span id="var_not_used_in_aexp_ind" class="id"><span id="var_not_used_in_aexp_sind" class="id">var_not_used_in_aexp</span></span></span></a> (<a id="x:122" class="idref" href="#x:122"><span class="id" title="binder">x</span></a> : <span class="id" title="inductive">string</span>) : <a class="idref" href="PLF.Imp.html#aexp"><span class="id" title="inductive">aexp</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;| <a id="VNUNum" class="idref" href="#VNUNum"><span class="id" title="constructor">VNUNum</span></a> : <span class="id" title="keyword">∀</span> <a id="n:125" class="idref" href="#n:125"><span class="id" title="binder">n</span></a>, <a class="idref" href="PLF.Equiv.html#var_not_used_in_aexp:123"><span class="id" title="inductive">var_not_used_in_aexp</span></a> <a class="idref" href="PLF.Equiv.html#x:122"><span class="id" title="variable">x</span></a> (<a class="idref" href="PLF.Imp.html#ANum"><span class="id" title="constructor">ANum</span></a> <a class="idref" href="PLF.Equiv.html#n:125"><span class="id" title="variable">n</span></a>)<br/>
&nbsp;&nbsp;| <a id="VNUId" class="idref" href="#VNUId"><span class="id" title="constructor">VNUId</span></a> : <span class="id" title="keyword">∀</span> <a id="y:126" class="idref" href="#y:126"><span class="id" title="binder">y</span></a>, <a class="idref" href="PLF.Equiv.html#x:122"><span class="id" title="variable">x</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">≠</span></a> <a class="idref" href="PLF.Equiv.html#y:126"><span class="id" title="variable">y</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="PLF.Equiv.html#var_not_used_in_aexp:123"><span class="id" title="inductive">var_not_used_in_aexp</span></a> <a class="idref" href="PLF.Equiv.html#x:122"><span class="id" title="variable">x</span></a> (<a class="idref" href="PLF.Imp.html#AId"><span class="id" title="constructor">AId</span></a> <a class="idref" href="PLF.Equiv.html#y:126"><span class="id" title="variable">y</span></a>)<br/>
&nbsp;&nbsp;| <a id="VNUPlus" class="idref" href="#VNUPlus"><span class="id" title="constructor">VNUPlus</span></a> : <span class="id" title="keyword">∀</span> <a id="a1:127" class="idref" href="#a1:127"><span class="id" title="binder">a1</span></a> <a id="a2:128" class="idref" href="#a2:128"><span class="id" title="binder">a2</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#var_not_used_in_aexp:123"><span class="id" title="inductive">var_not_used_in_aexp</span></a> <a class="idref" href="PLF.Equiv.html#x:122"><span class="id" title="variable">x</span></a> <a class="idref" href="PLF.Equiv.html#a1:127"><span class="id" title="variable">a1</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#var_not_used_in_aexp:123"><span class="id" title="inductive">var_not_used_in_aexp</span></a> <a class="idref" href="PLF.Equiv.html#x:122"><span class="id" title="variable">x</span></a> <a class="idref" href="PLF.Equiv.html#a2:128"><span class="id" title="variable">a2</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#var_not_used_in_aexp:123"><span class="id" title="inductive">var_not_used_in_aexp</span></a> <a class="idref" href="PLF.Equiv.html#x:122"><span class="id" title="variable">x</span></a> (<a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Equiv.html#a1:127"><span class="id" title="variable">a1</span></a> <a class="idref" href="PLF.Imp.html#ad27fd091d9c8494ce7e5135135d19a8"><span class="id" title="notation">+</span></a> <a class="idref" href="PLF.Equiv.html#a2:128"><span class="id" title="variable">a2</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a>)<br/>
&nbsp;&nbsp;| <a id="VNUMinus" class="idref" href="#VNUMinus"><span class="id" title="constructor">VNUMinus</span></a> : <span class="id" title="keyword">∀</span> <a id="a1:129" class="idref" href="#a1:129"><span class="id" title="binder">a1</span></a> <a id="a2:130" class="idref" href="#a2:130"><span class="id" title="binder">a2</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#var_not_used_in_aexp:123"><span class="id" title="inductive">var_not_used_in_aexp</span></a> <a class="idref" href="PLF.Equiv.html#x:122"><span class="id" title="variable">x</span></a> <a class="idref" href="PLF.Equiv.html#a1:129"><span class="id" title="variable">a1</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#var_not_used_in_aexp:123"><span class="id" title="inductive">var_not_used_in_aexp</span></a> <a class="idref" href="PLF.Equiv.html#x:122"><span class="id" title="variable">x</span></a> <a class="idref" href="PLF.Equiv.html#a2:130"><span class="id" title="variable">a2</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#var_not_used_in_aexp:123"><span class="id" title="inductive">var_not_used_in_aexp</span></a> <a class="idref" href="PLF.Equiv.html#x:122"><span class="id" title="variable">x</span></a> (<a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Equiv.html#a1:129"><span class="id" title="variable">a1</span></a> <a class="idref" href="PLF.Imp.html#:com::x_'-'_x"><span class="id" title="notation">-</span></a> <a class="idref" href="PLF.Equiv.html#a2:130"><span class="id" title="variable">a2</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a>)<br/>
&nbsp;&nbsp;| <a id="VNUMult" class="idref" href="#VNUMult"><span class="id" title="constructor">VNUMult</span></a> : <span class="id" title="keyword">∀</span> <a id="a1:131" class="idref" href="#a1:131"><span class="id" title="binder">a1</span></a> <a id="a2:132" class="idref" href="#a2:132"><span class="id" title="binder">a2</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#var_not_used_in_aexp:123"><span class="id" title="inductive">var_not_used_in_aexp</span></a> <a class="idref" href="PLF.Equiv.html#x:122"><span class="id" title="variable">x</span></a> <a class="idref" href="PLF.Equiv.html#a1:131"><span class="id" title="variable">a1</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#var_not_used_in_aexp:123"><span class="id" title="inductive">var_not_used_in_aexp</span></a> <a class="idref" href="PLF.Equiv.html#x:122"><span class="id" title="variable">x</span></a> <a class="idref" href="PLF.Equiv.html#a2:132"><span class="id" title="variable">a2</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#var_not_used_in_aexp:123"><span class="id" title="inductive">var_not_used_in_aexp</span></a> <a class="idref" href="PLF.Equiv.html#x:122"><span class="id" title="variable">x</span></a> (<a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Equiv.html#a1:131"><span class="id" title="variable">a1</span></a> <a class="idref" href="PLF.Imp.html#a73c7b35e67094dc8ae672f3a93da066"><span class="id" title="notation">×</span></a> <a class="idref" href="PLF.Equiv.html#a2:132"><span class="id" title="variable">a2</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="aeval_weakening" class="idref" href="#aeval_weakening"><span class="id" title="lemma">aeval_weakening</span></a> : <span class="id" title="keyword">∀</span> <a id="x:133" class="idref" href="#x:133"><span class="id" title="binder">x</span></a> <a id="st:134" class="idref" href="#st:134"><span class="id" title="binder">st</span></a> <a id="a:135" class="idref" href="#a:135"><span class="id" title="binder">a</span></a> <a id="ni:136" class="idref" href="#ni:136"><span class="id" title="binder">ni</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#var_not_used_in_aexp"><span class="id" title="inductive">var_not_used_in_aexp</span></a> <a class="idref" href="PLF.Equiv.html#x:133"><span class="id" title="variable">x</span></a> <a class="idref" href="PLF.Equiv.html#a:135"><span class="id" title="variable">a</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#aeval"><span class="id" title="definition">aeval</span></a> (<a class="idref" href="PLF.Equiv.html#x:133"><span class="id" title="variable">x</span></a> <a class="idref" href="PLF.Maps.html#630986d105c0f1782d085b9a306379a7"><span class="id" title="notation">!-&gt;</span></a> <a class="idref" href="PLF.Equiv.html#ni:136"><span class="id" title="variable">ni</span></a> <a class="idref" href="PLF.Maps.html#630986d105c0f1782d085b9a306379a7"><span class="id" title="notation">;</span></a> <a class="idref" href="PLF.Equiv.html#st:134"><span class="id" title="variable">st</span></a>) <a class="idref" href="PLF.Equiv.html#a:135"><span class="id" title="variable">a</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="PLF.Imp.html#aeval"><span class="id" title="definition">aeval</span></a> <a class="idref" href="PLF.Equiv.html#st:134"><span class="id" title="variable">st</span></a> <a class="idref" href="PLF.Equiv.html#a:135"><span class="id" title="variable">a</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>

<br/>
</div>

<div class="doc">
Using <span class="inlinecode"><span class="id" title="var">var_not_used_in_aexp</span></span>, formalize and prove a correct version
    of <span class="inlinecode"><span class="id" title="var">subst_equiv_property</span></span>. 
</div>
<div class="code">

<br/>

<br/>
</div>

<div class="doc">
<a id="lab33"></a><h4 class="section">Exercise: 3 stars, standard (inequiv_exercise)</h4>


<div class="paragraph"> </div>

    Prove that an infinite loop is not equivalent to <span class="inlinecode"><span class="id" title="var">skip</span></span> 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a id="inequiv_exercise" class="idref" href="#inequiv_exercise"><span class="id" title="lemma">inequiv_exercise</span></a>:<br/>
&nbsp;&nbsp;<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">¬</span></a> <a class="idref" href="PLF.Equiv.html#cequiv"><span class="id" title="definition">cequiv</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">while</span></a> <a class="idref" href="PLF.Imp.html#:com::'true'"><span class="id" title="notation">true</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">do</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'skip'"><span class="id" title="notation">skip</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'while'_x_'do'_x_'end'"><span class="id" title="notation">end</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Imp.html#:com:com_scope:'skip'"><span class="id" title="notation">skip</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a id="lab34"></a><h1 class="section">Extended Exercise: Nondeterministic Imp</h1>

<div class="paragraph"> </div>

 As we have seen (in theorem <span class="inlinecode"><span class="id" title="var">ceval_deterministic</span></span> in the <span class="inlinecode"><span class="id" title="var">Imp</span></span>
    chapter), Imp's evaluation relation is deterministic.  However,
    <i>non</i>-determinism is an important part of the definition of many
    real programming languages. For example, in many imperative
    languages (such as C and its relatives), the order in which
    function arguments are evaluated is unspecified.  The program
    fragment

<div class="paragraph"> </div>

      x = 0;
      f(++x, x)

<div class="paragraph"> </div>

    might call <span class="inlinecode"><span class="id" title="var">f</span></span> with arguments <span class="inlinecode">(1,</span> <span class="inlinecode">0)</span> or <span class="inlinecode">(1,</span> <span class="inlinecode">1)</span>, depending how
    the compiler chooses to order things.  This can be a little
    confusing for programmers, but it gives the compiler writer useful
    freedom.

<div class="paragraph"> </div>

    In this exercise, we will extend Imp with a simple
    nondeterministic command and study how this change affects
    program equivalence.  The new command has the syntax <span class="inlinecode"><span class="id" title="var">HAVOC</span></span> <span class="inlinecode"><span class="id" title="var">X</span></span>,
    where <span class="inlinecode"><span class="id" title="var">X</span></span> is an identifier. The effect of executing <span class="inlinecode"><span class="id" title="var">HAVOC</span></span> <span class="inlinecode"><span class="id" title="var">X</span></span> is
    to assign an <i>arbitrary</i> number to the variable <span class="inlinecode"><span class="id" title="var">X</span></span>,
    nondeterministically. For example, after executing the program:

<div class="paragraph"> </div>

      HAVOC Y;
      Z := Y * 2

<div class="paragraph"> </div>

    the value of <span class="inlinecode"><span class="id" title="var">Y</span></span> can be any number, while the value of <span class="inlinecode"><span class="id" title="var">Z</span></span> is
    twice that of <span class="inlinecode"><span class="id" title="var">Y</span></span> (so <span class="inlinecode"><span class="id" title="var">Z</span></span> is always even). Note that we are not
    saying anything about the <i>probabilities</i> of the outcomes -- just
    that there are (infinitely) many different outcomes that can
    possibly happen after executing this nondeterministic code.

<div class="paragraph"> </div>

    In a sense, a variable on which we do <span class="inlinecode"><span class="id" title="var">HAVOC</span></span> roughly corresponds
    to an uninitialized variable in a low-level language like C.  After
    the <span class="inlinecode"><span class="id" title="var">HAVOC</span></span>, the variable holds a fixed but arbitrary number.  Most
    sources of nondeterminism in language definitions are there
    precisely because programmers don't care which choice is made (and
    so it is good to leave it open to the compiler to choose whichever
    will run faster).

<div class="paragraph"> </div>

    We call this new language <i>Himp</i> (``Imp extended with <span class="inlinecode"><span class="id" title="var">HAVOC</span></span>''). 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Module</span> <a id="Himp" class="idref" href="#Himp"><span class="id" title="module">Himp</span></a>.<br/>

<br/>
</div>

<div class="doc">
To formalize Himp, we first add a clause to the definition of
    commands. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Inductive</span> <a id="Himp.com" class="idref" href="#Himp.com"><span class="id" title="definition, inductive"><span id="Himp.com_rect" class="id"><span id="Himp.com_ind" class="id"><span id="Himp.com_rec" class="id"><span id="Himp.com_sind" class="id">com</span></span></span></span></span></a> : <span class="id" title="keyword">Type</span> :=<br/>
&nbsp;&nbsp;| <a id="Himp.CSkip" class="idref" href="#Himp.CSkip"><span class="id" title="constructor">CSkip</span></a> : <a class="idref" href="PLF.Equiv.html#com:137"><span class="id" title="inductive">com</span></a><br/>
&nbsp;&nbsp;| <a id="Himp.CAsgn" class="idref" href="#Himp.CAsgn"><span class="id" title="constructor">CAsgn</span></a> : <span class="id" title="inductive">string</span> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="PLF.Imp.html#aexp"><span class="id" title="inductive">aexp</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="PLF.Equiv.html#com:137"><span class="id" title="inductive">com</span></a><br/>
&nbsp;&nbsp;| <a id="Himp.CSeq" class="idref" href="#Himp.CSeq"><span class="id" title="constructor">CSeq</span></a> : <a class="idref" href="PLF.Equiv.html#com:137"><span class="id" title="inductive">com</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="PLF.Equiv.html#com:137"><span class="id" title="inductive">com</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="PLF.Equiv.html#com:137"><span class="id" title="inductive">com</span></a><br/>
&nbsp;&nbsp;| <a id="Himp.CIf" class="idref" href="#Himp.CIf"><span class="id" title="constructor">CIf</span></a> : <a class="idref" href="PLF.Imp.html#bexp"><span class="id" title="inductive">bexp</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="PLF.Equiv.html#com:137"><span class="id" title="inductive">com</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="PLF.Equiv.html#com:137"><span class="id" title="inductive">com</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="PLF.Equiv.html#com:137"><span class="id" title="inductive">com</span></a><br/>
&nbsp;&nbsp;| <a id="Himp.CWhile" class="idref" href="#Himp.CWhile"><span class="id" title="constructor">CWhile</span></a> : <a class="idref" href="PLF.Imp.html#bexp"><span class="id" title="inductive">bexp</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="PLF.Equiv.html#com:137"><span class="id" title="inductive">com</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="PLF.Equiv.html#com:137"><span class="id" title="inductive">com</span></a><br/>
&nbsp;&nbsp;| <a id="Himp.CHavoc" class="idref" href="#Himp.CHavoc"><span class="id" title="constructor">CHavoc</span></a> : <span class="id" title="inductive">string</span> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="PLF.Equiv.html#com:137"><span class="id" title="inductive">com</span></a>. 
<br/>
<span class="id" title="keyword">Notation</span> <a id="Himp.:com::'havoc'_x" class="idref" href="#Himp.:com::'havoc'_x"><span class="id" title="notation">&quot;</span></a>'havoc' l" := (<a class="idref" href="PLF.Equiv.html#Himp.CHavoc"><span class="id" title="constructor">CHavoc</span></a> <span class="id" title="var">l</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">in</span> <span class="id" title="var">custom</span> <span class="id" title="var">com</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 60, <span class="id" title="var">l</span> <span class="id" title="keyword">constr</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 0).<br/>
<span class="id" title="keyword">Notation</span> <a id="Himp.:com::'skip'" class="idref" href="#Himp.:com::'skip'"><span class="id" title="notation">&quot;</span></a>'skip'"  :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#Himp.CSkip"><span class="id" title="constructor">CSkip</span></a> (<span class="id" title="tactic">in</span> <span class="id" title="var">custom</span> <span class="id" title="var">com</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 0).<br/>
<span class="id" title="keyword">Notation</span> <a id="8520c4c68851dd55d33b324c83d1c4f5" class="idref" href="#8520c4c68851dd55d33b324c83d1c4f5"><span class="id" title="notation">&quot;</span></a>x := y"  :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="PLF.Equiv.html#Himp.CAsgn"><span class="id" title="constructor">CAsgn</span></a> <span class="id" title="var">x</span> <span class="id" title="var">y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">in</span> <span class="id" title="var">custom</span> <span class="id" title="var">com</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 0, <span class="id" title="var">x</span> <span class="id" title="keyword">constr</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 0,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">y</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 85, <span class="id" title="keyword">no</span> <span class="id" title="keyword">associativity</span>).<br/>
<span class="id" title="keyword">Notation</span> <a id="77cb1189aa0f77e096b5d4774eb2d829" class="idref" href="#77cb1189aa0f77e096b5d4774eb2d829"><span class="id" title="notation">&quot;</span></a>x ; y" :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="PLF.Equiv.html#Himp.CSeq"><span class="id" title="constructor">CSeq</span></a> <span class="id" title="var">x</span> <span class="id" title="var">y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">in</span> <span class="id" title="var">custom</span> <span class="id" title="var">com</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 90, <span class="id" title="tactic">right</span> <span class="id" title="keyword">associativity</span>).<br/>
<span class="id" title="keyword">Notation</span> <a id="Himp.:com::'if'_x_'then'_x_'else'_x_'end'" class="idref" href="#Himp.:com::'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">&quot;</span></a>'if' x 'then' y 'else' z 'end'" :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="PLF.Equiv.html#Himp.CIf"><span class="id" title="constructor">CIf</span></a> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">in</span> <span class="id" title="var">custom</span> <span class="id" title="var">com</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 89, <span class="id" title="var">x</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 99,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">y</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 99, <span class="id" title="var">z</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 99).<br/>
<span class="id" title="keyword">Notation</span> <a id="Himp.:com::'while'_x_'do'_x_'end'" class="idref" href="#Himp.:com::'while'_x_'do'_x_'end'"><span class="id" title="notation">&quot;</span></a>'while' x 'do' y 'end'" :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="PLF.Equiv.html#Himp.CWhile"><span class="id" title="constructor">CWhile</span></a> <span class="id" title="var">x</span> <span class="id" title="var">y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">in</span> <span class="id" title="var">custom</span> <span class="id" title="var">com</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 89, <span class="id" title="var">x</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 99, <span class="id" title="var">y</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 99).<br/>

<br/>
</div>

<div class="doc">
<a id="lab35"></a><h4 class="section">Exercise: 2 stars, standard (himp_ceval)</h4>


<div class="paragraph"> </div>

    Now, we must extend the operational semantics. We have provided
   a template for the <span class="inlinecode"><span class="id" title="var">ceval</span></span> relation below, specifying the big-step
   semantics. What rule(s) must be added to the definition of <span class="inlinecode"><span class="id" title="var">ceval</span></span>
   to formalize the behavior of the <span class="inlinecode"><span class="id" title="var">HAVOC</span></span> command? 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Reserved Notation</span> &quot;st '=[' c ']=&gt;' st'"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 40, <span class="id" title="var">c</span> <span class="id" title="var">custom</span> <span class="id" title="var">com</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 99, <span class="id" title="var">st</span> <span class="id" title="keyword">constr</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">st'</span> <span class="id" title="keyword">constr</span> <span class="id" title="tactic">at</span> <span class="id" title="var">next</span> <span class="id" title="keyword">level</span>).<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <a id="Himp.ceval" class="idref" href="#Himp.ceval"><span class="id" title="definition, inductive"><span id="Himp.ceval_ind" class="id"><span id="Himp.ceval_sind" class="id">ceval</span></span></span></a> : <a class="idref" href="PLF.Equiv.html#Himp.com"><span class="id" title="inductive">com</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="PLF.Imp.html#state"><span class="id" title="definition">state</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="PLF.Imp.html#state"><span class="id" title="definition">state</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;| <a id="Himp.E_Skip" class="idref" href="#Himp.E_Skip"><span class="id" title="constructor">E_Skip</span></a> : <span class="id" title="keyword">∀</span> <a id="st:141" class="idref" href="#st:141"><span class="id" title="binder">st</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#st:141"><span class="id" title="variable">st</span></a> <a class="idref" href="PLF.Equiv.html#e8def6e1c7a66877a96e361d5569b34e"><span class="id" title="notation">=[</span></a> <a class="idref" href="PLF.Equiv.html#Himp.:com::'skip'"><span class="id" title="notation">skip</span></a> <a class="idref" href="PLF.Equiv.html#e8def6e1c7a66877a96e361d5569b34e"><span class="id" title="notation">]=&gt;</span></a> <a class="idref" href="PLF.Equiv.html#st:141"><span class="id" title="variable">st</span></a><br/>
&nbsp;&nbsp;| <a id="Himp.E_Asgn" class="idref" href="#Himp.E_Asgn"><span class="id" title="constructor">E_Asgn</span></a>  : <span class="id" title="keyword">∀</span> <a id="st:142" class="idref" href="#st:142"><span class="id" title="binder">st</span></a> <a id="a:143" class="idref" href="#a:143"><span class="id" title="binder">a</span></a> <a id="n:144" class="idref" href="#n:144"><span class="id" title="binder">n</span></a> <a id="x:145" class="idref" href="#x:145"><span class="id" title="binder">x</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#aeval"><span class="id" title="definition">aeval</span></a> <a class="idref" href="PLF.Equiv.html#st:142"><span class="id" title="variable">st</span></a> <a class="idref" href="PLF.Equiv.html#a:143"><span class="id" title="variable">a</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="PLF.Equiv.html#n:144"><span class="id" title="variable">n</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#st:142"><span class="id" title="variable">st</span></a> <a class="idref" href="PLF.Equiv.html#e8def6e1c7a66877a96e361d5569b34e"><span class="id" title="notation">=[</span></a> <a class="idref" href="PLF.Equiv.html#x:145"><span class="id" title="variable">x</span></a> <a class="idref" href="PLF.Equiv.html#8520c4c68851dd55d33b324c83d1c4f5"><span class="id" title="notation">:=</span></a> <a class="idref" href="PLF.Equiv.html#a:143"><span class="id" title="variable">a</span></a> <a class="idref" href="PLF.Equiv.html#e8def6e1c7a66877a96e361d5569b34e"><span class="id" title="notation">]=&gt;</span></a> <a class="idref" href="PLF.Equiv.html#e8def6e1c7a66877a96e361d5569b34e"><span class="id" title="notation">(</span></a><a class="idref" href="PLF.Equiv.html#x:145"><span class="id" title="variable">x</span></a> <a class="idref" href="PLF.Maps.html#630986d105c0f1782d085b9a306379a7"><span class="id" title="notation">!-&gt;</span></a> <a class="idref" href="PLF.Equiv.html#n:144"><span class="id" title="variable">n</span></a> <a class="idref" href="PLF.Maps.html#630986d105c0f1782d085b9a306379a7"><span class="id" title="notation">;</span></a> <a class="idref" href="PLF.Equiv.html#st:142"><span class="id" title="variable">st</span></a><a class="idref" href="PLF.Equiv.html#e8def6e1c7a66877a96e361d5569b34e"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;| <a id="Himp.E_Seq" class="idref" href="#Himp.E_Seq"><span class="id" title="constructor">E_Seq</span></a> : <span class="id" title="keyword">∀</span> <a id="c1:146" class="idref" href="#c1:146"><span class="id" title="binder">c1</span></a> <a id="c2:147" class="idref" href="#c2:147"><span class="id" title="binder">c2</span></a> <a id="st:148" class="idref" href="#st:148"><span class="id" title="binder">st</span></a> <a id="st':149" class="idref" href="#st':149"><span class="id" title="binder">st'</span></a> <a id="st'':150" class="idref" href="#st'':150"><span class="id" title="binder">st''</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#st:148"><span class="id" title="variable">st</span></a>  <a class="idref" href="PLF.Equiv.html#e8def6e1c7a66877a96e361d5569b34e"><span class="id" title="notation">=[</span></a> <a class="idref" href="PLF.Equiv.html#c1:146"><span class="id" title="variable">c1</span></a> <a class="idref" href="PLF.Equiv.html#e8def6e1c7a66877a96e361d5569b34e"><span class="id" title="notation">]=&gt;</span></a> <a class="idref" href="PLF.Equiv.html#st':149"><span class="id" title="variable">st'</span></a>  <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#st':149"><span class="id" title="variable">st'</span></a> <a class="idref" href="PLF.Equiv.html#e8def6e1c7a66877a96e361d5569b34e"><span class="id" title="notation">=[</span></a> <a class="idref" href="PLF.Equiv.html#c2:147"><span class="id" title="variable">c2</span></a> <a class="idref" href="PLF.Equiv.html#e8def6e1c7a66877a96e361d5569b34e"><span class="id" title="notation">]=&gt;</span></a> <a class="idref" href="PLF.Equiv.html#st'':150"><span class="id" title="variable">st''</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#st:148"><span class="id" title="variable">st</span></a>  <a class="idref" href="PLF.Equiv.html#e8def6e1c7a66877a96e361d5569b34e"><span class="id" title="notation">=[</span></a> <a class="idref" href="PLF.Equiv.html#c1:146"><span class="id" title="variable">c1</span></a> <a class="idref" href="PLF.Equiv.html#77cb1189aa0f77e096b5d4774eb2d829"><span class="id" title="notation">;</span></a> <a class="idref" href="PLF.Equiv.html#c2:147"><span class="id" title="variable">c2</span></a> <a class="idref" href="PLF.Equiv.html#e8def6e1c7a66877a96e361d5569b34e"><span class="id" title="notation">]=&gt;</span></a> <a class="idref" href="PLF.Equiv.html#st'':150"><span class="id" title="variable">st''</span></a><br/>
&nbsp;&nbsp;| <a id="Himp.E_IfTrue" class="idref" href="#Himp.E_IfTrue"><span class="id" title="constructor">E_IfTrue</span></a> : <span class="id" title="keyword">∀</span> <a id="st:151" class="idref" href="#st:151"><span class="id" title="binder">st</span></a> <a id="st':152" class="idref" href="#st':152"><span class="id" title="binder">st'</span></a> <a id="b:153" class="idref" href="#b:153"><span class="id" title="binder">b</span></a> <a id="c1:154" class="idref" href="#c1:154"><span class="id" title="binder">c1</span></a> <a id="c2:155" class="idref" href="#c2:155"><span class="id" title="binder">c2</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#beval"><span class="id" title="definition">beval</span></a> <a class="idref" href="PLF.Equiv.html#st:151"><span class="id" title="variable">st</span></a> <a class="idref" href="PLF.Equiv.html#b:153"><span class="id" title="variable">b</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="PLF.Imp.html#:::'true'"><span class="id" title="notation">true</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#st:151"><span class="id" title="variable">st</span></a> <a class="idref" href="PLF.Equiv.html#e8def6e1c7a66877a96e361d5569b34e"><span class="id" title="notation">=[</span></a> <a class="idref" href="PLF.Equiv.html#c1:154"><span class="id" title="variable">c1</span></a> <a class="idref" href="PLF.Equiv.html#e8def6e1c7a66877a96e361d5569b34e"><span class="id" title="notation">]=&gt;</span></a> <a class="idref" href="PLF.Equiv.html#st':152"><span class="id" title="variable">st'</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#st:151"><span class="id" title="variable">st</span></a> <a class="idref" href="PLF.Equiv.html#e8def6e1c7a66877a96e361d5569b34e"><span class="id" title="notation">=[</span></a> <a class="idref" href="PLF.Equiv.html#Himp.:com::'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">if</span></a> <a class="idref" href="PLF.Equiv.html#b:153"><span class="id" title="variable">b</span></a> <a class="idref" href="PLF.Equiv.html#Himp.:com::'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">then</span></a> <a class="idref" href="PLF.Equiv.html#c1:154"><span class="id" title="variable">c1</span></a> <a class="idref" href="PLF.Equiv.html#Himp.:com::'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">else</span></a> <a class="idref" href="PLF.Equiv.html#c2:155"><span class="id" title="variable">c2</span></a> <a class="idref" href="PLF.Equiv.html#Himp.:com::'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">end</span></a> <a class="idref" href="PLF.Equiv.html#e8def6e1c7a66877a96e361d5569b34e"><span class="id" title="notation">]=&gt;</span></a> <a class="idref" href="PLF.Equiv.html#st':152"><span class="id" title="variable">st'</span></a><br/>
&nbsp;&nbsp;| <a id="Himp.E_IfFalse" class="idref" href="#Himp.E_IfFalse"><span class="id" title="constructor">E_IfFalse</span></a> : <span class="id" title="keyword">∀</span> <a id="st:156" class="idref" href="#st:156"><span class="id" title="binder">st</span></a> <a id="st':157" class="idref" href="#st':157"><span class="id" title="binder">st'</span></a> <a id="b:158" class="idref" href="#b:158"><span class="id" title="binder">b</span></a> <a id="c1:159" class="idref" href="#c1:159"><span class="id" title="binder">c1</span></a> <a id="c2:160" class="idref" href="#c2:160"><span class="id" title="binder">c2</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#beval"><span class="id" title="definition">beval</span></a> <a class="idref" href="PLF.Equiv.html#st:156"><span class="id" title="variable">st</span></a> <a class="idref" href="PLF.Equiv.html#b:158"><span class="id" title="variable">b</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="PLF.Imp.html#:::'false'"><span class="id" title="notation">false</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#st:156"><span class="id" title="variable">st</span></a> <a class="idref" href="PLF.Equiv.html#e8def6e1c7a66877a96e361d5569b34e"><span class="id" title="notation">=[</span></a> <a class="idref" href="PLF.Equiv.html#c2:160"><span class="id" title="variable">c2</span></a> <a class="idref" href="PLF.Equiv.html#e8def6e1c7a66877a96e361d5569b34e"><span class="id" title="notation">]=&gt;</span></a> <a class="idref" href="PLF.Equiv.html#st':157"><span class="id" title="variable">st'</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#st:156"><span class="id" title="variable">st</span></a> <a class="idref" href="PLF.Equiv.html#e8def6e1c7a66877a96e361d5569b34e"><span class="id" title="notation">=[</span></a> <a class="idref" href="PLF.Equiv.html#Himp.:com::'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">if</span></a> <a class="idref" href="PLF.Equiv.html#b:158"><span class="id" title="variable">b</span></a> <a class="idref" href="PLF.Equiv.html#Himp.:com::'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">then</span></a> <a class="idref" href="PLF.Equiv.html#c1:159"><span class="id" title="variable">c1</span></a> <a class="idref" href="PLF.Equiv.html#Himp.:com::'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">else</span></a> <a class="idref" href="PLF.Equiv.html#c2:160"><span class="id" title="variable">c2</span></a> <a class="idref" href="PLF.Equiv.html#Himp.:com::'if'_x_'then'_x_'else'_x_'end'"><span class="id" title="notation">end</span></a> <a class="idref" href="PLF.Equiv.html#e8def6e1c7a66877a96e361d5569b34e"><span class="id" title="notation">]=&gt;</span></a> <a class="idref" href="PLF.Equiv.html#st':157"><span class="id" title="variable">st'</span></a><br/>
&nbsp;&nbsp;| <a id="Himp.E_WhileFalse" class="idref" href="#Himp.E_WhileFalse"><span class="id" title="constructor">E_WhileFalse</span></a> : <span class="id" title="keyword">∀</span> <a id="b:161" class="idref" href="#b:161"><span class="id" title="binder">b</span></a> <a id="st:162" class="idref" href="#st:162"><span class="id" title="binder">st</span></a> <a id="c:163" class="idref" href="#c:163"><span class="id" title="binder">c</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#beval"><span class="id" title="definition">beval</span></a> <a class="idref" href="PLF.Equiv.html#st:162"><span class="id" title="variable">st</span></a> <a class="idref" href="PLF.Equiv.html#b:161"><span class="id" title="variable">b</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="PLF.Imp.html#:::'false'"><span class="id" title="notation">false</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#st:162"><span class="id" title="variable">st</span></a> <a class="idref" href="PLF.Equiv.html#e8def6e1c7a66877a96e361d5569b34e"><span class="id" title="notation">=[</span></a> <a class="idref" href="PLF.Equiv.html#Himp.:com::'while'_x_'do'_x_'end'"><span class="id" title="notation">while</span></a> <a class="idref" href="PLF.Equiv.html#b:161"><span class="id" title="variable">b</span></a> <a class="idref" href="PLF.Equiv.html#Himp.:com::'while'_x_'do'_x_'end'"><span class="id" title="notation">do</span></a> <a class="idref" href="PLF.Equiv.html#c:163"><span class="id" title="variable">c</span></a> <a class="idref" href="PLF.Equiv.html#Himp.:com::'while'_x_'do'_x_'end'"><span class="id" title="notation">end</span></a> <a class="idref" href="PLF.Equiv.html#e8def6e1c7a66877a96e361d5569b34e"><span class="id" title="notation">]=&gt;</span></a> <a class="idref" href="PLF.Equiv.html#st:162"><span class="id" title="variable">st</span></a><br/>
&nbsp;&nbsp;| <a id="Himp.E_WhileTrue" class="idref" href="#Himp.E_WhileTrue"><span class="id" title="constructor">E_WhileTrue</span></a> : <span class="id" title="keyword">∀</span> <a id="st:164" class="idref" href="#st:164"><span class="id" title="binder">st</span></a> <a id="st':165" class="idref" href="#st':165"><span class="id" title="binder">st'</span></a> <a id="st'':166" class="idref" href="#st'':166"><span class="id" title="binder">st''</span></a> <a id="b:167" class="idref" href="#b:167"><span class="id" title="binder">b</span></a> <a id="c:168" class="idref" href="#c:168"><span class="id" title="binder">c</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#beval"><span class="id" title="definition">beval</span></a> <a class="idref" href="PLF.Equiv.html#st:164"><span class="id" title="variable">st</span></a> <a class="idref" href="PLF.Equiv.html#b:167"><span class="id" title="variable">b</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="PLF.Imp.html#:::'true'"><span class="id" title="notation">true</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#st:164"><span class="id" title="variable">st</span></a>  <a class="idref" href="PLF.Equiv.html#e8def6e1c7a66877a96e361d5569b34e"><span class="id" title="notation">=[</span></a> <a class="idref" href="PLF.Equiv.html#c:168"><span class="id" title="variable">c</span></a> <a class="idref" href="PLF.Equiv.html#e8def6e1c7a66877a96e361d5569b34e"><span class="id" title="notation">]=&gt;</span></a> <a class="idref" href="PLF.Equiv.html#st':165"><span class="id" title="variable">st'</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#st':165"><span class="id" title="variable">st'</span></a> <a class="idref" href="PLF.Equiv.html#e8def6e1c7a66877a96e361d5569b34e"><span class="id" title="notation">=[</span></a> <a class="idref" href="PLF.Equiv.html#Himp.:com::'while'_x_'do'_x_'end'"><span class="id" title="notation">while</span></a> <a class="idref" href="PLF.Equiv.html#b:167"><span class="id" title="variable">b</span></a> <a class="idref" href="PLF.Equiv.html#Himp.:com::'while'_x_'do'_x_'end'"><span class="id" title="notation">do</span></a> <a class="idref" href="PLF.Equiv.html#c:168"><span class="id" title="variable">c</span></a> <a class="idref" href="PLF.Equiv.html#Himp.:com::'while'_x_'do'_x_'end'"><span class="id" title="notation">end</span></a> <a class="idref" href="PLF.Equiv.html#e8def6e1c7a66877a96e361d5569b34e"><span class="id" title="notation">]=&gt;</span></a> <a class="idref" href="PLF.Equiv.html#st'':166"><span class="id" title="variable">st''</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#st:164"><span class="id" title="variable">st</span></a>  <a class="idref" href="PLF.Equiv.html#e8def6e1c7a66877a96e361d5569b34e"><span class="id" title="notation">=[</span></a> <a class="idref" href="PLF.Equiv.html#Himp.:com::'while'_x_'do'_x_'end'"><span class="id" title="notation">while</span></a> <a class="idref" href="PLF.Equiv.html#b:167"><span class="id" title="variable">b</span></a> <a class="idref" href="PLF.Equiv.html#Himp.:com::'while'_x_'do'_x_'end'"><span class="id" title="notation">do</span></a> <a class="idref" href="PLF.Equiv.html#c:168"><span class="id" title="variable">c</span></a> <a class="idref" href="PLF.Equiv.html#Himp.:com::'while'_x_'do'_x_'end'"><span class="id" title="notation">end</span></a> <a class="idref" href="PLF.Equiv.html#e8def6e1c7a66877a96e361d5569b34e"><span class="id" title="notation">]=&gt;</span></a> <a class="idref" href="PLF.Equiv.html#st'':166"><span class="id" title="variable">st''</span></a><br/>
<br/>
<br/>
&nbsp;&nbsp;<span class="id" title="keyword">where</span> <a id="e8def6e1c7a66877a96e361d5569b34e" class="idref" href="#e8def6e1c7a66877a96e361d5569b34e"><span class="id" title="notation">&quot;</span></a>st =[ c ]=&gt; st'" := (<a class="idref" href="PLF.Equiv.html#ceval:140"><span class="id" title="inductive">ceval</span></a> <span class="id" title="var">c</span> <span class="id" title="var">st</span> <span class="id" title="var">st'</span>).<br/>

<br/>
</div>

<div class="doc">
As a sanity check, the following claims should be provable for
    your definition: 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Example</span> <a id="Himp.havoc_example1" class="idref" href="#Himp.havoc_example1"><span class="id" title="definition">havoc_example1</span></a> : <a class="idref" href="PLF.Imp.html#empty_st"><span class="id" title="definition">empty_st</span></a> <a class="idref" href="PLF.Equiv.html#e8def6e1c7a66877a96e361d5569b34e"><span class="id" title="notation">=[</span></a> <a class="idref" href="PLF.Equiv.html#Himp.:com::'havoc'_x"><span class="id" title="notation">havoc</span></a> <a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="PLF.Equiv.html#e8def6e1c7a66877a96e361d5569b34e"><span class="id" title="notation">]=&gt;</span></a> <a class="idref" href="PLF.Equiv.html#e8def6e1c7a66877a96e361d5569b34e"><span class="id" title="notation">(</span></a><a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="PLF.Imp.html#c78e6ed7f05f8146dc2bcb368255bece"><span class="id" title="notation">!-&gt;</span></a> 0<a class="idref" href="PLF.Equiv.html#e8def6e1c7a66877a96e361d5569b34e"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Example</span> <a id="Himp.havoc_example2" class="idref" href="#Himp.havoc_example2"><span class="id" title="definition">havoc_example2</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#empty_st"><span class="id" title="definition">empty_st</span></a> <a class="idref" href="PLF.Equiv.html#e8def6e1c7a66877a96e361d5569b34e"><span class="id" title="notation">=[</span></a> <a class="idref" href="PLF.Equiv.html#Himp.:com::'skip'"><span class="id" title="notation">skip</span></a><a class="idref" href="PLF.Equiv.html#77cb1189aa0f77e096b5d4774eb2d829"><span class="id" title="notation">;</span></a> <a class="idref" href="PLF.Equiv.html#Himp.:com::'havoc'_x"><span class="id" title="notation">havoc</span></a> <a class="idref" href="PLF.Imp.html#Z"><span class="id" title="definition">Z</span></a> <a class="idref" href="PLF.Equiv.html#e8def6e1c7a66877a96e361d5569b34e"><span class="id" title="notation">]=&gt;</span></a> <a class="idref" href="PLF.Equiv.html#e8def6e1c7a66877a96e361d5569b34e"><span class="id" title="notation">(</span></a><a class="idref" href="PLF.Imp.html#Z"><span class="id" title="definition">Z</span></a> <a class="idref" href="PLF.Imp.html#c78e6ed7f05f8146dc2bcb368255bece"><span class="id" title="notation">!-&gt;</span></a> 42<a class="idref" href="PLF.Equiv.html#e8def6e1c7a66877a96e361d5569b34e"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="Himp.manual_grade_for_Check_rule_for_HAVOC" class="idref" href="#Himp.manual_grade_for_Check_rule_for_HAVOC"><span class="id" title="definition">manual_grade_for_Check_rule_for_HAVOC</span></a> : <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> (<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a><a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">×</span></a><span class="id" title="inductive">string</span>) := <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
<div class="paragraph"> </div>

 Finally, we repeat the definition of command equivalence from above: 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a id="Himp.cequiv" class="idref" href="#Himp.cequiv"><span class="id" title="definition">cequiv</span></a> (<a id="c1:169" class="idref" href="#c1:169"><span class="id" title="binder">c1</span></a> <a id="c2:170" class="idref" href="#c2:170"><span class="id" title="binder">c2</span></a> : <a class="idref" href="PLF.Equiv.html#Himp.com"><span class="id" title="inductive">com</span></a>) : <span class="id" title="keyword">Prop</span> := <span class="id" title="keyword">∀</span> <a id="st:171" class="idref" href="#st:171"><span class="id" title="binder">st</span></a> <a id="st':172" class="idref" href="#st':172"><span class="id" title="binder">st'</span></a> : <a class="idref" href="PLF.Imp.html#state"><span class="id" title="definition">state</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#st:171"><span class="id" title="variable">st</span></a> <a class="idref" href="PLF.Equiv.html#e8def6e1c7a66877a96e361d5569b34e"><span class="id" title="notation">=[</span></a> <a class="idref" href="PLF.Equiv.html#c1:169"><span class="id" title="variable">c1</span></a> <a class="idref" href="PLF.Equiv.html#e8def6e1c7a66877a96e361d5569b34e"><span class="id" title="notation">]=&gt;</span></a> <a class="idref" href="PLF.Equiv.html#st':172"><span class="id" title="variable">st'</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">↔</span></a> <a class="idref" href="PLF.Equiv.html#st:171"><span class="id" title="variable">st</span></a> <a class="idref" href="PLF.Equiv.html#e8def6e1c7a66877a96e361d5569b34e"><span class="id" title="notation">=[</span></a> <a class="idref" href="PLF.Equiv.html#c2:170"><span class="id" title="variable">c2</span></a> <a class="idref" href="PLF.Equiv.html#e8def6e1c7a66877a96e361d5569b34e"><span class="id" title="notation">]=&gt;</span></a> <a class="idref" href="PLF.Equiv.html#st':172"><span class="id" title="variable">st'</span></a>.<br/>

<br/>
</div>

<div class="doc">
Let's apply this definition to prove some nondeterministic
    programs equivalent / inequivalent. 
<div class="paragraph"> </div>

<a id="lab36"></a><h4 class="section">Exercise: 3 stars, standard (havoc_swap)</h4>


<div class="paragraph"> </div>

    Are the following two programs equivalent? 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a id="Himp.pXY" class="idref" href="#Himp.pXY"><span class="id" title="definition">pXY</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Equiv.html#Himp.:com::'havoc'_x"><span class="id" title="notation">havoc</span></a> <a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="PLF.Equiv.html#77cb1189aa0f77e096b5d4774eb2d829"><span class="id" title="notation">;</span></a> <a class="idref" href="PLF.Equiv.html#Himp.:com::'havoc'_x"><span class="id" title="notation">havoc</span></a> <a class="idref" href="PLF.Imp.html#Y"><span class="id" title="definition">Y</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="Himp.pYX" class="idref" href="#Himp.pYX"><span class="id" title="definition">pYX</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Equiv.html#Himp.:com::'havoc'_x"><span class="id" title="notation">havoc</span></a> <a class="idref" href="PLF.Imp.html#Y"><span class="id" title="definition">Y</span></a><a class="idref" href="PLF.Equiv.html#77cb1189aa0f77e096b5d4774eb2d829"><span class="id" title="notation">;</span></a> <a class="idref" href="PLF.Equiv.html#Himp.:com::'havoc'_x"><span class="id" title="notation">havoc</span></a> <a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a>.<br/>

<br/>
</div>

<div class="doc">
If you think they are equivalent, prove it. If you think they are
    not, prove that. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a id="Himp.pXY_cequiv_pYX" class="idref" href="#Himp.pXY_cequiv_pYX"><span class="id" title="lemma">pXY_cequiv_pYX</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#Himp.cequiv"><span class="id" title="definition">cequiv</span></a> <a class="idref" href="PLF.Equiv.html#Himp.pXY"><span class="id" title="definition">pXY</span></a> <a class="idref" href="PLF.Equiv.html#Himp.pYX"><span class="id" title="definition">pYX</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25"><span class="id" title="notation">∨</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">¬</span></a><a class="idref" href="PLF.Equiv.html#Himp.cequiv"><span class="id" title="definition">cequiv</span></a> <a class="idref" href="PLF.Equiv.html#Himp.pXY"><span class="id" title="definition">pXY</span></a> <a class="idref" href="PLF.Equiv.html#Himp.pYX"><span class="id" title="definition">pYX</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
<div class="paragraph"> </div>

<a id="lab37"></a><h4 class="section">Exercise: 4 stars, standard, optional (havoc_copy)</h4>


<div class="paragraph"> </div>

    Are the following two programs equivalent? 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a id="Himp.ptwice" class="idref" href="#Himp.ptwice"><span class="id" title="definition">ptwice</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Equiv.html#Himp.:com::'havoc'_x"><span class="id" title="notation">havoc</span></a> <a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a><a class="idref" href="PLF.Equiv.html#77cb1189aa0f77e096b5d4774eb2d829"><span class="id" title="notation">;</span></a> <a class="idref" href="PLF.Equiv.html#Himp.:com::'havoc'_x"><span class="id" title="notation">havoc</span></a> <a class="idref" href="PLF.Imp.html#Y"><span class="id" title="definition">Y</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="Himp.pcopy" class="idref" href="#Himp.pcopy"><span class="id" title="definition">pcopy</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Equiv.html#Himp.:com::'havoc'_x"><span class="id" title="notation">havoc</span></a> <a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a><a class="idref" href="PLF.Equiv.html#77cb1189aa0f77e096b5d4774eb2d829"><span class="id" title="notation">;</span></a> <a class="idref" href="PLF.Imp.html#Y"><span class="id" title="definition">Y</span></a> <a class="idref" href="PLF.Equiv.html#8520c4c68851dd55d33b324c83d1c4f5"><span class="id" title="notation">:=</span></a> <a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a>.<br/>

<br/>
</div>

<div class="doc">
If you think they are equivalent, then prove it. If you think they
    are not, then prove that.  (Hint: You may find the <span class="inlinecode"><span class="id" title="tactic">assert</span></span> tactic
    useful.) 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a id="Himp.ptwice_cequiv_pcopy" class="idref" href="#Himp.ptwice_cequiv_pcopy"><span class="id" title="lemma">ptwice_cequiv_pcopy</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#Himp.cequiv"><span class="id" title="definition">cequiv</span></a> <a class="idref" href="PLF.Equiv.html#Himp.ptwice"><span class="id" title="definition">ptwice</span></a> <a class="idref" href="PLF.Equiv.html#Himp.pcopy"><span class="id" title="definition">pcopy</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25"><span class="id" title="notation">∨</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">¬</span></a><a class="idref" href="PLF.Equiv.html#Himp.cequiv"><span class="id" title="definition">cequiv</span></a> <a class="idref" href="PLF.Equiv.html#Himp.ptwice"><span class="id" title="definition">ptwice</span></a> <a class="idref" href="PLF.Equiv.html#Himp.pcopy"><span class="id" title="definition">pcopy</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.  <span class="id" title="var">Admitted</span>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
<div class="paragraph"> </div>

 The definition of program equivalence we are using here has some
    subtle consequences on programs that may loop forever.  What
    <span class="inlinecode"><span class="id" title="var">cequiv</span></span> says is that the set of possible <i>terminating</i> outcomes
    of two equivalent programs is the same. However, in a language
    with nondeterminism, like Himp, some programs always terminate,
    some programs always diverge, and some programs can
    nondeterministically terminate in some runs and diverge in
    others. The final part of the following exercise illustrates this
    phenomenon.

<div class="paragraph"> </div>

<a id="lab38"></a><h4 class="section">Exercise: 4 stars, advanced (p1_p2_term)</h4>


<div class="paragraph"> </div>

    Consider the following commands: 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a id="Himp.p1" class="idref" href="#Himp.p1"><span class="id" title="definition">p1</span></a> : <a class="idref" href="PLF.Equiv.html#Himp.com"><span class="id" title="inductive">com</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Equiv.html#Himp.:com::'while'_x_'do'_x_'end'"><span class="id" title="notation">while</span></a> <a class="idref" href="PLF.Imp.html#dfe50505b2b595242030c436d0d7d15f"><span class="id" title="notation">¬</span></a> <a class="idref" href="PLF.Imp.html#5a96623d056c293ebbcdf03005796e09"><span class="id" title="notation">(</span></a><a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="PLF.Imp.html#9e5b22caf5d7cf490e97976162618c2a"><span class="id" title="notation">=</span></a> 0<a class="idref" href="PLF.Imp.html#5a96623d056c293ebbcdf03005796e09"><span class="id" title="notation">)</span></a> <a class="idref" href="PLF.Equiv.html#Himp.:com::'while'_x_'do'_x_'end'"><span class="id" title="notation">do</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#Himp.:com::'havoc'_x"><span class="id" title="notation">havoc</span></a> <a class="idref" href="PLF.Imp.html#Y"><span class="id" title="definition">Y</span></a><a class="idref" href="PLF.Equiv.html#77cb1189aa0f77e096b5d4774eb2d829"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="PLF.Equiv.html#8520c4c68851dd55d33b324c83d1c4f5"><span class="id" title="notation">:=</span></a> <a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="PLF.Imp.html#ad27fd091d9c8494ce7e5135135d19a8"><span class="id" title="notation">+</span></a> 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#Himp.:com::'while'_x_'do'_x_'end'"><span class="id" title="notation">end</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="Himp.p2" class="idref" href="#Himp.p2"><span class="id" title="definition">p2</span></a> : <a class="idref" href="PLF.Equiv.html#Himp.com"><span class="id" title="inductive">com</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Equiv.html#Himp.:com::'while'_x_'do'_x_'end'"><span class="id" title="notation">while</span></a> <a class="idref" href="PLF.Imp.html#dfe50505b2b595242030c436d0d7d15f"><span class="id" title="notation">¬</span></a> <a class="idref" href="PLF.Imp.html#5a96623d056c293ebbcdf03005796e09"><span class="id" title="notation">(</span></a><a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="PLF.Imp.html#9e5b22caf5d7cf490e97976162618c2a"><span class="id" title="notation">=</span></a> 0<a class="idref" href="PLF.Imp.html#5a96623d056c293ebbcdf03005796e09"><span class="id" title="notation">)</span></a> <a class="idref" href="PLF.Equiv.html#Himp.:com::'while'_x_'do'_x_'end'"><span class="id" title="notation">do</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#Himp.:com::'skip'"><span class="id" title="notation">skip</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#Himp.:com::'while'_x_'do'_x_'end'"><span class="id" title="notation">end</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a>.<br/>

<br/>
</div>

<div class="doc">
Intuitively, <span class="inlinecode"><span class="id" title="var">p1</span></span> and <span class="inlinecode"><span class="id" title="var">p2</span></span> have the same termination behavior:
    either they loop forever, or they terminate in the same state they
    started in.  We can capture the termination behavior of <span class="inlinecode"><span class="id" title="var">p1</span></span> and
    <span class="inlinecode"><span class="id" title="var">p2</span></span> individually with these lemmas: 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <a id="Himp.p1_may_diverge" class="idref" href="#Himp.p1_may_diverge"><span class="id" title="lemma">p1_may_diverge</span></a> : <span class="id" title="keyword">∀</span> <a id="st:173" class="idref" href="#st:173"><span class="id" title="binder">st</span></a> <a id="st':174" class="idref" href="#st':174"><span class="id" title="binder">st'</span></a>, <a class="idref" href="PLF.Equiv.html#st:173"><span class="id" title="variable">st</span></a> <a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">≠</span></a> 0 <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">¬</span></a> <a class="idref" href="PLF.Equiv.html#st:173"><span class="id" title="variable">st</span></a> <a class="idref" href="PLF.Equiv.html#e8def6e1c7a66877a96e361d5569b34e"><span class="id" title="notation">=[</span></a> <a class="idref" href="PLF.Equiv.html#Himp.p1"><span class="id" title="definition">p1</span></a> <a class="idref" href="PLF.Equiv.html#e8def6e1c7a66877a96e361d5569b34e"><span class="id" title="notation">]=&gt;</span></a> <a class="idref" href="PLF.Equiv.html#st':174"><span class="id" title="variable">st'</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.  <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="Himp.p2_may_diverge" class="idref" href="#Himp.p2_may_diverge"><span class="id" title="lemma">p2_may_diverge</span></a> : <span class="id" title="keyword">∀</span> <a id="st:175" class="idref" href="#st:175"><span class="id" title="binder">st</span></a> <a id="st':176" class="idref" href="#st':176"><span class="id" title="binder">st'</span></a>, <a class="idref" href="PLF.Equiv.html#st:175"><span class="id" title="variable">st</span></a> <a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">≠</span></a> 0 <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">¬</span></a> <a class="idref" href="PLF.Equiv.html#st:175"><span class="id" title="variable">st</span></a> <a class="idref" href="PLF.Equiv.html#e8def6e1c7a66877a96e361d5569b34e"><span class="id" title="notation">=[</span></a> <a class="idref" href="PLF.Equiv.html#Himp.p2"><span class="id" title="definition">p2</span></a> <a class="idref" href="PLF.Equiv.html#e8def6e1c7a66877a96e361d5569b34e"><span class="id" title="notation">]=&gt;</span></a> <a class="idref" href="PLF.Equiv.html#st':176"><span class="id" title="variable">st'</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
<div class="paragraph"> </div>

<a id="lab39"></a><h4 class="section">Exercise: 4 stars, advanced (p1_p2_equiv)</h4>


<div class="paragraph"> </div>

    Use these two lemmas to prove that <span class="inlinecode"><span class="id" title="var">p1</span></span> and <span class="inlinecode"><span class="id" title="var">p2</span></span> are actually
    equivalent. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a id="Himp.p1_p2_equiv" class="idref" href="#Himp.p1_p2_equiv"><span class="id" title="lemma">p1_p2_equiv</span></a> : <a class="idref" href="PLF.Equiv.html#Himp.cequiv"><span class="id" title="definition">cequiv</span></a> <a class="idref" href="PLF.Equiv.html#Himp.p1"><span class="id" title="definition">p1</span></a> <a class="idref" href="PLF.Equiv.html#Himp.p2"><span class="id" title="definition">p2</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.  <span class="id" title="var">Admitted</span>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
<div class="paragraph"> </div>

<a id="lab40"></a><h4 class="section">Exercise: 4 stars, advanced (p3_p4_inequiv)</h4>


<div class="paragraph"> </div>

    Prove that the following programs are <i>not</i> equivalent.  (Hint:
    What should the value of <span class="inlinecode"><span class="id" title="var">Z</span></span> be when <span class="inlinecode"><span class="id" title="var">p3</span></span> terminates?  What about
    <span class="inlinecode"><span class="id" title="var">p4</span></span>?) 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a id="Himp.p3" class="idref" href="#Himp.p3"><span class="id" title="definition">p3</span></a> : <a class="idref" href="PLF.Equiv.html#Himp.com"><span class="id" title="inductive">com</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Imp.html#Z"><span class="id" title="definition">Z</span></a> <a class="idref" href="PLF.Equiv.html#8520c4c68851dd55d33b324c83d1c4f5"><span class="id" title="notation">:=</span></a> 1<a class="idref" href="PLF.Equiv.html#77cb1189aa0f77e096b5d4774eb2d829"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#Himp.:com::'while'_x_'do'_x_'end'"><span class="id" title="notation">while</span></a> <a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="PLF.Imp.html#:com::x_'&lt;&gt;'_x"><span class="id" title="notation">≠</span></a> 0 <a class="idref" href="PLF.Equiv.html#Himp.:com::'while'_x_'do'_x_'end'"><span class="id" title="notation">do</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#Himp.:com::'havoc'_x"><span class="id" title="notation">havoc</span></a> <a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a><a class="idref" href="PLF.Equiv.html#77cb1189aa0f77e096b5d4774eb2d829"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#Himp.:com::'havoc'_x"><span class="id" title="notation">havoc</span></a> <a class="idref" href="PLF.Imp.html#Z"><span class="id" title="definition">Z</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#Himp.:com::'while'_x_'do'_x_'end'"><span class="id" title="notation">end</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="Himp.p4" class="idref" href="#Himp.p4"><span class="id" title="definition">p4</span></a> : <a class="idref" href="PLF.Equiv.html#Himp.com"><span class="id" title="inductive">com</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="PLF.Equiv.html#8520c4c68851dd55d33b324c83d1c4f5"><span class="id" title="notation">:=</span></a> 0<a class="idref" href="PLF.Equiv.html#77cb1189aa0f77e096b5d4774eb2d829"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#Z"><span class="id" title="definition">Z</span></a> <a class="idref" href="PLF.Equiv.html#8520c4c68851dd55d33b324c83d1c4f5"><span class="id" title="notation">:=</span></a> 1 <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a>.<br/>

<br/>
<span class="id" title="keyword">Theorem</span> <a id="Himp.p3_p4_inequiv" class="idref" href="#Himp.p3_p4_inequiv"><span class="id" title="lemma">p3_p4_inequiv</span></a> : <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">¬</span></a> <a class="idref" href="PLF.Equiv.html#Himp.cequiv"><span class="id" title="definition">cequiv</span></a> <a class="idref" href="PLF.Equiv.html#Himp.p3"><span class="id" title="definition">p3</span></a> <a class="idref" href="PLF.Equiv.html#Himp.p4"><span class="id" title="definition">p4</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.  <span class="id" title="var">Admitted</span>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
<div class="paragraph"> </div>

<a id="lab41"></a><h4 class="section">Exercise: 5 stars, advanced, optional (p5_p6_equiv)</h4>


<div class="paragraph"> </div>

    Prove that the following commands are equivalent.  (Hint: As
    mentioned above, our definition of <span class="inlinecode"><span class="id" title="var">cequiv</span></span> for Himp only takes
    into account the sets of possible terminating configurations: two
    programs are equivalent if and only if the set of possible terminating
    states is the same for both programs when given a same starting state
    <span class="inlinecode"><span class="id" title="var">st</span></span>.  If <span class="inlinecode"><span class="id" title="var">p5</span></span> terminates, what should the final state be? Conversely,
    is it always possible to make <span class="inlinecode"><span class="id" title="var">p5</span></span> terminate?) 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a id="Himp.p5" class="idref" href="#Himp.p5"><span class="id" title="definition">p5</span></a> : <a class="idref" href="PLF.Equiv.html#Himp.com"><span class="id" title="inductive">com</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Equiv.html#Himp.:com::'while'_x_'do'_x_'end'"><span class="id" title="notation">while</span></a> <a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="PLF.Imp.html#:com::x_'&lt;&gt;'_x"><span class="id" title="notation">≠</span></a> 1 <a class="idref" href="PLF.Equiv.html#Himp.:com::'while'_x_'do'_x_'end'"><span class="id" title="notation">do</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#Himp.:com::'havoc'_x"><span class="id" title="notation">havoc</span></a> <a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#Himp.:com::'while'_x_'do'_x_'end'"><span class="id" title="notation">end</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="Himp.p6" class="idref" href="#Himp.p6"><span class="id" title="definition">p6</span></a> : <a class="idref" href="PLF.Equiv.html#Himp.com"><span class="id" title="inductive">com</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="PLF.Equiv.html#8520c4c68851dd55d33b324c83d1c4f5"><span class="id" title="notation">:=</span></a> 1 <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a>.<br/>

<br/>
<span class="id" title="keyword">Theorem</span> <a id="Himp.p5_p6_equiv" class="idref" href="#Himp.p5_p6_equiv"><span class="id" title="lemma">p5_p6_equiv</span></a> : <a class="idref" href="PLF.Equiv.html#Himp.cequiv"><span class="id" title="definition">cequiv</span></a> <a class="idref" href="PLF.Equiv.html#Himp.p5"><span class="id" title="definition">p5</span></a> <a class="idref" href="PLF.Equiv.html#Himp.p6"><span class="id" title="definition">p6</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.  <span class="id" title="var">Admitted</span>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="PLF.Equiv.html#Himp"><span class="id" title="module">Himp</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab42"></a><h1 class="section">Additional Exercises</h1>

<div class="paragraph"> </div>

<a id="lab43"></a><h4 class="section">Exercise: 3 stars, standard, optional (swap_noninterfering_assignments)</h4>


<div class="paragraph"> </div>

    (Hint: You may or may not -- depending how you approach it -- need
    to use <span class="inlinecode"><span class="id" title="var">functional_extensionality</span></span> explicitly for this one.) 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a id="swap_noninterfering_assignments" class="idref" href="#swap_noninterfering_assignments"><span class="id" title="lemma">swap_noninterfering_assignments</span></a>: <span class="id" title="keyword">∀</span> <a id="l1:177" class="idref" href="#l1:177"><span class="id" title="binder">l1</span></a> <a id="l2:178" class="idref" href="#l2:178"><span class="id" title="binder">l2</span></a> <a id="a1:179" class="idref" href="#a1:179"><span class="id" title="binder">a1</span></a> <a id="a2:180" class="idref" href="#a2:180"><span class="id" title="binder">a2</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#l1:177"><span class="id" title="variable">l1</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">≠</span></a> <a class="idref" href="PLF.Equiv.html#l2:178"><span class="id" title="variable">l2</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#var_not_used_in_aexp"><span class="id" title="inductive">var_not_used_in_aexp</span></a> <a class="idref" href="PLF.Equiv.html#l1:177"><span class="id" title="variable">l1</span></a> <a class="idref" href="PLF.Equiv.html#a2:180"><span class="id" title="variable">a2</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#var_not_used_in_aexp"><span class="id" title="inductive">var_not_used_in_aexp</span></a> <a class="idref" href="PLF.Equiv.html#l2:178"><span class="id" title="variable">l2</span></a> <a class="idref" href="PLF.Equiv.html#a1:179"><span class="id" title="variable">a1</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#cequiv"><span class="id" title="definition">cequiv</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Equiv.html#l1:177"><span class="id" title="variable">l1</span></a> <a class="idref" href="PLF.Imp.html#91e9aa710642047a93142bdf557f1a1b"><span class="id" title="notation">:=</span></a> <a class="idref" href="PLF.Equiv.html#a1:179"><span class="id" title="variable">a1</span></a><a class="idref" href="PLF.Imp.html#313afe74ec81f2da17d8e7bca3b042e7"><span class="id" title="notation">;</span></a> <a class="idref" href="PLF.Equiv.html#l2:178"><span class="id" title="variable">l2</span></a> <a class="idref" href="PLF.Imp.html#91e9aa710642047a93142bdf557f1a1b"><span class="id" title="notation">:=</span></a> <a class="idref" href="PLF.Equiv.html#a2:180"><span class="id" title="variable">a2</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">&lt;{</span></a> <a class="idref" href="PLF.Equiv.html#l2:178"><span class="id" title="variable">l2</span></a> <a class="idref" href="PLF.Imp.html#91e9aa710642047a93142bdf557f1a1b"><span class="id" title="notation">:=</span></a> <a class="idref" href="PLF.Equiv.html#a2:180"><span class="id" title="variable">a2</span></a><a class="idref" href="PLF.Imp.html#313afe74ec81f2da17d8e7bca3b042e7"><span class="id" title="notation">;</span></a> <a class="idref" href="PLF.Equiv.html#l1:177"><span class="id" title="variable">l1</span></a> <a class="idref" href="PLF.Imp.html#91e9aa710642047a93142bdf557f1a1b"><span class="id" title="notation">:=</span></a> <a class="idref" href="PLF.Equiv.html#a1:179"><span class="id" title="variable">a1</span></a> <a class="idref" href="PLF.Imp.html#23430cd9e427d30c054d4f029e39cb7f"><span class="id" title="notation">}&gt;</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
<div class="paragraph"> </div>

<a id="lab44"></a><h4 class="section">Exercise: 4 stars, standard, optional (for_while_equiv)</h4>


<div class="paragraph"> </div>

    This exercise extends the optional <span class="inlinecode"><span class="id" title="var">add_for_loop</span></span> exercise from
    the <span class="inlinecode"><span class="id" title="var">Imp</span></span> chapter, where you were asked to extend the language
    of commands with C-style <span class="inlinecode"><span class="id" title="keyword">for</span></span> loops.  Prove that the command:

<div class="paragraph"> </div>

      for (c1; b; c2) {
          c3
      }

<div class="paragraph"> </div>

    is equivalent to:

<div class="paragraph"> </div>

       c1;
       while b do
         c3;
         c2
       end

</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a id="lab45"></a><h4 class="section">Exercise: 4 stars, advanced, optional (capprox)</h4>


<div class="paragraph"> </div>

    In this exercise we define an asymmetric variant of program
    equivalence we call <i>program approximation</i>. We say that a
    program <span class="inlinecode"><span class="id" title="var">c1</span></span> <i>approximates</i> a program <span class="inlinecode"><span class="id" title="var">c2</span></span> when, for each of
    the initial states for which <span class="inlinecode"><span class="id" title="var">c1</span></span> terminates, <span class="inlinecode"><span class="id" title="var">c2</span></span> also terminates
    and produces the same final state. Formally, program approximation
    is defined as follows: 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a id="capprox" class="idref" href="#capprox"><span class="id" title="definition">capprox</span></a> (<a id="c1:181" class="idref" href="#c1:181"><span class="id" title="binder">c1</span></a> <a id="c2:182" class="idref" href="#c2:182"><span class="id" title="binder">c2</span></a> : <a class="idref" href="PLF.Imp.html#com"><span class="id" title="inductive">com</span></a>) : <span class="id" title="keyword">Prop</span> := <span class="id" title="keyword">∀</span> (<a id="st:183" class="idref" href="#st:183"><span class="id" title="binder">st</span></a> <a id="st':184" class="idref" href="#st':184"><span class="id" title="binder">st'</span></a> : <a class="idref" href="PLF.Imp.html#state"><span class="id" title="definition">state</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#st:183"><span class="id" title="variable">st</span></a> <a class="idref" href="PLF.Imp.html#6037d1f4787d63984beccd5510872ee9"><span class="id" title="notation">=[</span></a> <a class="idref" href="PLF.Equiv.html#c1:181"><span class="id" title="variable">c1</span></a> <a class="idref" href="PLF.Imp.html#6037d1f4787d63984beccd5510872ee9"><span class="id" title="notation">]=&gt;</span></a> <a class="idref" href="PLF.Equiv.html#st':184"><span class="id" title="variable">st'</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="PLF.Equiv.html#st:183"><span class="id" title="variable">st</span></a> <a class="idref" href="PLF.Imp.html#6037d1f4787d63984beccd5510872ee9"><span class="id" title="notation">=[</span></a> <a class="idref" href="PLF.Equiv.html#c2:182"><span class="id" title="variable">c2</span></a> <a class="idref" href="PLF.Imp.html#6037d1f4787d63984beccd5510872ee9"><span class="id" title="notation">]=&gt;</span></a> <a class="idref" href="PLF.Equiv.html#st':184"><span class="id" title="variable">st'</span></a>.<br/>

<br/>
</div>

<div class="doc">
For example, the program

<div class="paragraph"> </div>

  c1 = while X &lt;&gt; 1 do
         X := X - 1
       end

<div class="paragraph"> </div>

    approximates <span class="inlinecode"><span class="id" title="var">c2</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">X</span></span> <span class="inlinecode">:=</span> <span class="inlinecode">1</span>, but <span class="inlinecode"><span class="id" title="var">c2</span></span> does not approximate <span class="inlinecode"><span class="id" title="var">c1</span></span>
    since <span class="inlinecode"><span class="id" title="var">c1</span></span> does not terminate when <span class="inlinecode"><span class="id" title="var">X</span></span> <span class="inlinecode">=</span> <span class="inlinecode">0</span> but <span class="inlinecode"><span class="id" title="var">c2</span></span> does.  If two
    programs approximate each other in both directions, then they are
    equivalent. 
<div class="paragraph"> </div>

 Find two programs <span class="inlinecode"><span class="id" title="var">c3</span></span> and <span class="inlinecode"><span class="id" title="var">c4</span></span> such that neither approximates
    the other. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a id="c3" class="idref" href="#c3"><span class="id" title="definition">c3</span></a> : <a class="idref" href="PLF.Imp.html#com"><span class="id" title="inductive">com</span></a><br/>
&nbsp;&nbsp;. <span class="id" title="var">Admitted</span>.<br/>
<span class="id" title="keyword">Definition</span> <a id="c4" class="idref" href="#c4"><span class="id" title="definition">c4</span></a> : <a class="idref" href="PLF.Imp.html#com"><span class="id" title="inductive">com</span></a><br/>
&nbsp;&nbsp;. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Theorem</span> <a id="c3_c4_different" class="idref" href="#c3_c4_different"><span class="id" title="lemma">c3_c4_different</span></a> : <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">¬</span></a> <a class="idref" href="PLF.Equiv.html#capprox"><span class="id" title="definition">capprox</span></a> <a class="idref" href="PLF.Equiv.html#c3"><span class="id" title="axiom">c3</span></a> <a class="idref" href="PLF.Equiv.html#c4"><span class="id" title="axiom">c4</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">¬</span></a> <a class="idref" href="PLF.Equiv.html#capprox"><span class="id" title="definition">capprox</span></a> <a class="idref" href="PLF.Equiv.html#c4"><span class="id" title="axiom">c4</span></a> <a class="idref" href="PLF.Equiv.html#c3"><span class="id" title="axiom">c3</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.  <span class="id" title="var">Admitted</span>.<br/>

<br/>
</div>

<div class="doc">
Find a program <span class="inlinecode"><span class="id" title="var">cmin</span></span> that approximates every other program. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a id="cmin" class="idref" href="#cmin"><span class="id" title="definition">cmin</span></a> : <a class="idref" href="PLF.Imp.html#com"><span class="id" title="inductive">com</span></a><br/>
&nbsp;&nbsp;. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Theorem</span> <a id="cmin_minimal" class="idref" href="#cmin_minimal"><span class="id" title="lemma">cmin_minimal</span></a> : <span class="id" title="keyword">∀</span> <a id="c:185" class="idref" href="#c:185"><span class="id" title="binder">c</span></a>, <a class="idref" href="PLF.Equiv.html#capprox"><span class="id" title="definition">capprox</span></a> <a class="idref" href="PLF.Equiv.html#cmin"><span class="id" title="axiom">cmin</span></a> <a class="idref" href="PLF.Equiv.html#c:185"><span class="id" title="variable">c</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.  <span class="id" title="var">Admitted</span>.<br/>

<br/>
</div>

<div class="doc">
Finally, find a non-trivial property which is preserved by
    program approximation (when going from left to right). 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a id="zprop" class="idref" href="#zprop"><span class="id" title="definition">zprop</span></a> (<a id="c:186" class="idref" href="#c:186"><span class="id" title="binder">c</span></a> : <a class="idref" href="PLF.Imp.html#com"><span class="id" title="inductive">com</span></a>) : <span class="id" title="keyword">Prop</span><br/>
&nbsp;&nbsp;. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Theorem</span> <a id="zprop_preserving" class="idref" href="#zprop_preserving"><span class="id" title="lemma">zprop_preserving</span></a> : <span class="id" title="keyword">∀</span> <a id="c:187" class="idref" href="#c:187"><span class="id" title="binder">c</span></a> <a id="c':188" class="idref" href="#c':188"><span class="id" title="binder">c'</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="PLF.Equiv.html#zprop"><span class="id" title="axiom">zprop</span></a> <a class="idref" href="PLF.Equiv.html#c:187"><span class="id" title="variable">c</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="PLF.Equiv.html#capprox"><span class="id" title="definition">capprox</span></a> <a class="idref" href="PLF.Equiv.html#c:187"><span class="id" title="variable">c</span></a> <a class="idref" href="PLF.Equiv.html#c':188"><span class="id" title="variable">c'</span></a> <a class="idref" href="http://rocq-prover.org/doc/V9.1.0/stdlib//Corelib.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="PLF.Equiv.html#zprop"><span class="id" title="axiom">zprop</span></a> <a class="idref" href="PLF.Equiv.html#c':188"><span class="id" title="variable">c'</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.  <span class="id" title="var">Admitted</span>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
</div>
<div class="code">

<br/>
</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="http://rocq-prover.org/">coqdoc</a>
</div>

</div>

</body>
</html>